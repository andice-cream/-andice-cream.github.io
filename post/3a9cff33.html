<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>EL表达式和JSTL | 小肥龙吃大冰淇淋</title><meta name="keywords" content="EL表达式和JSTL"><meta name="author" content="小肥龙吃大冰淇淋"><meta name="copyright" content="小肥龙吃大冰淇淋"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1 EL表达式和JSTL1.1 EL表达式1.1.1 EL表达式概述基本概念 EL表达式，全称是Expression Language。意为表达式语言。它是Servlet规范中的一部分，是JSP2.0规范加入的内容。其作用是用于在JSP页面中获取数据，从而让我们的JSP脱离java代码块和JSP表达式。 基本语法 EL表达式的语法格式非常简单，写为 ${表达式内容} 例如：在浏览器中输出请求域中名">
<meta property="og:type" content="article">
<meta property="og:title" content="EL表达式和JSTL">
<meta property="og:url" content="https://andice-cream.github.io/post/3a9cff33.html">
<meta property="og:site_name" content="小肥龙吃大冰淇淋">
<meta property="og:description" content="1 EL表达式和JSTL1.1 EL表达式1.1.1 EL表达式概述基本概念 EL表达式，全称是Expression Language。意为表达式语言。它是Servlet规范中的一部分，是JSP2.0规范加入的内容。其作用是用于在JSP页面中获取数据，从而让我们的JSP脱离java代码块和JSP表达式。 基本语法 EL表达式的语法格式非常简单，写为 ${表达式内容} 例如：在浏览器中输出请求域中名">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082121.jpg">
<meta property="article:published_time" content="2021-12-08T07:27:00.000Z">
<meta property="article:modified_time" content="2022-11-27T09:16:30.949Z">
<meta property="article:author" content="小肥龙吃大冰淇淋">
<meta property="article:tag" content="EL表达式和JSTL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082121.jpg"><link rel="shortcut icon" href="https://lvxueyangboke.oss-cn-beijing.aliyuncs.com/images/20210805191028.png"><link rel="canonical" href="https://andice-cream.github.io/post/3a9cff33"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'EL表达式和JSTL',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-27 17:16:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/ali_icon.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mogai.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="小肥龙吃大冰淇淋" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/blog/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">178</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082121.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小肥龙吃大冰淇淋</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">EL表达式和JSTL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-08T07:27:00.000Z" title="发表于 2021-12-08 15:27:00">2021-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-27T09:16:30.949Z" title="更新于 2022-11-27 17:16:30">2022-11-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/">java学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8CJSTL/">EL表达式和JSTL</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">11.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>48分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="EL表达式和JSTL"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="1-EL表达式和JSTL"><a href="#1-EL表达式和JSTL" class="headerlink" title="1 EL表达式和JSTL"></a>1 EL表达式和JSTL</h1><h2 id="1-1-EL表达式"><a href="#1-1-EL表达式" class="headerlink" title="1.1 EL表达式"></a>1.1 EL表达式</h2><h3 id="1-1-1-EL表达式概述"><a href="#1-1-1-EL表达式概述" class="headerlink" title="1.1.1 EL表达式概述"></a>1.1.1 EL表达式概述</h3><p><strong>基本概念</strong></p>
<p>EL表达式，全称是Expression Language。意为表达式语言。它是Servlet规范中的一部分，是JSP2.0规范加入的内容。其作用是用于在JSP页面中获取数据，从而让我们的JSP脱离java代码块和JSP表达式。</p>
<p><strong>基本语法</strong></p>
<p>EL表达式的语法格式非常简单，写为 <b><font color='red' size='5'>${表达式内容}</font></b></p>
<p>例如：在浏览器中输出请求域中名称为message的内容。</p>
<p>假定，我们在请求域中存入了一个名称为message的数据（<code>request.setAttribute(&quot;message&quot;,&quot;EL&quot;);</code>），此时在jsp中获取的方式，如下表显示：</p>
<table>
<thead>
<tr>
<th align="left">Java代码块</th>
<th align="left">JSP表达式</th>
<th align="left">EL表达式</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>&lt;%&lt;br/&gt; &lt;br/&gt; String message = (String)request.getAttribute(&quot;message&quot;);&lt;br/&gt; out.write(message);&lt;br/&gt;%&gt;</code></td>
<td align="left"><code>&lt;%=request.getAttribute(&quot;message&quot;)%&gt;</code></td>
<td align="left"><font color='red'><code>$&#123;message&#125;</code></font></td>
</tr>
</tbody></table>
<p>通过上面我们可以看出，都可以从请求域中获取数据，但是EL表达式写起来是最简单的方式。这也是以后我们在实际开发中，当使用JSP作为视图时，绝大多数都会采用的方式。</p>
<h3 id="1-1-2-EL表达式的入门案例"><a href="#1-1-2-EL表达式的入门案例" class="headerlink" title="1.1.2 EL表达式的入门案例"></a>1.1.2 EL表达式的入门案例</h3><h4 id="第一步：创建JavaWeb工程"><a href="#第一步：创建JavaWeb工程" class="headerlink" title="第一步：创建JavaWeb工程"></a>第一步：创建JavaWeb工程</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192624.png" alt="入门案例1"></p>
<h4 id="第二步：创建jsp页面"><a href="#第二步：创建jsp页面" class="headerlink" title="第二步：创建jsp页面"></a>第二步：创建jsp页面</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192625.png" alt="入门案例2"></p>
<h4 id="第三步：在JSP页面中编写代码"><a href="#第三步：在JSP页面中编写代码" class="headerlink" title="第三步：在JSP页面中编写代码"></a>第三步：在JSP页面中编写代码</h4><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;EL表达式入门案例&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;%--使用java代码在请求域中存入一个名称为message的数据--%&gt;</span><br><span class="line">    &lt;% request.setAttribute(<span class="string">&quot;message&quot;</span>,<span class="string">&quot;Expression Language&quot;</span>);%&gt;</span><br><span class="line"></span><br><span class="line">    Java代码块获取：&lt;% out.print(request.getAttribute(<span class="string">&quot;message&quot;</span>));%&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line">    JSP表达式获取：&lt;%=request.getAttribute(<span class="string">&quot;message&quot;</span>)%&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line">    EL表达式获取：$&#123;message&#125;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h4 id="第四步：部署工程"><a href="#第四步：部署工程" class="headerlink" title="第四步：部署工程"></a>第四步：部署工程</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192626.png" alt="入门案例3"></p>
<h4 id="第五步：运行测试"><a href="#第五步：运行测试" class="headerlink" title="第五步：运行测试"></a>第五步：运行测试</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192627.png" alt="入门案例4"></p>
<h3 id="1-1-2-EL表达式基本用法"><a href="#1-1-2-EL表达式基本用法" class="headerlink" title="1.1.2 EL表达式基本用法"></a>1.1.2 EL表达式基本用法</h3><p>在前面的概述介绍中，我们介绍了EL表达式的作用，它就是用于获取数据的，那么它是从哪获取数据呢？</p>
<h4 id="1）获取四大域中的数据"><a href="#1）获取四大域中的数据" class="headerlink" title="1）获取四大域中的数据"></a>1）获取四大域中的数据</h4><p>它只能从四大域中获取数据，调用的就是<code>findAttribute(name,value);</code>方法，根据名称由小到大逐个域中查找，找到就返回，找不到就什么都不显示。</p>
<p>它可以获取对象，可以是对象中关联其他对象，可以是一个List集合，也可以是一个Map集合。具体代码如下：</p>
<p><strong>创建两个实体类，User和Address</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户的实体类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String name = <span class="string">&quot;黑马程序员&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age = <span class="number">18</span>;</span><br><span class="line">	<span class="keyword">private</span> Address address = <span class="keyword">new</span> Address();</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Address <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> address;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(Address address)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.address = address;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 地址的实体类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String province = <span class="string">&quot;北京&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> String city = <span class="string">&quot;昌平区&quot;</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getProvince</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> province;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProvince</span><span class="params">(String province)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.province = province;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> city;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity</span><span class="params">(String city)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.city = city;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>JSP代码</strong></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.itheima.domain.User&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">		&lt;title&gt;EL入门&lt;/title&gt;</span><br><span class="line">	&lt;/head&gt;</span><br><span class="line">	&lt;body&gt;</span><br><span class="line">		&lt;%--EL表达式概念：</span><br><span class="line">				它是Expression Language的缩写。它是一种替换jsp表达式的语言。</span><br><span class="line">			EL表达式的语法：</span><br><span class="line">				$&#123;表达式&#125;</span><br><span class="line">				表达式的特点：有明确的返回值。</span><br><span class="line">				EL表达式就是把内容输出到页面上</span><br><span class="line">			EL表达式的注意事项：</span><br><span class="line">				<span class="number">1.</span>EL表达式没有空指针异常</span><br><span class="line">				<span class="number">2.</span>EL表达式没有数组下标越界</span><br><span class="line">				<span class="number">3.</span>EL表达式没有字符串拼接</span><br><span class="line">			EL表达式的数据获取：</span><br><span class="line">				它只能在四大域对象中获取数据，不在四大域对象中的数据它取不到。</span><br><span class="line">				它的获取方式就是findAttribute(String name)</span><br><span class="line">		 --%&gt;</span><br><span class="line">		 &lt;br/&gt;-----------获取对象数据---------------------&lt;br/&gt;</span><br><span class="line">		 &lt;% <span class="comment">//1.把用户信息存入域中</span></span><br><span class="line">		 	User user = <span class="keyword">new</span> User();</span><br><span class="line">		 	pageContext.setAttribute(<span class="string">&quot;u&quot;</span>,user);</span><br><span class="line">		  %&gt;</span><br><span class="line">		  $&#123;u&#125;===============输出的是内存地址&lt;%--就相当于调用此行代码&lt;%=pageContext.findAttribute(<span class="string">&quot;u&quot;</span>)%&gt; --%&gt;&lt;br/&gt;</span><br><span class="line">		  $&#123;u.name&#125;&lt;%--就相当于调用此行代码&lt;% User user = (User) pageContext.findAttribute(<span class="string">&quot;u&quot;</span>);out.print(user.getName());%&gt; --%&gt;&lt;br/&gt;</span><br><span class="line">		  $&#123;u.age&#125;</span><br><span class="line">		 &lt;br/&gt;-----------获取关联对象数据------------------&lt;br/&gt;</span><br><span class="line">		 $&#123;u.address&#125;==========输出的address对象的地址&lt;br/&gt;</span><br><span class="line">		 $&#123;u.address.province&#125;$&#123;u.address.city&#125;&lt;br/&gt;</span><br><span class="line">		 $&#123;u[<span class="string">&quot;address&quot;</span>][<span class="string">&#x27;province&#x27;</span>]&#125;</span><br><span class="line">		 &lt;br/&gt;-----------获取数组数据---------------------&lt;br/&gt;</span><br><span class="line">		 &lt;% String[] strs = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;He&quot;</span>,<span class="string">&quot;llo&quot;</span>,<span class="string">&quot;Expression&quot;</span>,<span class="string">&quot;Language&quot;</span>&#125;; </span><br><span class="line">		 	pageContext.setAttribute(<span class="string">&quot;strs&quot;</span>, strs);</span><br><span class="line">		 %&gt;</span><br><span class="line">		 $&#123;strs[<span class="number">0</span>]&#125;==========取的数组中下标为<span class="number">0</span>的元素&lt;br/&gt;</span><br><span class="line">		 $&#123;strs[<span class="number">3</span>]&#125;</span><br><span class="line">		 $&#123;strs[<span class="number">5</span>]&#125;===========如果超过了数组的下标，则什么都不显示&lt;br/&gt;</span><br><span class="line">		 $&#123;strs[<span class="string">&quot;2&quot;</span>]&#125;=========会自动为我们转换成下标&lt;br/&gt;</span><br><span class="line">		 $&#123;strs[<span class="string">&#x27;1&#x27;</span>]&#125;</span><br><span class="line">		 &lt;br/&gt;-----------获取List集合数据-----------------&lt;br/&gt;</span><br><span class="line">		 &lt;% List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		 	list.add(<span class="string">&quot;AAA&quot;</span>);</span><br><span class="line">		 	list.add(<span class="string">&quot;BBB&quot;</span>);</span><br><span class="line">		 	list.add(<span class="string">&quot;CCC&quot;</span>);</span><br><span class="line">		 	list.add(<span class="string">&quot;DDD&quot;</span>);</span><br><span class="line">		 	pageContext.setAttribute(<span class="string">&quot;list&quot;</span>, list);</span><br><span class="line">		  %&gt;</span><br><span class="line">		 $&#123;list&#125;&lt;br/&gt;</span><br><span class="line">		 $&#123;list[<span class="number">0</span>] &#125;&lt;br/&gt;</span><br><span class="line">		 $&#123;list[<span class="number">3</span>] &#125;&lt;br/&gt;	 </span><br><span class="line">		 &lt;br/&gt;-----------获取Map集合数据------------------&lt;br/&gt;</span><br><span class="line">		 &lt;% Map&lt;String,User&gt; map = <span class="keyword">new</span> HashMap&lt;String,User&gt;();</span><br><span class="line">		 	map.put(<span class="string">&quot;aaa&quot;</span>,<span class="keyword">new</span> User());</span><br><span class="line">		 	pageContext.setAttribute(<span class="string">&quot;map&quot;</span>, map);</span><br><span class="line">		  %&gt;</span><br><span class="line">		  $&#123;map&#125;&lt;br/&gt;</span><br><span class="line">		  $&#123;map.aaa&#125;&lt;%--获取map的value，是通过get(Key) --%&gt;&lt;br/&gt;</span><br><span class="line">		  $&#123;map.aaa.name&#125;$&#123;map.aaa.age&#125;&lt;br/&gt;</span><br><span class="line">		  $&#123;map[<span class="string">&quot;aaa&quot;</span>].name &#125;</span><br><span class="line">	&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>运行结果如图：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192628.png" alt="eldemo1"></p>
<h4 id="2）EL表达式的注意事项"><a href="#2）EL表达式的注意事项" class="headerlink" title="2）EL表达式的注意事项"></a>2）EL表达式的注意事项</h4><p>在使用EL表达式时，它帮我们做了一些处理，使我们在使用时可以避免一些错误。它没有空指针异常，没有数组下标越界，没有字符串拼接。</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;EL表达式的注意事项&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;%--EL表达式的三个没有--%&gt;</span><br><span class="line">    第一个：没有空指针异常&lt;br/&gt;</span><br><span class="line">    &lt;% String str = <span class="keyword">null</span>;</span><br><span class="line">       request.setAttribute(<span class="string">&quot;testNull&quot;</span>,str);</span><br><span class="line">    %&gt;</span><br><span class="line">    $&#123;testNull&#125;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    第二个：没有数组下标越界&lt;br/&gt;</span><br><span class="line">    &lt;% String[] strs = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>&#125;;</span><br><span class="line">       request.setAttribute(<span class="string">&quot;strs&quot;</span>,strs);</span><br><span class="line">    %&gt;</span><br><span class="line">    取第一个元素：$&#123;strs[<span class="number">0</span>]&#125;</span><br><span class="line">    取第六个元素：$&#123;strs[<span class="number">5</span>]&#125;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    第三个：没有字符串拼接&lt;br/&gt;</span><br><span class="line">    &lt;%--$&#123;strs[<span class="number">0</span>]+strs[<span class="number">1</span>]&#125;--%&gt;</span><br><span class="line">    $&#123;strs[<span class="number">0</span>]&#125;+$&#123;strs[<span class="number">1</span>]&#125;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>运行结果图：</p>
<p>\</p>
<h4 id="3）EL表达式的使用细节"><a href="#3）EL表达式的使用细节" class="headerlink" title="3）EL表达式的使用细节"></a>3）EL表达式的使用细节</h4><p>EL表达式除了能在四大域中获取数据，同时它可以访问其他隐式对象，并且访问对象有返回值的方法.</p>
<h4 id="4）EL表达式的运算符"><a href="#4）EL表达式的运算符" class="headerlink" title="4）EL表达式的运算符"></a>4）EL表达式的运算符</h4><p>EL表达式中运算符如下图所示，它们都是一目了然的：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192629.png" alt="1577782263203"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192630.png" alt="1577782270585"></p>
<p>但是有两个特殊的运算符，使用方式的代码如下：</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.itheima.domain.User&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">		&lt;title&gt;EL两个特殊的运算符&lt;/title&gt;</span><br><span class="line">	&lt;/head&gt;</span><br><span class="line">	&lt;body&gt;</span><br><span class="line">		&lt;%--empty运算符：</span><br><span class="line">			它会判断：对象是否为<span class="keyword">null</span>，字符串是否为空字符串，集合中元素是否是<span class="number">0</span>个</span><br><span class="line">		--%&gt;</span><br><span class="line">		&lt;% String str = <span class="keyword">null</span>;</span><br><span class="line">		  String str1 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">		  List&lt;String&gt; slist = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		  pageContext.setAttribute(<span class="string">&quot;str&quot;</span>, str);</span><br><span class="line">		  pageContext.setAttribute(<span class="string">&quot;str1&quot;</span>, str1);</span><br><span class="line">		  pageContext.setAttribute(<span class="string">&quot;slist&quot;</span>, slist);</span><br><span class="line">		%&gt;</span><br><span class="line">		$&#123;empty str&#125;============当对象为<span class="keyword">null</span>返回<span class="keyword">true</span>&lt;br/&gt;</span><br><span class="line">		$&#123;empty str1 &#125;==========当字符串为空字符串是返回<span class="keyword">true</span>(注意：它不会调用trim()方法)&lt;br&gt;</span><br><span class="line">		$&#123;empty slist&#125;==========当集合中的元素是<span class="number">0</span>个时，是<span class="keyword">true</span></span><br><span class="line">		&lt;hr/&gt;</span><br><span class="line">		&lt;%--三元运算符 </span><br><span class="line">			 条件?真:假</span><br><span class="line">		--%&gt;</span><br><span class="line">		&lt;% request.setAttribute(<span class="string">&quot;gender&quot;</span>, <span class="string">&quot;female&quot;</span>); %&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;gender&quot;</span> value=<span class="string">&quot;male&quot;</span> $&#123;gender eq <span class="string">&quot;male&quot;</span>?<span class="string">&quot;checked&quot;</span>:<span class="string">&quot;&quot;</span>&#125; &gt;男</span><br><span class="line">		&lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;gender&quot;</span> value=<span class="string">&quot;female&quot;</span> $&#123;gender eq <span class="string">&quot;female&quot;</span>?<span class="string">&quot;checked&quot;</span>:<span class="string">&quot;&quot;</span>&#125;&gt;女</span><br><span class="line">	&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>运行结果图：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192631.png" alt="eldemo4"></p>
<h3 id="1-1-3-EL表达式的11个隐式对象"><a href="#1-1-3-EL表达式的11个隐式对象" class="headerlink" title="1.1.3 EL表达式的11个隐式对象"></a>1.1.3 EL表达式的11个隐式对象</h3><h4 id="1）隐式对象介绍"><a href="#1）隐式对象介绍" class="headerlink" title="1）隐式对象介绍"></a>1）隐式对象介绍</h4><p>EL表达式也为我们提供隐式对象，可以让我们不声明直接来使用，十一个对象见下表，需要注意的是，它和JSP的隐式对象不是一回事：</p>
<table>
<thead>
<tr>
<th>EL中的隐式对象</th>
<th>类型</th>
<th>对应JSP隐式对象</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>PageContext</td>
<td>Javax.serlvet.jsp.PageContext</td>
<td>PageContext</td>
<td>完全一样</td>
</tr>
<tr>
<td>ApplicationScope</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>应用层范围</td>
</tr>
<tr>
<td>SessionScope</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>会话范围</td>
</tr>
<tr>
<td>RequestScope</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>请求范围</td>
</tr>
<tr>
<td>PageScope</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>页面层范围</td>
</tr>
<tr>
<td>Header</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>请求消息头key，值是value（一个）</td>
</tr>
<tr>
<td>HeaderValues</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>请求消息头key，值是数组（一个头多个值）</td>
</tr>
<tr>
<td>Param</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>请求参数key，值是value（一个）</td>
</tr>
<tr>
<td>ParamValues</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>请求参数key，值是数组（一个名称多个值）</td>
</tr>
<tr>
<td>InitParam</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>全局参数，key是参数名称，value是参数值</td>
</tr>
<tr>
<td>Cookie</td>
<td>Java.util.Map</td>
<td>没有</td>
<td>Key是cookie的名称，value是cookie对象</td>
</tr>
</tbody></table>
<h2 id="1-2-JSTL"><a href="#1-2-JSTL" class="headerlink" title="1.2 JSTL"></a>1.2 JSTL</h2><h3 id="1-2-1-JSTL概述"><a href="#1-2-1-JSTL概述" class="headerlink" title="1.2.1 JSTL概述"></a>1.2.1 JSTL概述</h3><h4 id="1）简介"><a href="#1）简介" class="headerlink" title="1）简介"></a>1）简介</h4><p>JSTL的全称是：JSP Standard Tag Libary。它是JSP中标准的标签库。它是由Apache实现的。</p>
<p>它由以下5个部分组成：</p>
<table>
<thead>
<tr>
<th>组成</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Core</td>
<td>核心标签库。</td>
<td>通用逻辑处理</td>
</tr>
<tr>
<td>Fmt</td>
<td>国际化有关。</td>
<td>需要不同地域显示不同语言时使用</td>
</tr>
<tr>
<td>Functions</td>
<td>EL函数</td>
<td>EL表达式可以使用的方法</td>
</tr>
<tr>
<td>SQL</td>
<td>操作数据库。</td>
<td>不用</td>
</tr>
<tr>
<td>XML</td>
<td>操作XML。</td>
<td>不用</td>
</tr>
</tbody></table>
<h4 id="2）使用要求"><a href="#2）使用要求" class="headerlink" title="2）使用要求"></a>2）使用要求</h4><p>要想使用JSTL标签库，在javaweb工程中需要导入坐标。首先是在工程的WEB-INF目录中创建一个lib目录，接下来把jstl的jar拷贝到lib目录中，最后在jar包上点击右键，然后选择【Add as Libary】添加。如下图所示：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192632.png" alt="jstl的jar包"></p>
<h3 id="1-2-2-核心标签库"><a href="#1-2-2-核心标签库" class="headerlink" title="1.2.2 核心标签库"></a>1.2.2 核心标签库</h3><p>在我们实际开发中，用到的jstl标签库主要以核心标签库为准，偶尔会用到国际化标签库的标签。下表中把我们经常可能用到的标签列在此处，其余标签库请同学们参考【JSTL标签库.doc】文档。</p>
<table>
<thead>
<tr>
<th>标签名称</th>
<th>功能分类</th>
<th>分类</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>&lt;c:if&gt;</code></td>
<td>流程控制</td>
<td>核心标签库</td>
<td>用于判断</td>
</tr>
<tr>
<td><code>&lt;c:choose&gt; ,&lt;c:when&gt;,&lt;c:otherwise&gt;</code></td>
<td>流程控制</td>
<td>核心标签库</td>
<td>用于多个条件判断</td>
</tr>
<tr>
<td><code>&lt;c:foreache&gt;</code></td>
<td>迭代操作</td>
<td>核心标签库</td>
<td>用于循环遍历</td>
</tr>
</tbody></table>
<h3 id="1-2-3-JSTL使用"><a href="#1-2-3-JSTL使用" class="headerlink" title="1.2.3 JSTL使用"></a>1.2.3 JSTL使用</h3><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%--导入jstl标签库 --%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;JSTL的常用标签&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;%-- c:<span class="keyword">if</span>  c:choose   c:when c:otherwise --%&gt;</span><br><span class="line">    &lt;% pageContext.setAttribute(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;F&quot;</span>); %&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;pageScope.score eq &#x27;A&#x27; &#125;&quot;</span>&gt;</span><br><span class="line">    	优秀</span><br><span class="line">    &lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span>	test=<span class="string">&quot;$&#123;pageScope.score eq &#x27;C&#x27; &#125;&quot;</span>&gt;</span><br><span class="line">    	一般</span><br><span class="line">    &lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    &lt;c:choose&gt;</span><br><span class="line">    	&lt;c:when test=<span class="string">&quot;$&#123;pageScope.score eq &#x27;A&#x27; &#125;&quot;</span>&gt;</span><br><span class="line">    		AAA</span><br><span class="line">    	&lt;/c:when&gt;</span><br><span class="line">    	&lt;c:when test=<span class="string">&quot;$&#123;pageScope.score eq &#x27;B&#x27; &#125;&quot;</span>&gt;BBB</span><br><span class="line">    	&lt;/c:when&gt;</span><br><span class="line">    	&lt;c:when test=<span class="string">&quot;$&#123;pageScope.score eq &#x27;C&#x27; &#125;&quot;</span>&gt;CCC</span><br><span class="line">    	&lt;/c:when&gt;</span><br><span class="line">    	&lt;c:when test=<span class="string">&quot;$&#123;pageScope.score eq &#x27;D&#x27; &#125;&quot;</span>&gt;DDD</span><br><span class="line">    	&lt;/c:when&gt;</span><br><span class="line">    	&lt;c:otherwise&gt;其他&lt;/c:otherwise&gt;</span><br><span class="line">    &lt;/c:choose&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;%-- c:forEach 它是用来遍历集合的</span><br><span class="line">    	 属性：</span><br><span class="line">    	 	items：要遍历的集合，它可以是EL表达式取出来的</span><br><span class="line">    	 	<span class="keyword">var</span>：把当前遍历的元素放入指定的page域中。 <span class="keyword">var</span>的取值就是key,当前遍历的元素就是value</span><br><span class="line">    	 		注意：它不能支持EL表达式，只能是字符串常量</span><br><span class="line">    	 	begin:开始遍历的索引</span><br><span class="line">    	 	end:结束遍历的索引</span><br><span class="line">    	 	step：步长。i+=step</span><br><span class="line">    	 	varStatus：它是一个计数器对象。里面有两个属性，一个是用于记录索引。一个是用于计数。</span><br><span class="line">    	 			   索引是从<span class="number">0</span>开始。计数是从<span class="number">1</span>开始</span><br><span class="line">    --%&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    &lt;% List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">       list.add(<span class="string">&quot;AAA&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;BBB&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;CCC&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;DDD&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;EEE&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;FFF&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;GGG&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;HHH&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;III&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;JJJ&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;KKK&quot;</span>);</span><br><span class="line">       list.add(<span class="string">&quot;LLL&quot;</span>);</span><br><span class="line">       pageContext.setAttribute(<span class="string">&quot;list&quot;</span>,list);</span><br><span class="line">     %&gt;</span><br><span class="line">	&lt;c:forEach items=<span class="string">&quot;$&#123;list&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;s&quot;</span> begin=<span class="string">&quot;1&quot;</span> end=<span class="string">&quot;7&quot;</span> step=<span class="string">&quot;2&quot;</span>&gt;</span><br><span class="line">    	$&#123;s&#125;&lt;br/&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    &lt;c:forEach begin=<span class="string">&quot;1&quot;</span> end=<span class="string">&quot;9&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;num&quot;</span>&gt;</span><br><span class="line">    	&lt;a href=<span class="string">&quot;#&quot;</span>&gt;$&#123;num&#125;&lt;/a&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    &lt;table&gt;</span><br><span class="line">    	&lt;tr&gt;</span><br><span class="line">    		&lt;td&gt;索引&lt;/td&gt;</span><br><span class="line">    		&lt;td&gt;序号&lt;/td&gt;</span><br><span class="line">    		&lt;td&gt;信息&lt;/td&gt;</span><br><span class="line">    	&lt;/tr&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">&quot;$&#123;list&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;s&quot;</span> varStatus=<span class="string">&quot;vs&quot;</span>&gt;</span><br><span class="line">    	&lt;tr&gt;</span><br><span class="line">    		&lt;td&gt;$&#123;vs.index&#125;&lt;/td&gt;</span><br><span class="line">    		&lt;td&gt;$&#123;vs.count&#125;&lt;/td&gt;</span><br><span class="line">    		&lt;td&gt;$&#123;s&#125;&lt;/td&gt;</span><br><span class="line">    	&lt;/tr&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h1 id="2-Servlet规范中的过滤器-Filter"><a href="#2-Servlet规范中的过滤器-Filter" class="headerlink" title="2 Servlet规范中的过滤器-Filter"></a>2 Servlet规范中的过滤器-Filter</h1><h2 id="2-1-过滤器入门"><a href="#2-1-过滤器入门" class="headerlink" title="2.1 过滤器入门"></a>2.1 过滤器入门</h2><h3 id="2-1-1-过滤器概念及作用"><a href="#2-1-1-过滤器概念及作用" class="headerlink" title="2.1.1 过滤器概念及作用"></a>2.1.1 过滤器概念及作用</h3><p>过滤器——Filter，它是JavaWeb三大组件之一。另外两个是Servlet和Listener。</p>
<p>它是在2000年发布的Servlet2.3规范中加入的一个接口。是Servlet规范中非常实用的技术。</p>
<p>它可以对web应用中的所有资源进行拦截，并且在拦截之后进行一些特殊的操作。</p>
<p>常见应用场景：URL级别的权限控制；过滤敏感词汇；中文乱码问题等等。</p>
<h3 id="2-1-2-过滤器的入门案例"><a href="#2-1-2-过滤器的入门案例" class="headerlink" title="2.1.2 过滤器的入门案例"></a>2.1.2 过滤器的入门案例</h3><h4 id="1）前期准备"><a href="#1）前期准备" class="headerlink" title="1）前期准备"></a>1）前期准备</h4><p><strong>创建JavaWeb工程</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192633.png" alt="filter_demo1"></p>
<p><strong>编写和配置接收请求用的Servlet</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于接收和处理请求的Servlet</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletDemo1</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 处理请求的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletDemo1接收到了请求&quot;</span>);</span><br><span class="line">        req.getRequestDispatcher(<span class="string">&quot;/WEB-INF/pages/success.jsp&quot;</span>).forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">       doGet(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">                      http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">metadata-complete</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--配置Servlet--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.itheima.web.servlet.ServletDemo1<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>编写index.jsp</strong></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%-- Created by IntelliJ IDEA. --%&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;主页面&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/ServletDemo1&quot;</span>&gt;访问ServletDemo1&lt;/a&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>编写success.jsp</strong></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;成功页面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%System.out.println(<span class="string">&quot;success.jsp执行了&quot;</span>);%&gt;</span><br><span class="line">执行成功！</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192634.png" alt="filter_demo2"></p>
<h4 id="2）过滤器的编写步骤"><a href="#2）过滤器的编写步骤" class="headerlink" title="2）过滤器的编写步骤"></a>2）过滤器的编写步骤</h4><p><strong>编写过滤器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Filter的入门案例</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterDemo1</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤器的核心方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 如果不写此段代码，控制台会输出两次：FilterDemo1拦截到了请求。</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        HttpServletRequest req = (HttpServletRequest) request;</span><br><span class="line">        String requestURI = req.getRequestURI();</span><br><span class="line">        <span class="keyword">if</span> (requestURI.contains(<span class="string">&quot;favicon.ico&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo1拦截到了请求&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>配置过滤器</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置过滤器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.itheima.web.filter.FilterDemo1<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3）测试部署"><a href="#3）测试部署" class="headerlink" title="3）测试部署"></a>3）测试部署</h4><p><strong>部署项目</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192635.png" alt="filter_demo3"></p>
<p><strong>测试结果</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192636.png" alt="filter_demo4"></p>
<p><strong>案例的问题分析及解决</strong></p>
<p>当我们启动服务，在地址栏输入访问地址后，发现浏览器任何内容都没有，控制台却输出了【FilterDemo1拦截到了请求】，也就是说在访问任何资源的时候，都先经过了过滤器。</p>
<p>这是因为：我们在配置过滤器的拦截规则时，使用了<font color='red' size="5"><b>/*</b></font>,表明访问当前应用下任何资源，此过滤器都会起作用。除了这种全部过滤的规则之外，它还支持特定类型的过滤配置。我们可以稍作调整，就可以不用加上面那段过滤图标的代码了。修改的方式如下：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192637.png" alt="filter_demo6"></p>
<p>现在的问题是，我们拦截下来了，点击链接发送请求，运行结果是：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192638.png" alt="filter_demo7"></p>
<p>需要对过滤器执行放行操作，才能让他继续执行，那么如何放行的？</p>
<p>我们需要使用<code>FilterChain</code>中的<code>doFilter</code>方法放行。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192639.png" alt="1577953319367"></p>
<h2 id="2-2-过滤器的细节"><a href="#2-2-过滤器的细节" class="headerlink" title="2.2 过滤器的细节"></a>2.2 过滤器的细节</h2><h3 id="2-2-1-过滤器API介绍"><a href="#2-2-1-过滤器API介绍" class="headerlink" title="2.2.1 过滤器API介绍"></a>2.2.1 过滤器API介绍</h3><h4 id="1）Filter"><a href="#1）Filter" class="headerlink" title="1）Filter"></a>1）Filter</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192640.png" alt="Filter_API"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192641.png" alt="Filter_API2"></p>
<h4 id="2）FilterConfig"><a href="#2）FilterConfig" class="headerlink" title="2）FilterConfig"></a>2）FilterConfig</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192642.png" alt="FilterConfig_API"></p>
<h4 id="3）FilterChain"><a href="#3）FilterChain" class="headerlink" title="3）FilterChain"></a>3）FilterChain</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192643.png" alt="FilterChain_API"></p>
<h3 id="2-2-2-入门案例过程及生命周期"><a href="#2-2-2-入门案例过程及生命周期" class="headerlink" title="2.2.2 入门案例过程及生命周期"></a>2.2.2 入门案例过程及生命周期</h3><h4 id="1）生命周期"><a href="#1）生命周期" class="headerlink" title="1）生命周期"></a>1）生命周期</h4><p><strong>出生——活着——死亡</strong></p>
<p><strong>出生：</strong>当应用加载的时候执行实例化和初始化方法。</p>
<p><strong>活着：</strong>只要应用一直提供服务，对象就一直存在。</p>
<p><strong>死亡：</strong>当应用卸载时，或者服务器宕机时，对象消亡。</p>
<p><strong>Filter的实例对象在内存中也只有一份。所以也是单例的。</strong></p>
<h4 id="2）过滤器核心方法的细节"><a href="#2）过滤器核心方法的细节" class="headerlink" title="2）过滤器核心方法的细节"></a>2）过滤器核心方法的细节</h4><p>在<code>FilterDemo1</code>的<code>doFilter</code>方法添加一行代码，如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤器的核心方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 如果不写此段代码，控制台会输出两次：FilterDemo1拦截到了请求。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        HttpServletRequest req = (HttpServletRequest) request;</span></span><br><span class="line"><span class="comment">        String requestURI = req.getRequestURI();</span></span><br><span class="line"><span class="comment">        if (requestURI.contains(&quot;favicon.ico&quot;)) &#123;</span></span><br><span class="line"><span class="comment">            return;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo1拦截到了请求&quot;</span>);</span><br><span class="line">        <span class="comment">//过滤器放行</span></span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo1放行之后，又回到了doFilter方法&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>测试运行结果，我们发现过滤器放行之后执行完目标资源，仍会回到过滤器中：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192644.png" alt="filter_demo8"></p>
<h3 id="2-2-3-过滤器初始化参数配置"><a href="#2-2-3-过滤器初始化参数配置" class="headerlink" title="2.2.3 过滤器初始化参数配置"></a>2.2.3 过滤器初始化参数配置</h3><h4 id="1）创建过滤器FilterDemo2"><a href="#1）创建过滤器FilterDemo2" class="headerlink" title="1）创建过滤器FilterDemo2"></a>1）创建过滤器FilterDemo2</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Filter的初始化参数配置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterDemo2</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> FilterConfig filterConfig;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filterConfig</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo2的初始化方法执行了&quot;</span>);</span><br><span class="line">        <span class="comment">//给过滤器配置对象赋值</span></span><br><span class="line">        <span class="keyword">this</span>.filterConfig = filterConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤器的核心方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo2拦截到了请求&quot;</span>);</span><br><span class="line">        <span class="comment">//过滤器放行</span></span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo2的销毁方法执行了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）配置FilterDemo2"><a href="#2）配置FilterDemo2" class="headerlink" title="2）配置FilterDemo2"></a>2）配置FilterDemo2</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.itheima.web.filter.FilterDemo2<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置过滤器的初始化参数--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>filterInitParamName<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>filterInitParamValue<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3）在FilterDemo2的doFilter方法中添加下面的代码"><a href="#3）在FilterDemo2的doFilter方法中添加下面的代码" class="headerlink" title="3）在FilterDemo2的doFilter方法中添加下面的代码"></a>3）在FilterDemo2的doFilter方法中添加下面的代码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//根据名称获取过滤器的初始化参数</span></span><br><span class="line">String paramValue = filterConfig.getInitParameter(<span class="string">&quot;filterInitParamName&quot;</span>);</span><br><span class="line">System.out.println(paramValue);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取过滤器初始化参数名称的枚举</span></span><br><span class="line">Enumeration&lt;String&gt; initNames = filterConfig.getInitParameterNames();</span><br><span class="line"><span class="keyword">while</span>(initNames.hasMoreElements())&#123;</span><br><span class="line">    String initName = initNames.nextElement();</span><br><span class="line">    String initValue = filterConfig.getInitParameter(initName);</span><br><span class="line">    System.out.println(initName+<span class="string">&quot;,&quot;</span>+initValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取ServletContext对象</span></span><br><span class="line">ServletContext servletContext = filterConfig.getServletContext();</span><br><span class="line">System.out.println(servletContext);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取过滤器名称</span></span><br><span class="line">String filterName = filterConfig.getFilterName();</span><br><span class="line">System.out.println(filterName);</span><br></pre></td></tr></table></figure>

<h4 id="4）测试运行结果"><a href="#4）测试运行结果" class="headerlink" title="4）测试运行结果"></a>4）测试运行结果</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192645.png" alt="FilterConfig_demo"></p>
<p>我们通过这个测试，看到了过滤器的初始化参数配置和获取的使用。但是同学们也肯定发现了，在我们的工程中两个过滤器都起作用了，这就是我们在API中说的链式调用，那么当有多个过滤器，它的执行顺序是什么样的呢？</p>
<p>我们来看下一小节。</p>
<h3 id="2-2-5-多个过滤器的执行顺序"><a href="#2-2-5-多个过滤器的执行顺序" class="headerlink" title="2.2.5 多个过滤器的执行顺序"></a>2.2.5 多个过滤器的执行顺序</h3><h4 id="1）修改FilterDemo1和FilterDemo2两个过滤器的代码，删掉多余的代码"><a href="#1）修改FilterDemo1和FilterDemo2两个过滤器的代码，删掉多余的代码" class="headerlink" title="1）修改FilterDemo1和FilterDemo2两个过滤器的代码，删掉多余的代码"></a>1）修改FilterDemo1和FilterDemo2两个过滤器的代码，删掉多余的代码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Filter的入门案例</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterDemo1</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤器的核心方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo1拦截到了请求&quot;</span>);</span><br><span class="line">        <span class="comment">//过滤器放行</span></span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filterConfig</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo1的初始化方法执行了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo1的销毁方法执行了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Filter的初始化参数配置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterDemo2</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filterConfig</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo2的初始化方法执行了&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤器的核心方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo2拦截到了请求&quot;</span>);</span><br><span class="line">        <span class="comment">//过滤器放行</span></span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo2的销毁方法执行了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）修改两个过滤器的配置，删掉多余的配置"><a href="#2）修改两个过滤器的配置，删掉多余的配置" class="headerlink" title="2）修改两个过滤器的配置，删掉多余的配置"></a>2）修改两个过滤器的配置，删掉多余的配置</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置过滤器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.itheima.web.filter.FilterDemo1<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.itheima.web.filter.FilterDemo2<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3）测试运行结果"><a href="#3）测试运行结果" class="headerlink" title="3）测试运行结果"></a>3）测试运行结果</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192646.png" alt="filter_multi_demo"></p>
<p>此处我们看到了多个过滤器的执行顺序，它正好和我们在web.xml中的配置顺序一致，如下图：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192647.png" alt="filter_execute_order"></p>
<p>在过滤器的配置中，有过滤器的声明和过滤器的映射两部分，到底是声明决定顺序，还是映射决定顺序呢？</p>
<p>答案是：<font color='red'><b><code>&lt;filter-mapping&gt;</code>的配置前后顺序决定过滤器的调用顺序，也就是由映射配置顺序决定。</b></font></p>
<h3 id="2-2-6-过滤器的五种拦截行为"><a href="#2-2-6-过滤器的五种拦截行为" class="headerlink" title="2.2.6 过滤器的五种拦截行为"></a>2.2.6 过滤器的五种拦截行为</h3><p>我们的过滤器目前拦截的是请求，但是在实际开发中，我们还有请求转发和请求包含，以及由服务器触发调用的全局错误页面。默认情况下过滤器是不参与过滤的，要想使用，需要我们配置。配置的方式如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置过滤器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.itheima.web.filter.FilterDemo1<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置开启异步支持，当dispatcher配置ASYNC时，需要配置此行--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">async-supported</span>&gt;</span>true<span class="tag">&lt;/<span class="name">async-supported</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--过滤请求：默认值。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--过滤全局错误页面：当由服务器调用全局错误页面时，过滤器工作--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--过滤请求转发：当请求转发时，过滤器工作。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>FORWARD<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--过滤请求包含：当请求包含时，过滤器工作。它只能过滤动态包含，jsp的include指令是静态包含--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>INCLUDE<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--过滤异步类型，它要求我们在filter标签中配置开启异步支持--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>ASYNC<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-4-过滤器与Servlet的区别"><a href="#2-2-4-过滤器与Servlet的区别" class="headerlink" title="2.2.4 过滤器与Servlet的区别"></a>2.2.4 过滤器与Servlet的区别</h3><table>
<thead>
<tr>
<th>方法/类型</th>
<th>Servlet</th>
<th>Filter</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>初始化                                        方法</td>
<td><code>void   init(ServletConfig);   </code></td>
<td><code>void init(FilterConfig);   </code></td>
<td>几乎一样，都是在web.xml中配置参数，用该对象的方法可以获取到。</td>
</tr>
<tr>
<td>提供服务方法</td>
<td><code>void   service(request,response);                                               </code></td>
<td><code>void   dofilter(request,response,FilterChain);                                   </code></td>
<td>Filter比Servlet多了一个FilterChain，它不仅能完成Servlet的功能，而且还可以决定程序是否能继续执行。所以过滤器比Servlet更为强大。   在Struts2中，核心控制器就是一个过滤器。</td>
</tr>
<tr>
<td>销毁方法</td>
<td><code>void destroy();</code></td>
<td><code>void destroy();</code></td>
<td></td>
</tr>
</tbody></table>
<h2 id="2-3-过滤器的使用案例"><a href="#2-3-过滤器的使用案例" class="headerlink" title="2.3 过滤器的使用案例"></a>2.3 过滤器的使用案例</h2><h3 id="2-3-1-静态资源设置缓存时间过滤器"><a href="#2-3-1-静态资源设置缓存时间过滤器" class="headerlink" title="2.3.1 静态资源设置缓存时间过滤器"></a>2.3.1 静态资源设置缓存时间过滤器</h3><h4 id="1）-需求说明"><a href="#1）-需求说明" class="headerlink" title="1） 需求说明"></a>1） 需求说明</h4><p>在我们访问html，js，image时，不需要每次都重新发送请求读取资源，就可以通过设置响应消息头的方式，设置缓存时间。但是如果每个Servlet都编写相同的代码，显然不符合我们统一调用和维护的理念。（此处有个非常重要的编程思想：AOP思想，在录制视频时提不提都可以）</p>
<p>因此，我们要采用过滤器来实现功能。</p>
<h4 id="2）-编写步骤"><a href="#2）-编写步骤" class="headerlink" title="2） 编写步骤"></a>2） 编写步骤</h4><p><strong>第一步：创建JavaWeb工程</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192648.png" alt="filter2_demo"></p>
<p><strong>第二步：导入静态资源</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192649.png" alt="filter2_demo_staticresource"></p>
<p><strong>第三步：编写过滤器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 静态资源设置缓存时间</span></span><br><span class="line"><span class="comment"> * 	html设置为1小时</span></span><br><span class="line"><span class="comment"> *  js设置为2小时</span></span><br><span class="line"><span class="comment"> *  css设置为3小时</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticResourceNeedCacheFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> FilterConfig filterConfig;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.filterConfig = filterConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res,</span></span></span><br><span class="line"><span class="params"><span class="function">                         FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        <span class="comment">//1.把doFilter的请求和响应对象转换成跟http协议有关的对象</span></span><br><span class="line">        HttpServletRequest  request;</span><br><span class="line">        HttpServletResponse response;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            request = (HttpServletRequest) req;</span><br><span class="line">            response = (HttpServletResponse) res;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassCastException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(<span class="string">&quot;non-HTTP request or response&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//2.获取请求资源URI</span></span><br><span class="line">        String uri = request.getRequestURI();</span><br><span class="line">        <span class="comment">//3.得到请求资源到底是什么类型</span></span><br><span class="line">        String extend = uri.substring(uri.lastIndexOf(<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);<span class="comment">//我们只需要判断它是不是html,css,js。其他的不管</span></span><br><span class="line">        <span class="comment">//4.判断到底是什么类型的资源</span></span><br><span class="line">        <span class="keyword">long</span> time = <span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;html&quot;</span>.equals(extend))&#123;</span><br><span class="line">            <span class="comment">//html 缓存1小时</span></span><br><span class="line">            String html = filterConfig.getInitParameter(<span class="string">&quot;html&quot;</span>);</span><br><span class="line">            time = time*Long.parseLong(html);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;js&quot;</span>.equals(extend))&#123;</span><br><span class="line">            <span class="comment">//js 缓存2小时</span></span><br><span class="line">            String js = filterConfig.getInitParameter(<span class="string">&quot;js&quot;</span>);</span><br><span class="line">            time = time*Long.parseLong(js);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;css&quot;</span>.equals(extend))&#123;</span><br><span class="line">            <span class="comment">//css 缓存3小时</span></span><br><span class="line">            String css = filterConfig.getInitParameter(<span class="string">&quot;css&quot;</span>);</span><br><span class="line">            time = time*Long.parseLong(css);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//5.设置响应消息头</span></span><br><span class="line">        response.setDateHeader(<span class="string">&quot;Expires&quot;</span>, System.currentTimeMillis()+time);</span><br><span class="line">        <span class="comment">//6.放行</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第四步：配置过滤器</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>StaticResourceNeedCacheFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.itheima.web.filter.StaticResourceNeedCacheFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>html<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>js<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>4<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>css<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>5<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>StaticResourceNeedCacheFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.html<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>StaticResourceNeedCacheFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.js<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>StaticResourceNeedCacheFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.css<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3）-测试结果"><a href="#3）-测试结果" class="headerlink" title="3） 测试结果"></a>3） 测试结果</h4><blockquote>
<p>此案例演示时需要注意一下，chrome浏览器刷新时，每次也都会发送请求，所以看不到304状态码。建议用IE浏览器，因为它在刷新时不会再次请求。</p>
</blockquote>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192650.png" alt="staticresource_demo"></p>
<h3 id="2-3-2-特殊字符过滤器"><a href="#2-3-2-特殊字符过滤器" class="headerlink" title="2.3.2 特殊字符过滤器"></a>2.3.2 特殊字符过滤器</h3><h4 id="1）需求说明"><a href="#1）需求说明" class="headerlink" title="1）需求说明"></a>1）需求说明</h4><p>在实际开发中，可能会面临一个问题，就是很多输入框都会遇到特殊字符。此时，我们也可以通过过滤器来解决。</p>
<p>例如：</p>
<p>​    我们模拟一个论坛，有人发帖问：“在HTML中表示水平线的标签是哪个？”。</p>
<p>如果我们在文本框中直接输入<code>&lt;hr/&gt;</code>就会出现一条水平线，这个会让发帖人一脸懵。</p>
<p>我们接下来就用过滤器来解决一下。</p>
<h4 id="2）编写步骤"><a href="#2）编写步骤" class="headerlink" title="2）编写步骤"></a>2）编写步骤</h4><p><strong>第一步：创建JavaWeb工程</strong></p>
<p>沿用第一个案例的工程</p>
<p><strong>第二步：编写Servlet和JSP</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletDemo1</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String content = request.getParameter(<span class="string">&quot;content&quot;</span>);</span><br><span class="line">        response.getWriter().write(content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;ServletDemo1&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-<span class="class"><span class="keyword">class</span>&gt;<span class="title">com</span>.<span class="title">itheima</span>.<span class="title">web</span>.<span class="title">servlet</span>.<span class="title">ServletDemo1</span>&lt;/<span class="title">servlet</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">servlet</span>&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">servlet</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">servlet</span>-<span class="title">name</span>&gt;<span class="title">ServletDemo1</span>&lt;/<span class="title">servlet</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">url</span>-<span class="title">pattern</span>&gt;/<span class="title">ServletDemo1</span>&lt;/<span class="title">url</span>-<span class="title">pattern</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">servlet</span>-<span class="title">mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/ServletDemo1&quot;</span> method=<span class="string">&quot;POST&quot;</span>&gt;</span><br><span class="line">    回帖：&lt;textarea rows=<span class="string">&quot;5&quot;</span> cols=<span class="string">&quot;25&quot;</span> name=<span class="string">&quot;content&quot;</span>&gt;&lt;/textarea&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;发言&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>第三步：编写过滤器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HTMLFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res,</span></span></span><br><span class="line"><span class="params"><span class="function">                         FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletRequest request;</span><br><span class="line">        HttpServletResponse response;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            request = (HttpServletRequest) req;</span><br><span class="line">            response = (HttpServletResponse) res;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassCastException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(<span class="string">&quot;non-HTTP request or response&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//创建一个自己的Request类</span></span><br><span class="line">        MyHttpServletRequest2 myrequest = <span class="keyword">new</span> MyHttpServletRequest2(request);</span><br><span class="line">        <span class="comment">//放行：</span></span><br><span class="line">        chain.doFilter(myrequest, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHttpServletRequest2</span> <span class="keyword">extends</span> <span class="title">HttpServletRequestWrapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">//提供一个构造方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyHttpServletRequest2</span><span class="params">(HttpServletRequest request)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(request);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重写getParameter方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getParameter</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.获取出请求正文： 调用父类的获取方法</span></span><br><span class="line">        String value = <span class="keyword">super</span>.getParameter(name);</span><br><span class="line">        <span class="comment">//2.判断value是否有值</span></span><br><span class="line">        <span class="keyword">if</span>(value == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> htmlfilter(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">htmlfilter</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (message == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">char</span> content[] = <span class="keyword">new</span> <span class="keyword">char</span>[message.length()];</span><br><span class="line">        message.getChars(<span class="number">0</span>, message.length(), content, <span class="number">0</span>);</span><br><span class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder(content.length + <span class="number">50</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; content.length; i++) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (content[i]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&lt;&#x27;</span>:</span><br><span class="line">                    result.append(<span class="string">&quot;&amp;lt;&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&gt;&#x27;</span>:</span><br><span class="line">                    result.append(<span class="string">&quot;&amp;gt;&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&amp;&#x27;</span>:</span><br><span class="line">                    result.append(<span class="string">&quot;&amp;amp;&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                    result.append(<span class="string">&quot;&amp;quot;&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    result.append(content[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (result.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第四步：配置过滤器</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HTMLFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.itheima.web.filter.HTMLFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HTMLFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3）测试结果"><a href="#3）测试结果" class="headerlink" title="3）测试结果"></a>3）测试结果</h4><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192651.png" alt="HTMLFilter_demo"></p>
<h1 id="3-Servlet规范中的监听器-Listener"><a href="#3-Servlet规范中的监听器-Listener" class="headerlink" title="3 Servlet规范中的监听器-Listener"></a>3 Servlet规范中的监听器-Listener</h1><h2 id="3-1-观察者设计模式"><a href="#3-1-观察者设计模式" class="headerlink" title="3.1 观察者设计模式"></a>3.1 观察者设计模式</h2><p>在介绍监听器之前，先跟同学们普及一个知识，观察者设计模式。因为所有的监听器都是观察者设计模式的体现。</p>
<p>那什么是观察者设计模式呢？</p>
<p>它是事件驱动的一种体现形式。就好比在做什么事情的时候被人盯着。当对应做到某件事时，触发事件。</p>
<p>观察者模式通常由以下三部分组成：</p>
<p>​            事件源：触发事件的对象。</p>
<p>​            事件：触发的动作，里面封装了事件源。</p>
<p>​            监听器：当事件源触发事件时，要做的事情。一般是一个接口，由使用者来实现。（此处的思想还涉及了一个涉及模式，我们在JDBC的第二天课程中就给同学们讲解，策略模式）</p>
<p>下图描述了观察者设计模式组成：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192652.png" alt="观察者模式"></p>
<h2 id="3-1-Servlet规范中的8个监听器简介"><a href="#3-1-Servlet规范中的8个监听器简介" class="headerlink" title="3.1 Servlet规范中的8个监听器简介"></a>3.1 Servlet规范中的8个监听器简介</h2><h3 id="3-1-1-监听对象创建的"><a href="#3-1-1-监听对象创建的" class="headerlink" title="3.1.1 监听对象创建的"></a>3.1.1 监听对象创建的</h3><h4 id="1）ServletContextListener"><a href="#1）ServletContextListener" class="headerlink" title="1）ServletContextListener"></a>1）ServletContextListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听ServletContext对象创建和销毁的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> v 2.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ServletContextListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *	对象创建时执行此方法。该方法的参数是ServletContextEvent事件对象，事件是【创建对象】这个动作</span></span><br><span class="line"><span class="comment">     *  事件对象中封装着触发事件的来源，即事件源，就是ServletContext</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对象销毁执行此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）HttpSessionListener"><a href="#2）HttpSessionListener" class="headerlink" title="2）HttpSessionListener"></a>2）HttpSessionListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听HttpSession对象创建和销毁的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> v 2.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HttpSessionListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对象创建时执行此方法。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">sessionCreated</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  对象销毁执行此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">sessionDestroyed</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3）ServletRequestListener"><a href="#3）ServletRequestListener" class="headerlink" title="3）ServletRequestListener"></a>3）ServletRequestListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听ServletRequest对象创建和销毁的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> Servlet 2.4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ServletRequestListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  对象创建时执行此方法。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">requestInitialized</span> <span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对象销毁执行此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">requestDestroyed</span> <span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-监听域中属性发生变化的"><a href="#3-1-2-监听域中属性发生变化的" class="headerlink" title="3.1.2 监听域中属性发生变化的"></a>3.1.2 监听域中属性发生变化的</h3><h4 id="1）ServletContextAttributeListener"><a href="#1）ServletContextAttributeListener" class="headerlink" title="1）ServletContextAttributeListener"></a>1）ServletContextAttributeListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听ServletContext域（应用域）中属性发生变化的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> v 2.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ServletContextAttributeListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中添加了属性触发此方法。参数是ServletContextAttributeEvent事件对象，事件是【添加属性】。</span></span><br><span class="line"><span class="comment">     * 事件对象中封装着事件源，即ServletContext。</span></span><br><span class="line"><span class="comment">     * 当ServletContext执行setAttribute方法时，此方法可以知道，并执行。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(ServletContextAttributeEvent scae)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中删除了属性触发此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(ServletContextAttributeEvent scae)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中属性发生改变触发此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(ServletContextAttributeEvent scae)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）HttpSessionAttributeListener"><a href="#2）HttpSessionAttributeListener" class="headerlink" title="2）HttpSessionAttributeListener"></a>2）HttpSessionAttributeListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听HttpSession域（会话域）中属性发生变化的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> v 2.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HttpSessionAttributeListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中添加了属性触发此方法。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中删除了属性触发此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中属性发生改变触发此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3）ServletRequestAttributeListener"><a href="#3）ServletRequestAttributeListener" class="headerlink" title="3）ServletRequestAttributeListener"></a>3）ServletRequestAttributeListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听ServletRequest域（请求域）中属性发生变化的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> Servlet 2.4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ServletRequestAttributeListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中添加了属性触发此方法。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(ServletRequestAttributeEvent srae)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中删除了属性触发此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(ServletRequestAttributeEvent srae)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中属性发生改变触发此方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(ServletRequestAttributeEvent srae)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-3-和会话相关的两个感知型监听器"><a href="#3-1-3-和会话相关的两个感知型监听器" class="headerlink" title="3.1.3 和会话相关的两个感知型监听器"></a>3.1.3 和会话相关的两个感知型监听器</h3><p>此处要跟同学们明确一下，和会话域相关的两个感知型监听器是无需配置的，直接编写代码即可。</p>
<h4 id="1）HttpSessionBinderListener"><a href="#1）HttpSessionBinderListener" class="headerlink" title="1）HttpSessionBinderListener"></a>1）HttpSessionBinderListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于感知对象和和会话域绑定的监听器</span></span><br><span class="line"><span class="comment"> * 当有数据加入会话域或从会话域中移除，此监听器的两个方法会执行。</span></span><br><span class="line"><span class="comment"> * 加入会话域即和会话域绑定</span></span><br><span class="line"><span class="comment"> * 从会话域移除即从会话域解绑</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HttpSessionBindingListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当数据加入会话域时，也就是绑定，此方法执行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">valueBound</span><span class="params">(HttpSessionBindingEvent event)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当从会话域移除时，也就是解绑，此方法执行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">valueUnbound</span><span class="params">(HttpSessionBindingEvent event)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2）HttpSessionActivationListener"><a href="#2）HttpSessionActivationListener" class="headerlink" title="2）HttpSessionActivationListener"></a>2）HttpSessionActivationListener</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于感知会话域中对象钝化和活化的监听器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HttpSessionActivationListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当会话域中的数据钝化时，此方法执行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">sessionWillPassivate</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当会话域中的数据活化时（激活），此方法执行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title">sessionDidActivate</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-监听器的使用"><a href="#3-2-监听器的使用" class="headerlink" title="3.2 监听器的使用"></a>3.2 监听器的使用</h2><p>在实际开发中，我们可以根据具体情况来从这8个监听器中选择使用。感知型监听器由于无需配置，只需要根据实际需求编写代码，所以此处我们就不再演示了。我们在剩余6个中分别选择一个监听对象创建销毁和对象域中属性发生变化的监听器演示一下。</p>
<h3 id="3-2-1-ServletContextListener的使用"><a href="#3-2-1-ServletContextListener的使用" class="headerlink" title="3.2.1 ServletContextListener的使用"></a>3.2.1 ServletContextListener的使用</h3><p><strong>第一步：创建工程</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192653.png" alt="listener_demo1"></p>
<p><strong>第二步：编写监听器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听ServletContext对象创建和销毁的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletContextListenerDemo</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对象创建时，执行此方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sce</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;监听到了对象的创建&quot;</span>);</span><br><span class="line">        <span class="comment">//1.获取事件源对象</span></span><br><span class="line">        ServletContext servletContext = sce.getServletContext();</span><br><span class="line">        System.out.println(servletContext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对象销毁时，执行此方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sce</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;监听到了对象的销毁&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第三步：在web.xml中配置监听器</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置监听器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.itheima.web.listener.ServletContextListenerDemo<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>第四步：测试结果</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192654.jpg" alt="listener_demo2"></p>
<h3 id="3-2-2-ServletContextAttributeListener的使用"><a href="#3-2-2-ServletContextAttributeListener的使用" class="headerlink" title="3.2.2 ServletContextAttributeListener的使用"></a>3.2.2 ServletContextAttributeListener的使用</h3><p><strong>第一步：创建工程</strong></p>
<p>沿用上一个案例的工程</p>
<p><strong>第二步：编写监听器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 监听域中属性发生变化的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletContextAttributeListenerDemo</span> <span class="keyword">implements</span> <span class="title">ServletContextAttributeListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中添加了数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> scae</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(ServletContextAttributeEvent scae)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;监听到域中加入了属性&quot;</span>);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 由于除了我们往域中添加了数据外，应用在加载时还会自动往域中添加一些属性。</span></span><br><span class="line"><span class="comment">         * 我们可以获取域中所有名称的枚举，从而看到域中都有哪些属性</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//1.获取事件源对象ServletContext</span></span><br><span class="line">        ServletContext servletContext = scae.getServletContext();</span><br><span class="line">        <span class="comment">//2.获取域中所有名称的枚举</span></span><br><span class="line">        Enumeration&lt;String&gt; names = servletContext.getAttributeNames();</span><br><span class="line">        <span class="comment">//3.遍历名称的枚举</span></span><br><span class="line">        <span class="keyword">while</span>(names.hasMoreElements())&#123;</span><br><span class="line">            <span class="comment">//4.获取每个名称</span></span><br><span class="line">            String name = names.nextElement();</span><br><span class="line">            <span class="comment">//5.获取值</span></span><br><span class="line">            Object value = servletContext.getAttribute(name);</span><br><span class="line">            <span class="comment">//6.输出名称和值</span></span><br><span class="line">            System.out.println(<span class="string">&quot;name is &quot;</span>+name+<span class="string">&quot; and value is &quot;</span>+value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中移除了数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> scae</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(ServletContextAttributeEvent scae)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;监听到域中移除了属性&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 域中属性发生了替换</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> scae</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(ServletContextAttributeEvent scae)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;监听到域中属性发生了替换&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同时，我们还需要借助第一个<code>ServletContextListenerDemo</code>监听器，往域中存入数据，替换域中的数据以及从域中移除数据，代码如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于监听ServletContext对象创建和销毁的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黑马程序员</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Company</span> http://www.itheima.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletContextListenerDemo</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对象创建时，执行此方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sce</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;监听到了对象的创建&quot;</span>);</span><br><span class="line">        <span class="comment">//1.获取事件源对象</span></span><br><span class="line">        ServletContext servletContext = sce.getServletContext();</span><br><span class="line">        <span class="comment">//2.往域中加入属性</span></span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;servletContext&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对象销毁时，执行此方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sce</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.取出事件源对象</span></span><br><span class="line">        ServletContext servletContext = sce.getServletContext();</span><br><span class="line">        <span class="comment">//2.往域中加入属性，但是名称仍采用servletContext，此时就是替换</span></span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;servletContext&quot;</span>,<span class="string">&quot;demo&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;监听到了对象的销毁&quot;</span>);</span><br><span class="line">        <span class="comment">//3.移除属性</span></span><br><span class="line">        servletContext.removeAttribute(<span class="string">&quot;servletContext&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第三步：在web.xml中配置监听器</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置监听器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.itheima.web.listener.ServletContextListenerDemo<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--配置监听器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.itheima.web.listener.ServletContextAttributeListenerDemo<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>第四步：测试结果</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208192655.png" alt="attributelistener_demo"></p>
<h1 id="4-综合案例-学生管理系统改造"><a href="#4-综合案例-学生管理系统改造" class="headerlink" title="4 综合案例-学生管理系统改造"></a>4 综合案例-学生管理系统改造</h1><h2 id="4-1-需求说明"><a href="#4-1-需求说明" class="headerlink" title="4.1 需求说明"></a>4.1 需求说明</h2><h3 id="4-1-1-解决乱码问题"><a href="#4-1-1-解决乱码问题" class="headerlink" title="4.1.1 解决乱码问题"></a>4.1.1 解决乱码问题</h3><p>我们的学生管理系统中，肯定会有请求和响应的中文乱码问题。而乱码问题在学习Servlet的课程中已经讲解了如何解决了。只是在实际开发中，当有很多的Servlet时，肯定不能在每个Servlet中都编写一遍解决乱码的代码。因此，就可以利用我们今天学习的过滤器来实现统一解决请求和响应乱码的问题。</p>
<h3 id="4-1-2-检查登录"><a href="#4-1-2-检查登录" class="headerlink" title="4.1.2 检查登录"></a>4.1.2 检查登录</h3><p>在学生管理系统中，它包含了学生信息的录入和学生列表的查询，用户（员工）信息的录入以及查询。当然，我们实际的功能可能远远不止这些。但是就已有功能来说，也不是谁都可以通过地址栏直接输入访问的，它应该有权限的控制，只是我们课程在此处没法深入展开讲解权限，但最起码的登录，身份的认证还是必要的。</p>
<p>由此，就引出来一个问题，是在每次访问Servlet时，在Servlet的代码中加入是否认证过身份的判断吗？显然，是不合理的。那么，既然不是在每个Servlet中编写，就应该是统一管理和维护。此时，我们的过滤器就又可以出场了。</p>
<h3 id="4-1-3-页面的java代码块和jsp表达式改造"><a href="#4-1-3-页面的java代码块和jsp表达式改造" class="headerlink" title="4.1.3 页面的java代码块和jsp表达式改造"></a>4.1.3 页面的java代码块和jsp表达式改造</h3><p>我们今天除了学习了过滤器，还学习了EL表达式和JSTL标签库，它们的出现就是避免我们的JSP页面中有过多的java代码或者jsp表达式。我们要运用今天所学知识改造页面。</p>
<h2 id="4-2-案例实现"><a href="#4-2-案例实现" class="headerlink" title="4.2 案例实现"></a>4.2 案例实现</h2><h3 id="4-2-1-乱码问题过滤器"><a href="#4-2-1-乱码问题过滤器" class="headerlink" title="4.2.1 乱码问题过滤器"></a>4.2.1 乱码问题过滤器</h3><p>创建EncodingFilter类，解决乱码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    解决全局乱码问题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//1.将请求和响应对象转换为和HTTP协议相关</span></span><br><span class="line">            HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">            HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//2.设置编码格式</span></span><br><span class="line">            request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//3.放行</span></span><br><span class="line">            filterChain.doFilter(request,response);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="4-2-2-检查登录过滤器"><a href="#4-2-2-检查登录过滤器" class="headerlink" title="4.2.2 检查登录过滤器"></a>4.2.2 检查登录过滤器</h3><p>检查登录，创建LoginFilter 类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    检查登录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebFilter(value = &#123;&quot;/addStudent.jsp&quot;,&quot;/listStudentServlet&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//1.将请求和响应对象转换为和HTTP协议相关</span></span><br><span class="line">            HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">            HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//2.获取会话域对象中数据</span></span><br><span class="line">            Object username = request.getSession().getAttribute(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//3.判断用户名</span></span><br><span class="line">            <span class="keyword">if</span>(username == <span class="keyword">null</span> || <span class="string">&quot;&quot;</span>.equals(username)) &#123;</span><br><span class="line">                <span class="comment">//重定向到登录页面</span></span><br><span class="line">                response.sendRedirect(request.getContextPath() + <span class="string">&quot;/login.jsp&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//4.放行</span></span><br><span class="line">            filterChain.doFilter(request,response);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="4-2-3-jsp页面的改造"><a href="#4-2-3-jsp页面的改造" class="headerlink" title="4.2.3 jsp页面的改造"></a>4.2.3 jsp页面的改造</h3><p>​    1，修改<code>addStudent.jsp</code>的虚拟访问路径</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/addStudentServlet&quot;</span> method=<span class="string">&quot;get&quot;</span> autocomplete=<span class="string">&quot;off&quot;</span>&gt;</span><br><span class="line">    学生姓名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt; &lt;br&gt;</span><br><span class="line">    学生年龄：&lt;input type=<span class="string">&quot;number&quot;</span> name=<span class="string">&quot;age&quot;</span>&gt; &lt;br&gt;</span><br><span class="line">    学生成绩：&lt;input type=<span class="string">&quot;number&quot;</span> name=<span class="string">&quot;score&quot;</span>&gt; &lt;br&gt;</span><br><span class="line">    &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;保存&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>2，修改<code>index.jsp</code></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@taglib</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;学生管理系统首页&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;%--</span><br><span class="line">        获取会话域中的数据</span><br><span class="line">        如果获取到了则显示添加和查看功能的超链接</span><br><span class="line">        如果没获取到则显示登录功能的超链接</span><br><span class="line">    --%&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;sessionScope.username eq null&#125;&quot;</span>&gt;</span><br><span class="line">        &lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/login.jsp&quot;</span>&gt;请登录&lt;/a&gt;</span><br><span class="line">    &lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;sessionScope.username ne null&#125;&quot;</span>&gt;</span><br><span class="line">        &lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/addStudent.jsp&quot;</span>&gt;添加学生&lt;/a&gt;</span><br><span class="line">        &lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/listStudentServlet&quot;</span>&gt;查看学生&lt;/a&gt;</span><br><span class="line">    &lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3，修改<code>listStudent.jsp</code></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.itheima.bean.Student&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.ArrayList&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@taglib</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;查看学生&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;table width=<span class="string">&quot;600px&quot;</span> border=<span class="string">&quot;1px&quot;</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;学生姓名&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;学生年龄&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;学生成绩&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">&quot;$&#123;students&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;s&quot;</span>&gt;</span><br><span class="line">            &lt;tr align=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line">                &lt;td&gt;$&#123;s.username&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;s.age&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;s.score&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4，修改<code>login.jsp</code></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;学生登录&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/loginStudentServlet&quot;</span> method=<span class="string">&quot;get&quot;</span> autocomplete=<span class="string">&quot;off&quot;</span>&gt;</span><br><span class="line">        姓名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt; &lt;br&gt;</span><br><span class="line">        密码：&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span>&gt; &lt;br&gt;</span><br><span class="line">        &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;登录&lt;/button&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小肥龙吃大冰淇淋</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://andice-cream.github.io/post/3a9cff33.html">https://andice-cream.github.io/post/3a9cff33.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://andice-cream.github.io" target="_blank">小肥龙吃大冰淇淋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8CJSTL/">EL表达式和JSTL</a></div><div class="post_share"><div class="social-share" data-image="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082121.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/4eb3381c.html"><img class="prev-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082302.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">分布式锁</div></div></a></div><div class="next-post pull-right"><a href="/post/8f8751b4.html"><img class="next-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082231.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Cookie&amp;SessionJsp</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8CJSTL"><span class="toc-number">1.</span> <span class="toc-text">1 EL表达式和JSTL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-EL%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 EL表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 EL表达式概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 EL表达式的入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%88%9B%E5%BB%BAJavaWeb%E5%B7%A5%E7%A8%8B"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">第一步：创建JavaWeb工程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%88%9B%E5%BB%BAjsp%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">第二步：创建jsp页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E5%9C%A8JSP%E9%A1%B5%E9%9D%A2%E4%B8%AD%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">第三步：在JSP页面中编写代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E9%83%A8%E7%BD%B2%E5%B7%A5%E7%A8%8B"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">第四步：部署工程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E6%AD%A5%EF%BC%9A%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">第五步：运行测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.2 EL表达式基本用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E8%8E%B7%E5%8F%96%E5%9B%9B%E5%A4%A7%E5%9F%9F%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">1）获取四大域中的数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">2）EL表达式的注意事项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E7%BB%86%E8%8A%82"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">3）EL表达式的使用细节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%89EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">4）EL表达式的运算符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%8411%E4%B8%AA%E9%9A%90%E5%BC%8F%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.1.3 EL表达式的11个隐式对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E9%9A%90%E5%BC%8F%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">1）隐式对象介绍</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-JSTL"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 JSTL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-JSTL%E6%A6%82%E8%BF%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 JSTL概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">1）简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E4%BD%BF%E7%94%A8%E8%A6%81%E6%B1%82"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">2）使用要求</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-%E6%A0%B8%E5%BF%83%E6%A0%87%E7%AD%BE%E5%BA%93"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 核心标签库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3-JSTL%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.2.3 JSTL使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Servlet%E8%A7%84%E8%8C%83%E4%B8%AD%E7%9A%84%E8%BF%87%E6%BB%A4%E5%99%A8-Filter"><span class="toc-number">2.</span> <span class="toc-text">2 Servlet规范中的过滤器-Filter</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E8%BF%87%E6%BB%A4%E5%99%A8%E5%85%A5%E9%97%A8"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 过滤器入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E8%BF%87%E6%BB%A4%E5%99%A8%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%BD%9C%E7%94%A8"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 过滤器概念及作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 过滤器的入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">1）前期准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">2）过滤器的编写步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E6%B5%8B%E8%AF%95%E9%83%A8%E7%BD%B2"><span class="toc-number">2.1.2.3.</span> <span class="toc-text">3）测试部署</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%BB%86%E8%8A%82"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 过滤器的细节</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-%E8%BF%87%E6%BB%A4%E5%99%A8API%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 过滤器API介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89Filter"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">1）Filter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89FilterConfig"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">2）FilterConfig</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89FilterChain"><span class="toc-number">2.2.1.3.</span> <span class="toc-text">3）FilterChain</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E8%BF%87%E7%A8%8B%E5%8F%8A%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 入门案例过程及生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">1）生命周期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E8%BF%87%E6%BB%A4%E5%99%A8%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95%E7%9A%84%E7%BB%86%E8%8A%82"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">2）过滤器核心方法的细节</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3-%E8%BF%87%E6%BB%A4%E5%99%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2.3 过滤器初始化参数配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E5%88%9B%E5%BB%BA%E8%BF%87%E6%BB%A4%E5%99%A8FilterDemo2"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">1）创建过滤器FilterDemo2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E9%85%8D%E7%BD%AEFilterDemo2"><span class="toc-number">2.2.3.2.</span> <span class="toc-text">2）配置FilterDemo2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E5%9C%A8FilterDemo2%E7%9A%84doFilter%E6%96%B9%E6%B3%95%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.3.3.</span> <span class="toc-text">3）在FilterDemo2的doFilter方法中添加下面的代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%89%E6%B5%8B%E8%AF%95%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">2.2.3.4.</span> <span class="toc-text">4）测试运行结果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-5-%E5%A4%9A%E4%B8%AA%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">2.2.4.</span> <span class="toc-text">2.2.5 多个过滤器的执行顺序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E4%BF%AE%E6%94%B9FilterDemo1%E5%92%8CFilterDemo2%E4%B8%A4%E4%B8%AA%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%88%A0%E6%8E%89%E5%A4%9A%E4%BD%99%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.4.1.</span> <span class="toc-text">1）修改FilterDemo1和FilterDemo2两个过滤器的代码，删掉多余的代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E4%BF%AE%E6%94%B9%E4%B8%A4%E4%B8%AA%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%88%A0%E6%8E%89%E5%A4%9A%E4%BD%99%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">2.2.4.2.</span> <span class="toc-text">2）修改两个过滤器的配置，删掉多余的配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E6%B5%8B%E8%AF%95%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">2.2.4.3.</span> <span class="toc-text">3）测试运行结果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-6-%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E4%BA%94%E7%A7%8D%E6%8B%A6%E6%88%AA%E8%A1%8C%E4%B8%BA"><span class="toc-number">2.2.5.</span> <span class="toc-text">2.2.6 过滤器的五种拦截行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-4-%E8%BF%87%E6%BB%A4%E5%99%A8%E4%B8%8EServlet%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.6.</span> <span class="toc-text">2.2.4 过滤器与Servlet的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 过滤器的使用案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%AE%BE%E7%BD%AE%E7%BC%93%E5%AD%98%E6%97%B6%E9%97%B4%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 静态资源设置缓存时间过滤器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89-%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">1） 需求说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89-%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">2） 编写步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89-%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C"><span class="toc-number">2.3.1.3.</span> <span class="toc-text">3） 测试结果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 特殊字符过滤器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">1）需求说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">2）编写步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">3）测试结果</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Servlet%E8%A7%84%E8%8C%83%E4%B8%AD%E7%9A%84%E7%9B%91%E5%90%AC%E5%99%A8-Listener"><span class="toc-number">3.</span> <span class="toc-text">3 Servlet规范中的监听器-Listener</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E8%A7%82%E5%AF%9F%E8%80%85%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 观察者设计模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Servlet%E8%A7%84%E8%8C%83%E4%B8%AD%E7%9A%848%E4%B8%AA%E7%9B%91%E5%90%AC%E5%99%A8%E7%AE%80%E4%BB%8B"><span class="toc-number">3.2.</span> <span class="toc-text">3.1 Servlet规范中的8个监听器简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-%E7%9B%91%E5%90%AC%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E7%9A%84"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.1.1 监听对象创建的</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89ServletContextListener"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">1）ServletContextListener</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89HttpSessionListener"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">2）HttpSessionListener</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89ServletRequestListener"><span class="toc-number">3.2.1.3.</span> <span class="toc-text">3）ServletRequestListener</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-%E7%9B%91%E5%90%AC%E5%9F%9F%E4%B8%AD%E5%B1%9E%E6%80%A7%E5%8F%91%E7%94%9F%E5%8F%98%E5%8C%96%E7%9A%84"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.1.2 监听域中属性发生变化的</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89ServletContextAttributeListener"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">1）ServletContextAttributeListener</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89HttpSessionAttributeListener"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">2）HttpSessionAttributeListener</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89ServletRequestAttributeListener"><span class="toc-number">3.2.2.3.</span> <span class="toc-text">3）ServletRequestAttributeListener</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3-%E5%92%8C%E4%BC%9A%E8%AF%9D%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%A4%E4%B8%AA%E6%84%9F%E7%9F%A5%E5%9E%8B%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.1.3 和会话相关的两个感知型监听器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89HttpSessionBinderListener"><span class="toc-number">3.2.3.1.</span> <span class="toc-text">1）HttpSessionBinderListener</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89HttpSessionActivationListener"><span class="toc-number">3.2.3.2.</span> <span class="toc-text">2）HttpSessionActivationListener</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E7%9B%91%E5%90%AC%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.</span> <span class="toc-text">3.2 监听器的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-ServletContextListener%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.2.1 ServletContextListener的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-ServletContextAttributeListener%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.2.2 ServletContextAttributeListener的使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B-%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%94%B9%E9%80%A0"><span class="toc-number">4.</span> <span class="toc-text">4 综合案例-学生管理系统改造</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 需求说明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E8%A7%A3%E5%86%B3%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-number">4.1.1.</span> <span class="toc-text">4.1.1 解决乱码问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E6%A3%80%E6%9F%A5%E7%99%BB%E5%BD%95"><span class="toc-number">4.1.2.</span> <span class="toc-text">4.1.2 检查登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-3-%E9%A1%B5%E9%9D%A2%E7%9A%84java%E4%BB%A3%E7%A0%81%E5%9D%97%E5%92%8Cjsp%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%94%B9%E9%80%A0"><span class="toc-number">4.1.3.</span> <span class="toc-text">4.1.3 页面的java代码块和jsp表达式改造</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E6%A1%88%E4%BE%8B%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 案例实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 乱码问题过滤器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-%E6%A3%80%E6%9F%A5%E7%99%BB%E5%BD%95%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2 检查登录过滤器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-3-jsp%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%94%B9%E9%80%A0"><span class="toc-number">4.2.3.</span> <span class="toc-text">4.2.3 jsp页面的改造</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 小肥龙吃大冰淇淋</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="framework-info"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/202301132049386.png"/><span> </span><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">晋ICP备2022012091号-1</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'pinglun-9gh2lmcnd8587831',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'pinglun-9gh2lmcnd8587831',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script src="//code.tidio.co/smwivpnwumemac2wohardi3d3gpud1ag.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>