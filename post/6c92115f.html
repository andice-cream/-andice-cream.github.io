<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Spring | 小肥龙吃大冰淇淋</title><meta name="keywords" content="Spring"><meta name="author" content="小肥龙吃大冰淇淋"><meta name="copyright" content="小肥龙吃大冰淇淋"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Spring IoC1)Spring简介1.1)什么是框架 源自于建筑学，隶属土木工程，后发展到软件工程领域  软件工程框架：经过验证的，具有一定功能的，半成品软件  经过验证  具有一定功能  半成品      1.2)框架的作用 1.3)Spring是什么Spring是分层的JavaSE&#x2F;EE应用full-stack轻量级开源框架  1.4)Spring的体系结构 1.5)Spring的发展历">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring">
<meta property="og:url" content="https://pengdanhua.github.io/post/6c92115f.html">
<meta property="og:site_name" content="小肥龙吃大冰淇淋">
<meta property="og:description" content="Spring IoC1)Spring简介1.1)什么是框架 源自于建筑学，隶属土木工程，后发展到软件工程领域  软件工程框架：经过验证的，具有一定功能的，半成品软件  经过验证  具有一定功能  半成品      1.2)框架的作用 1.3)Spring是什么Spring是分层的JavaSE&#x2F;EE应用full-stack轻量级开源框架  1.4)Spring的体系结构 1.5)Spring的发展历">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082159.jpg">
<meta property="article:published_time" content="2021-12-08T07:27:00.000Z">
<meta property="article:modified_time" content="2022-11-27T09:16:41.815Z">
<meta property="article:author" content="小肥龙吃大冰淇淋">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082159.jpg"><link rel="shortcut icon" href="https://lvxueyangboke.oss-cn-beijing.aliyuncs.com/images/20210805191028.png"><link rel="canonical" href="https://pengdanhua.github.io/post/6c92115f"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Spring',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-27 17:16:41'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/ali_icon.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mogai.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="小肥龙吃大冰淇淋" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/blog/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">178</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082159.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小肥龙吃大冰淇淋</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Spring</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-08T07:27:00.000Z" title="发表于 2021-12-08 15:27:00">2021-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-27T09:16:41.815Z" title="更新于 2022-11-27 17:16:41">2022-11-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/">java学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/Spring/">Spring</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>61分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Spring"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Spring-IoC"><a href="#Spring-IoC" class="headerlink" title="Spring IoC"></a>Spring IoC</h1><h2 id="1-Spring简介"><a href="#1-Spring简介" class="headerlink" title="1)Spring简介"></a>1)Spring简介</h2><h3 id="1-1-什么是框架"><a href="#1-1-什么是框架" class="headerlink" title="1.1)什么是框架"></a>1.1)什么是框架</h3><ul>
<li><p>源自于建筑学，隶属土木工程，后发展到软件工程领域</p>
</li>
<li><p>软件工程框架：经过验证的，具有一定功能的，半成品软件</p>
<ul>
<li><p>经过验证</p>
</li>
<li><p>具有一定功能</p>
</li>
<li><p>半成品</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200844.png" alt="1590631254933"></p>
<h3 id="1-2-框架的作用"><a href="#1-2-框架的作用" class="headerlink" title="1.2)框架的作用"></a>1.2)框架的作用</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200845.png" alt="1590631300743"></p>
<h3 id="1-3-Spring是什么"><a href="#1-3-Spring是什么" class="headerlink" title="1.3)Spring是什么"></a>1.3)Spring是什么</h3><p>Spring是分层的JavaSE/EE应用full-stack轻量级开源框架</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200846.png" alt="1590631495077"></p>
<h3 id="1-4-Spring的体系结构"><a href="#1-4-Spring的体系结构" class="headerlink" title="1.4)Spring的体系结构"></a>1.4)Spring的体系结构</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200847.png" alt="1590631552693"></p>
<h3 id="1-5-Spring的发展历史"><a href="#1-5-Spring的发展历史" class="headerlink" title="1.5)Spring的发展历史"></a>1.5)Spring的发展历史</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200848.png" alt="1590631606747"></p>
<h3 id="1-6-Spring优势"><a href="#1-6-Spring优势" class="headerlink" title="1.6)Spring优势"></a>1.6)Spring优势</h3><table>
<thead>
<tr>
<th>Spring的优势</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>方便解耦，简化开发</td>
<td>第一天</td>
</tr>
<tr>
<td>方便集成各种优秀框架</td>
<td>第一天</td>
</tr>
<tr>
<td>方便程序的测试</td>
<td>第二天</td>
</tr>
<tr>
<td>AOP编程的支持</td>
<td>第三天</td>
</tr>
<tr>
<td>声明式事务的支持</td>
<td>第四天</td>
</tr>
<tr>
<td>降低JavaEE API的使用难度</td>
<td>第四天</td>
</tr>
<tr>
<td>Java源码是经典学习范例</td>
<td>长期学习</td>
</tr>
</tbody></table>
<h2 id="2-IoC简介"><a href="#2-IoC简介" class="headerlink" title="2)IoC简介"></a>2)IoC简介</h2><h3 id="2-1-优质程序代码的制作原则"><a href="#2-1-优质程序代码的制作原则" class="headerlink" title="2.1)优质程序代码的制作原则"></a>2.1)优质程序代码的制作原则</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200849.png" alt="1590636507198"></p>
<h3 id="2-2-耦合与内聚"><a href="#2-2-耦合与内聚" class="headerlink" title="2.2)耦合与内聚"></a>2.2)耦合与内聚</h3><ul>
<li><p>耦合（Coupling）：代码书写过程中所使用技术的结合紧密度，用于衡量软件中各个模块之间的互联程度</p>
</li>
<li><p>内聚（Cohesion）：代码书写过程中单个模块内部各组成部分间的联系，用于衡量软件中各个功能模块内部的功能联系</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200850.png" alt="1590636557953"></p>
<ul>
<li>程序书写的目标：高内聚，低耦合<ul>
<li>就是同一个模块内的各个元素之间要高度紧密，但是各个模块之间的相互依存度却不要那么紧密</li>
</ul>
</li>
</ul>
<h3 id="2-3-工厂模式发展史"><a href="#2-3-工厂模式发展史" class="headerlink" title="2.3)工厂模式发展史"></a>2.3)工厂模式发展史</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200851.png" alt="1590636616069"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200852.png" alt="1590636644096"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200853.png" alt="1590636661026"></p>
<h3 id="2-4-Spring发展历程"><a href="#2-4-Spring发展历程" class="headerlink" title="2.4)Spring发展历程"></a>2.4)Spring发展历程</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200854.png" alt="1590636704098"></p>
<h3 id="2-5-IoC"><a href="#2-5-IoC" class="headerlink" title="2.5)IoC"></a>2.5)IoC</h3><ul>
<li><p>IoC（Inversion Of Control）控制反转，Spring反向控制应用程序所需要使用的外部资源</p>
</li>
<li><p>Spring控制的资源全部放置在Spring容器中，该容器称为IoC容器</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200855.png" alt="1590636750876"></p>
</li>
</ul>
<h2 id="3-入门案例"><a href="#3-入门案例" class="headerlink" title="3)入门案例"></a>3)入门案例</h2><h3 id="3-1-案例环境说明"><a href="#3-1-案例环境说明" class="headerlink" title="3.1)案例环境说明"></a>3.1)案例环境说明</h3><ul>
<li><p>模拟三层架构中表现层调用业务层功能</p>
<ul>
<li><p>表现层：UserApp模拟UserServlet（使用main方法模拟）</p>
</li>
<li><p>业务层：UserService</p>
</li>
</ul>
</li>
</ul>
<h3 id="3-2-IoC入门案例制作步骤"><a href="#3-2-IoC入门案例制作步骤" class="headerlink" title="3.2)IoC入门案例制作步骤"></a>3.2)IoC入门案例制作步骤</h3><p>1.导入spring坐标（5.1.9.release）</p>
<p>2.编写业务层与表现层（模拟）接口与实现类</p>
<p>3.建立spring配置文件</p>
<p>4.配置所需资源（Service）为spring控制的资源</p>
<p>5.表现层（App）通过spring获取资源（Service实例）</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200856.png" alt="1590637353510"></p>
<h4 id="3-2-1-IoC入门案例制作步骤-1"><a href="#3-2-1-IoC入门案例制作步骤-1" class="headerlink" title="3.2.1)IoC入门案例制作步骤-1"></a>3.2.1)IoC入门案例制作步骤-1</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-2-IoC入门案例制作步骤-2"><a href="#3-2-2-IoC入门案例制作步骤-2" class="headerlink" title="3.2.2)IoC入门案例制作步骤-2"></a>3.2.2)IoC入门案例制作步骤-2</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//业务方法  </span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-3-IoC入门案例制作步骤-3"><a href="#3-2-3-IoC入门案例制作步骤-3" class="headerlink" title="3.2.3)IoC入门案例制作步骤-3"></a>3.2.3)IoC入门案例制作步骤-3</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user service running...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-4-IoC入门案例制作步骤-4"><a href="#3-2-4-IoC入门案例制作步骤-4" class="headerlink" title="3.2.4)IoC入门案例制作步骤-4"></a>3.2.4)IoC入门案例制作步骤-4</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1.创建spring控制的资源--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.UserServiceImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-5-IoC入门案例制作步骤-5"><a href="#3-2-5-IoC入门案例制作步骤-5" class="headerlink" title="3.2.5)IoC入门案例制作步骤-5"></a>3.2.5)IoC入门案例制作步骤-5</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserApp</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//2.加载配置文件</span></span><br><span class="line">        ApplicationContext ctx = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//3.获取资源</span></span><br><span class="line">        UserService userService = (UserService) ctx.getBean(<span class="string">&quot;userService&quot;</span>);</span><br><span class="line">        userService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-IoC配置（XML格式）"><a href="#4-IoC配置（XML格式）" class="headerlink" title="4)IoC配置（XML格式）"></a>4)IoC配置（XML格式）</h2><h3 id="4-1-bean"><a href="#4-1-bean" class="headerlink" title="4.1)bean"></a>4.1)bean</h3><ul>
<li><p>名称：bean</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：beans标签</p>
</li>
<li><p>作用：定义spring中的资源，受此标签定义的资源将受到spring控制</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>基本属性：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;beanId&quot;</span> <span class="attr">name</span>=<span class="string">&quot;beanName1,beanName2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ClassName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    id：bean的名称，通过id值获取bean</p>
<p>​    class：bean的类型</p>
<p>​    name：bean的名称，可以通过name值获取bean，用于多人配合时给bean起别名</p>
</li>
</ul>
<h3 id="4-2-bean属性scope"><a href="#4-2-bean属性scope" class="headerlink" title="4.2)bean属性scope"></a>4.2)bean属性scope</h3><ul>
<li><p>名称：scope</p>
</li>
<li><p>类型：<strong>属性</strong></p>
</li>
<li><p>归属：bean标签</p>
</li>
<li><p>作用：定义bean的作用范围</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>取值：</p>
<ul>
<li>singleton：设定创建出的对象保存在spring容器中，是一个单例的对象</li>
<li>prototype：设定创建出的对象保存在spring容器中，是一个非单例的对象</li>
<li>request、session、application、 websocket ：设定创建出的对象放置在web容器对应的位置</li>
</ul>
</li>
</ul>
<h3 id="4-3-bean生命周期"><a href="#4-3-bean生命周期" class="headerlink" title="4.3)bean生命周期"></a>4.3)bean生命周期</h3><ul>
<li><p>名称：init-method，destroy-method</p>
</li>
<li><p>类型：<strong>属性</strong></p>
</li>
<li><p>归属：bean标签</p>
</li>
<li><p>作用：定义bean对象在初始化或销毁时完成的工作</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&gt;&lt;/bean&gt;</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>取值：bean对应的类中对应的具体方法名</p>
</li>
<li><p>注意事项：</p>
<ul>
<li><p>当scope=“singleton”时，spring容器中有且仅有一个对象，init方法在创建容器时仅执行一次</p>
</li>
<li><p>当scope=“prototype”时，spring容器要创建同一类型的多个对象，init方法在每个对象创建时均执行一次</p>
</li>
<li><p>当scope=“singleton”时，关闭容器会导致bean实例的销毁，调用destroy方法一次</p>
</li>
<li><p>当scope=“prototype”时，对象的销毁由垃圾回收机制gc()控制，destroy方法将不会被执行</p>
</li>
</ul>
</li>
</ul>
<h3 id="4-4-bean对象创建方式（了解）"><a href="#4-4-bean对象创建方式（了解）" class="headerlink" title="4.4)bean对象创建方式（了解）"></a>4.4)bean对象创建方式（了解）</h3><p>(1)factory-bean</p>
<ul>
<li><p>名称：factory-bean</p>
</li>
<li><p>类型：<strong>属性</strong></p>
</li>
<li><p>归属：bean标签</p>
</li>
<li><p>作用：定义bean对象创建方式，使用静态工厂的形式创建bean，兼容早期遗留系统的升级工作</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;FactoryClassName&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;factoryMethodName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>取值：工厂bean中用于获取对象的静态方法名</p>
</li>
<li><p>注意事项：</p>
<ul>
<li>class属性必须配置成静态工厂的类名</li>
</ul>
</li>
</ul>
<p>(2)factory-bean，factory-method</p>
<ul>
<li><p>名称：factory-bean，factory-method</p>
</li>
<li><p>类型：<strong>属性</strong></p>
</li>
<li><p>归属：bean标签</p>
</li>
<li><p>作用：定义bean对象创建方式，使用实例工厂的形式创建bean，兼容早期遗留系统的升级工作</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">factory-bean</span>=<span class="string">&quot;factoryBeanId&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;factoryMethodName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>取值：工厂bean中用于获取对象的实例方法名</p>
</li>
<li><p>注意事项：</p>
<ul>
<li><p>使用实例工厂创建bean首先需要将实例工厂配置bean，交由spring进行管理</p>
</li>
<li><p>factory-bean是实例工厂的beanId</p>
</li>
</ul>
</li>
</ul>
<h3 id="4-5-DI"><a href="#4-5-DI" class="headerlink" title="4.5)DI"></a>4.5)DI</h3><ul>
<li><p>IoC（Inversion Of Control）控制翻转，Spring反向控制应用程序所需要使用的外部资源</p>
</li>
<li><p>DI（Dependency Injection）依赖注入，应用程序运行依赖的资源由Spring为其提供，资源进入应用程序的方式称为注入</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200857.png" alt="1590659778689"></p>
<p>IoC与DI的关系</p>
<ul>
<li><p>IoC与DI是同一件事站在不同角度看待问题</p>
</li>
<li><p>半杯水</p>
</li>
<li></li>
<li><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200858.png" alt="1590659854696">set注入（主流）</p>
</li>
</ul>
<h3 id="4-6-set注入（主流）"><a href="#4-6-set注入（主流）" class="headerlink" title="4.6)set注入（主流）"></a>4.6)set注入（主流）</h3><ul>
<li><p>名称：property</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：bean标签</p>
</li>
<li><p>作用：使用set方法的形式为bean提供资源</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;property /&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>基本属性：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;propertyName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;propertyValue&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;beanId&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    name：对应bean中的属性名，要求该属性必须提供可访问的set方法（严格规范为此名称是set方法对应名称）</p>
<p>​    value：设定非引用类型属性对应的值，不能与ref同时使用</p>
<p>​    ref：设定引用类型属性对应bean的id ，不能与value同时使用</p>
<ul>
<li>注意：一个bean可以有多个property标签</li>
</ul>
<h3 id="4-7-构造器注入（了解）"><a href="#4-7-构造器注入（了解）" class="headerlink" title="4.7)构造器注入（了解）"></a>4.7)构造器注入（了解）</h3><ul>
<li><p>名称：constructor-arg</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：bean标签</p>
</li>
<li><p>作用：使用构造方法的形式为bean提供资源，兼容早期遗留系统的升级工作</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>基本属性：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;argsName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;argsValue /&gt;</span></span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    name：对应bean中的构造方法所携带的参数名</p>
<p>​    value：设定非引用类型构造方法参数对应的值，不能与ref同时使用</p>
<p>其他属性：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;arg-index&quot;</span> <span class="attr">type</span>=<span class="string">&quot;arg-type&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;beanId&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    ref：设定引用类型构造方法参数对应bean的id ，不能与value同时使用</p>
<p>​    type ：设定构造方法参数的类型，用于按类型匹配参数或进行类型校验</p>
<p>​    index ：设定构造方法参数的位置，用于按位置匹配参数，参数index值从0开始计数</p>
<ul>
<li>注意：一个bean可以有多个constructor-arg标签</li>
</ul>
<h3 id="4-8-集合类型数据注入"><a href="#4-8-集合类型数据注入" class="headerlink" title="4.8)集合类型数据注入"></a>4.8)集合类型数据注入</h3><ul>
<li><p>名称：array，list，set，map，props</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：property标签 或 constructor-arg标签</p>
</li>
<li><p>作用：注入集合数据类型属性</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">list</span>&gt;</span><span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>(1)集合类型数据注入——list</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;al&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>itheima<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>66666<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(2)集合类型数据注入——props</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;name&quot;</span>&gt;</span>itheima666<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;value&quot;</span>&gt;</span>666666<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(3)集合类型数据注入——array （了解）</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;arr&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>66666<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(4)集合类型数据注入——set（了解）</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hs&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">value</span>&gt;</span>itheima<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">value</span>&gt;</span>66666<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(5)集合类型数据注入——map（了解）</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hm&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;itheima66666&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;value&quot;</span> <span class="attr">value</span>=<span class="string">&quot;6666666666&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-9-使用p命名空间简化配置（了解）"><a href="#4-9-使用p命名空间简化配置（了解）" class="headerlink" title="4.9)使用p命名空间简化配置（了解）"></a>4.9)使用p命名空间简化配置（了解）</h3><ul>
<li><p>名称：p:propertyName，p:propertyName-ref</p>
</li>
<li><p>类型：<strong>属性</strong></p>
</li>
<li><p>归属：bean标签</p>
</li>
<li><p>作用：为bean注入属性值</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">p:propertyName</span>=<span class="string">&quot;propertyValue&quot;</span> <span class="attr">p:propertyName-ref</span>=<span class="string">&quot;beanId&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>注意：使用p命令空间需要先开启spring对p命令空间的的支持，在beans标签中添加对应空间支持</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span>    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>    <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span>       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans     https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>后续课程中还将开启其他的命名空间，方式同上</p>
</li>
<li><p>案例：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.UserServiceImpl&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">p:userDao-ref</span>=<span class="string">&quot;userDao&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">p:bookDao-ref</span>=<span class="string">&quot;bookDao&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-10-SpEL-（了解）"><a href="#4-10-SpEL-（了解）" class="headerlink" title="4.10)SpEL （了解）"></a>4.10)SpEL （了解）</h3><ul>
<li><p>Spring提供了对EL表达式的支持，统一属性注入格式</p>
</li>
<li><p>类型：<strong>属性值</strong></p>
</li>
<li><p>归属：value属性值</p>
</li>
<li><p>作用：为bean注入属性值</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">value</span>=<span class="string">&quot;EL&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>注意：所有属性值不区分是否引用类型，统一使用value赋值</p>
</li>
<li><p>所有格式统一使用  value=“********”</p>
<ul>
<li><p>常量  #{10}  #{3.14}  #{2e5}  #{‘itcast’}</p>
</li>
<li><p>引用bean  #{beanId}    </p>
</li>
<li><p>引用bean属性  #{beanId.propertyName}</p>
</li>
<li><p>引用bean方法  beanId.methodName().method2()</p>
</li>
<li><p>引用静态方法  T(java.lang.Math).PI</p>
</li>
<li><p>运算符支持  #{3 lt 4 == 4 ge 3}</p>
</li>
<li><p>正则表达式支持  #{user.name matches‘[a-z]{6,}’}</p>
</li>
<li><p>集合支持  #{likes[3]}</p>
</li>
</ul>
</li>
<li><p>案例：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">value</span>=<span class="string">&quot;#&#123;userDao&#125;&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">value</span>=<span class="string">&quot;#&#123;bookDao&#125;&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;num&quot;</span> <span class="attr">value</span>=<span class="string">&quot;#&#123;666666666&#125;&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;version&quot;</span> <span class="attr">value</span>=<span class="string">&quot;#&#123;&#x27;itcast&#x27;&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-11-properties文件"><a href="#4-11-properties文件" class="headerlink" title="4.11)properties文件"></a>4.11)properties文件</h3><ul>
<li><p>Spring提供了读取外部properties文件的机制，使用读取到的数据为bean的属性赋值</p>
</li>
<li><p>操作步骤</p>
<p>1.准备外部properties文件</p>
<p>2.开启context命名空间支持</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​        3.加载指定的properties文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:filename.properties&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​        4.使用加载的数据</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;propertyName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;propertiesName&#125;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>注意：如果需要加载所有的properties文件，可以使用<code>*.properties</code>表示加载所有的properties文件</p>
</li>
<li><p>注意：读取数据使用**${propertiesName}<strong>格式进行，其中</strong>propertiesName**指properties文件中的属性名</p>
</li>
</ul>
<h3 id="4-12-团队开发"><a href="#4-12-团队开发" class="headerlink" title="4.12)团队开发"></a>4.12)团队开发</h3><ul>
<li><p>名称：import</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：beans标签</p>
</li>
<li><p>作用：在当前配置文件中导入其他配置文件中的项</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>基本属性：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">“config.xml</span>&quot;/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    resource：加载的配置文件名</p>
<ul>
<li><p>Spring容器加载多个配置文件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;config1.xml&quot;</span>,<span class="string">&quot;config2.xml&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>Spring容器中的bean定义冲突问题</p>
<ul>
<li><p>同id的bean，后定义的覆盖先定义的</p>
</li>
<li><p>导入配置文件可以理解为将导入的配置文件复制粘贴到对应位置</p>
</li>
<li><p>导入配置文件的顺序与位置不同可能会导致最终程序运行结果不同</p>
</li>
</ul>
</li>
</ul>
<h3 id="4-13-ApplicationContext"><a href="#4-13-ApplicationContext" class="headerlink" title="4.13)ApplicationContext"></a>4.13)ApplicationContext</h3><p>1.ApplicationContext是一个接口，提供了访问spring容器的API</p>
<p>2.ClassPathXmlApplicationContext是一个类，实现了上述功能</p>
<p>3.ApplicationContext的顶层接口是BeanFactory</p>
<p>4.BeanFactory定义了bean相关的最基本操作</p>
<p>5.ApplicationContext在BeanFactory基础上追加了若干新功能</p>
<p><strong>对比BeanFactory</strong></p>
<p>1.BeanFactory创建的bean采用延迟加载形式，使用才创建</p>
<p>2.ApplicationContext创建的bean默认采用立即加载形式</p>
<p><strong>FileSystemXmlApplicationContext</strong></p>
<p>可以加载文件系统中任意位置的配置文件，而ClassPathXmlApplicationContext只能加载类路径下的配置文件</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200859.png" alt="1591021082290"></p>
<p><strong>BeanFactory</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Resource res = <span class="keyword">new</span> ClassPathResource(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">BeanFactory bf = <span class="keyword">new</span> XmlBeanFactory(res);</span><br><span class="line">UserService userService = (UserService)bf.getBean(<span class="string">&quot;userService&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="4-14-第三方资源配置"><a href="#4-14-第三方资源配置" class="headerlink" title="4.14)第三方资源配置"></a>4.14)第三方资源配置</h3><ul>
<li><p>阿里数据源方案Druid</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/spring_ioc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="5-综合案例"><a href="#5-综合案例" class="headerlink" title="5)综合案例"></a>5)综合案例</h2><h3 id="5-1-案例介绍"><a href="#5-1-案例介绍" class="headerlink" title="5.1)案例介绍"></a><strong>5.1)案例介绍</strong></h3><ul>
<li><p>使用spring整合mybatis技术，完成账户模块（Account）的基础增删改查功能</p>
</li>
<li><p>账户模块对应字段</p>
<ul>
<li><p>编号：id</p>
</li>
<li><p>账户名：name</p>
</li>
<li><p>余额：money</p>
</li>
</ul>
</li>
</ul>
<h3 id="5-2-案例分析"><a href="#5-2-案例分析" class="headerlink" title="5.2)案例分析"></a><strong>5.2)案例分析</strong></h3><p>非spring环境</p>
<p>1.实体类与表</p>
<p>2.业务层接口与实现</p>
<p>3.数据层接口</p>
<p>4.Mybatis核心配置</p>
<p>5.Mybatis映射配置</p>
<p>6.客户端程序测试功能</p>
<p>spring环境</p>
<p>1.实体类与表</p>
<p>2.业务层接口与实现（提供数据层接口的注入操作）</p>
<p>3.数据层接口</p>
<p>4.Mybatis核心配置（交给spring控制，该文件省略）</p>
<p>5.Mybatis映射配置</p>
<p>6.客户端程序测试功能（使用spring方式获取bean）</p>
<p>7.Spring核心配置文件</p>
<p>8.Druid数据源的应用（可选）</p>
<p>9.Spring整合MyBatis</p>
<h3 id="5-3-案例制作步骤——基础准备工作"><a href="#5-3-案例制作步骤——基础准备工作" class="headerlink" title="5.3)案例制作步骤——基础准备工作"></a>5.3)案例制作步骤——基础准备工作</h3><ul>
<li>环境准备</li>
</ul>
<p>1.导入Spring坐标，MyBatis坐标，MySQL坐标，Druid坐标</p>
<ul>
<li>业务类与接口准备</li>
</ul>
<p>2.创建数据库表，并制作相应的实体类Account</p>
<p>3.定义业务层接口与数据层接口</p>
<p>4.在业务层调用数据层接口，并实现业务方法的调用</p>
<ul>
<li>基础配置文件</li>
</ul>
<p>5.jdbc.properties</p>
<p>6.MyBatis映射配置文件</p>
<h3 id="5-4-案例制作步骤——整合准备工作"><a href="#5-4-案例制作步骤——整合准备工作" class="headerlink" title="5.4)案例制作步骤——整合准备工作"></a>5.4)案例制作步骤——整合准备工作</h3><ul>
<li>整合前基础准备工作</li>
</ul>
<p>1.spring配置文件，加上context命名空间，用于加载properties文件</p>
<p>2.开启加载properties文件</p>
<p>3.配置数据源druid（备用）</p>
<p>4.定义service层bean，注入dao层bean</p>
<p>5.dao的bean无需定义，使用代理自动生成</p>
<h3 id="5-5-案例制作步骤——整合工作"><a href="#5-5-案例制作步骤——整合工作" class="headerlink" title="5.5)案例制作步骤——整合工作"></a>5.5)案例制作步骤——整合工作</h3><ul>
<li>整合工作</li>
</ul>
<p>1.导入Spring整合MyBatis坐标</p>
<p>2.将mybatis配置成spring管理的bean（SqlSessionFactoryBean）</p>
<p>​    -将原始配置文件中的所有项，转入到当前配置中</p>
<p>​    数据源转换</p>
<p>​    映射转换</p>
<p>3.通过spring加载mybatis的映射配置文件到spring环境中</p>
<p>4.设置类型别名</p>
<ul>
<li>测试结果</li>
</ul>
<p>5.使用spring环境加载业务层bean，执行操作</p>
<h3 id="小节"><a href="#小节" class="headerlink" title="小节"></a><strong>小节</strong></h3><ul>
<li><p>需要专用的spring整合mybatis的jar包</p>
</li>
<li><p>Mybatis核心配置文件消失</p>
<ul>
<li><p>环境environment转换成数据源对象</p>
</li>
<li><p>映射Mapper扫描工作交由spring处理</p>
</li>
<li><p>类型别名交由spring处理</p>
</li>
</ul>
</li>
<li><p>业务发起使用spring上下文对象获取对应的bean</p>
</li>
</ul>
<h1 id="注解开发"><a href="#注解开发" class="headerlink" title="注解开发"></a>注解开发</h1><h2 id="1-注解驱动的意义"><a href="#1-注解驱动的意义" class="headerlink" title="1)注解驱动的意义"></a>1)注解驱动的意义</h2><h3 id="1-1-什么是注解驱动"><a href="#1-1-什么是注解驱动" class="headerlink" title="1.1)什么是注解驱动"></a>1.1)什么是注解驱动</h3><p>注解启动时使用注解的形式替代xml配置，将繁杂的spring配置文件从工程中彻底消除掉，简化书写</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200920.png" alt="1591023265469"></p>
<h3 id="1-2-注解驱动的弊端"><a href="#1-2-注解驱动的弊端" class="headerlink" title="1.2)注解驱动的弊端"></a>1.2)注解驱动的弊端</h3><ul>
<li><p>为了达成注解驱动的目的，可能会将原先很简单的书写，变的更加复杂</p>
</li>
<li><p>XML中配置第三方开发的资源是很方便的，但使用注解驱动无法在第三方开发的资源中进行编辑，因此会增大开发工作量</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200921.png" alt="1591023337010"></p>
<h2 id="2-常用注解"><a href="#2-常用注解" class="headerlink" title="2)常用注解"></a>2)常用注解</h2><h3 id="2-1-启动注解功能"><a href="#2-1-启动注解功能" class="headerlink" title="2.1)启动注解功能"></a>2.1)启动注解功能</h3><ul>
<li><p>启动注解扫描，加载类中配置的注解项</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;packageName&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li><p>在进行包所扫描时，会对配置的包及其子包中所有文件进行扫描</p>
</li>
<li><p>扫描过程是以文件夹递归迭代的形式进行的</p>
</li>
<li><p>扫描过程仅读取合法的java文件</p>
</li>
<li><p>扫描时仅读取spring可识别的注解</p>
</li>
<li><p>扫描结束后会将可识别的有效注解转化为spring对应的资源加入IoC容器</p>
</li>
</ul>
</li>
<li><p>注意：</p>
<ul>
<li><p>无论是注解格式还是XML配置格式，最终都是将资源加载到IoC容器中，差别仅仅是数据读取方式不同</p>
</li>
<li><p>从加载效率上来说注解优于XML配置文件</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-2-bean的定义"><a href="#2-2-bean的定义" class="headerlink" title="2.2)bean的定义"></a>2.2)bean的定义</h3><ul>
<li><p>名称：@Component    @Controller    @Service    @Repository</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：设置该类为spring管理的bean</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li>@Controller、@Service 、@Repository是@Component的衍生注解，功能同@Component</li>
</ul>
</li>
<li><p>相关属性</p>
<ul>
<li>value（默认）：定义bean的访问id</li>
</ul>
</li>
</ul>
<h3 id="2-3-bean的作用域"><a href="#2-3-bean的作用域" class="headerlink" title="2.3)bean的作用域"></a>2.3)bean的作用域</h3><ul>
<li><p>名称：@Scope</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：设置该类作为bean对应的scope属性</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Scope</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>相关属性</p>
<ul>
<li>value（默认）：定义bean的作用域，默认为singleton</li>
</ul>
</li>
</ul>
<h3 id="2-4-bean的生命周期"><a href="#2-4-bean的生命周期" class="headerlink" title="2.4)bean的生命周期"></a>2.4)bean的生命周期</h3><ul>
<li><p>名称：@PostConstruct、@PreDestroy</p>
</li>
<li><p>类型：<strong>方法注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：设置该类作为bean对应的生命周期方法</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostConstruct</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">&quot;init...&quot;</span>); &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-5-加载第三方资源"><a href="#2-5-加载第三方资源" class="headerlink" title="2.5)加载第三方资源"></a>2.5)加载第三方资源</h3><ul>
<li><p>名称：@Bean</p>
</li>
<li><p>类型：<strong>方法注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：设置该方法的返回值作为spring管理的bean</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean(&quot;dataSource&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> DruidDataSource <span class="title">createDataSource</span><span class="params">()</span> </span>&#123;    <span class="keyword">return</span> ……;    &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li><p>因为第三方bean无法在其源码上进行修改，使用@Bean解决第三方bean的引入问题</p>
</li>
<li><p>该注解用于替代XML配置中的静态工厂与实例工厂创建bean，不区分方法是否为静态或非静态</p>
</li>
<li><p>@Bean所在的类必须被spring扫描加载，否则该注解无法生效</p>
</li>
</ul>
</li>
<li><p>相关属性</p>
<ul>
<li>value（默认）：定义bean的访问id</li>
</ul>
</li>
</ul>
<h3 id="2-6-bean的非引用类型属性注入"><a href="#2-6-bean的非引用类型属性注入" class="headerlink" title="2.6)bean的非引用类型属性注入"></a>2.6)bean的非引用类型属性注入</h3><ul>
<li><p>名称：@Value</p>
</li>
<li><p>类型：<strong>属性注解、方法注解</strong></p>
</li>
<li><p>位置：属性定义上方，方法定义上方</p>
</li>
<li><p>作用：设置对应属性的值或对方法进行传参</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String username;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li><p>value值仅支持非引用类型数据，赋值时对方法的所有参数全部赋值</p>
</li>
<li><p>value值支持读取properties文件中的属性值，通过类属性将properties中数据传入类中</p>
</li>
<li><p>value值支持SpEL</p>
</li>
<li><p>@value注解如果添加在属性上方，可以省略set方法（set方法的目的是为属性赋值）</p>
</li>
</ul>
</li>
<li><p>相关属性</p>
<ul>
<li>value（默认）：定义对应的属性值或参数值</li>
</ul>
</li>
</ul>
<h3 id="2-7-bean的引用类型属性注入"><a href="#2-7-bean的引用类型属性注入" class="headerlink" title="2.7)bean的引用类型属性注入"></a>2.7)bean的引用类型属性注入</h3><ul>
<li><p>名称：@Autowired、@Qualifier</p>
</li>
<li><p>类型：<strong>属性注解、方法注解</strong></p>
</li>
<li><p>位置：属性定义上方，方法定义上方</p>
</li>
<li><p>作用：设置对应属性的对象或对方法进行引用类型传参</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired(required = false)</span></span><br><span class="line"><span class="meta">@Qualifier(&quot;userDao&quot;)</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li>@Autowired默认按类型装配，指定@Qualifier后可以指定自动装配的bean的id</li>
</ul>
</li>
<li><p>相关属性</p>
<ul>
<li>required：定义该属性是否允许为null</li>
</ul>
</li>
</ul>
<h3 id="2-8-bean的引用类型属性注入"><a href="#2-8-bean的引用类型属性注入" class="headerlink" title="2.8)bean的引用类型属性注入"></a>2.8)bean的引用类型属性注入</h3><ul>
<li><p>名称：@Primary</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：设置类对应的bean按类型装配时优先装配</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li>@Autowired默认按类型装配，当出现相同类型的bean，使用@Primary提高按类型自动装配的优先级，多个@Primary会导致优先级设置无效</li>
</ul>
</li>
</ul>
<h3 id="2-9-bean的引用类型属性注入"><a href="#2-9-bean的引用类型属性注入" class="headerlink" title="2.9)bean的引用类型属性注入"></a>2.9)bean的引用类型属性注入</h3><ul>
<li><p>名称：@Inject、@Named、@Resource</p>
</li>
<li><p>说明：</p>
<ul>
<li>@Inject与@Named是JSR330规范中的注解，功能与@Autowired和@Qualifier完全相同，适用于不同架构场景</li>
<li>@Resource是JSR250规范中的注解，可以简化书写格式</li>
</ul>
</li>
<li><p>@Resource相关属性</p>
<ul>
<li><p>name：设置注入的bean的id</p>
</li>
<li><p>type：设置注入的bean的类型，接收的参数为Class类型</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-10-加载properties文件"><a href="#2-10-加载properties文件" class="headerlink" title="2.10)加载properties文件"></a>2.10)加载properties文件</h3><ul>
<li><p>名称：@PropertySource</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：加载properties文件中的属性值</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PropertySource(value = &quot;classpath:filename.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;propertiesAttributeName&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String attributeName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li>不支持*通配格式，一旦加载，所有spring控制的bean中均可使用对应属性值</li>
</ul>
</li>
<li><p>相关属性</p>
<ul>
<li><p>value（默认）：设置加载的properties文件名</p>
</li>
<li><p>ignoreResourceNotFound：如果资源未找到，是否忽略，默认为false</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-11-纯注解格式"><a href="#2-11-纯注解格式" class="headerlink" title="2.11)纯注解格式"></a>2.11)纯注解格式</h3><ul>
<li><p>名称：@Configuration、@ComponentScan</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：设置当前类为spring核心配置加载类</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;scanPackageName&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfigClassName</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li><p>核心配合类用于替换spring核心配置文件，此类可以设置空的，不设置变量与属性</p>
</li>
<li><p>bean扫描工作使用注解@ComponentScan替代</p>
</li>
</ul>
</li>
</ul>
<p><strong>AnnotationConfigApplicationContext</strong></p>
<ul>
<li><p>加载纯注解格式上下文对象，需要使用AnnotationConfigApplicationContext</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-12-第三方bean配置与管理"><a href="#2-12-第三方bean配置与管理" class="headerlink" title="2.12)第三方bean配置与管理"></a>2.12)第三方bean配置与管理</h3><ul>
<li><p>名称：@Import</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：导入第三方bean作为spring控制的资源</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import(OtherClassName.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li><p>@Import注解在同一个类上，仅允许添加一次，如果需要导入多个，使用数组的形式进行设定</p>
</li>
<li><p>在被导入的类中可以继续使用@Import导入其他资源（了解）</p>
</li>
<li><p>@Bean所在的类可以使用导入的形式进入spring容器，无需声明为bean</p>
</li>
</ul>
</li>
</ul>
<h2 id="3-bean加载控制"><a href="#3-bean加载控制" class="headerlink" title="3)bean加载控制"></a>3)bean加载控制</h2><h3 id="3-1-依赖加载"><a href="#3-1-依赖加载" class="headerlink" title="3.1)依赖加载"></a>3.1)依赖加载</h3><p>(1)@DependsOn</p>
<ul>
<li><p>名称：@DependsOn</p>
</li>
<li><p>类型：类注解、方法注解</p>
</li>
<li><p>位置：bean定义的位置（类上或方法上）</p>
</li>
<li><p>作用：控制bean的加载顺序，使其在指定bean加载完毕后再加载</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@DependsOn(&quot;beanId&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<ul>
<li><p>配置在方法上，使@DependsOn指定的bean优先于@Bean配置的bean进行加载</p>
</li>
<li><p>配置在类上，使@DependsOn指定的bean优先于当前类中所有@Bean配置的bean进行加载</p>
</li>
<li><p>配置在类上，使@DependsOn指定的bean优先于@Component等配置的bean进行加载</p>
</li>
</ul>
</li>
<li><p>相关属性</p>
<ul>
<li>value（默认）：设置当前bean所依赖的bean的id</li>
</ul>
</li>
</ul>
<p>(2)@Order</p>
<ul>
<li><p>名称：@Order</p>
</li>
<li><p>类型：<strong>配置类注解</strong></p>
</li>
<li><p>位置：配置类定义的位置（类上）</p>
</li>
<li><p>作用：控制配置类的加载顺序</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Order(1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfigClassName</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>(3)@Lazy</p>
<ul>
<li><p>名称：@Lazy</p>
</li>
<li><p>类型：<strong>类注解、方法注解</strong></p>
</li>
<li><p>位置：bean定义的位置（类上或方法上）</p>
</li>
<li><p>作用：控制bean的加载时机，使其延迟加载</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Lazy</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-2-依赖加载应用场景"><a href="#3-2-依赖加载应用场景" class="headerlink" title="3.2)依赖加载应用场景"></a><strong>3.2)依赖加载应用场景</strong></h3><p>@DependsOn</p>
<ul>
<li><p>微信订阅号，发布消息和订阅消息的bean的加载顺序控制</p>
</li>
<li><p>双11活动期间，零点前是结算策略A，零点后是结算策略B，策略B操作的数据为促销数据。策略B加载顺序与促销数据的加载顺序</p>
</li>
</ul>
<p>@Lazy</p>
<ul>
<li>程序灾难出现后对应的应急预案处理是启动容器时加载时机</li>
</ul>
<p>@Order</p>
<ul>
<li>多个种类的配置出现后，优先加载系统级的，然后加载业务级的，避免细粒度的加载控制</li>
</ul>
<h2 id="4-整合第三方技术"><a href="#4-整合第三方技术" class="headerlink" title="4)整合第三方技术"></a>4)整合第三方技术</h2><h3 id="4-1-综合案例改版（注解整合MyBatis）"><a href="#4-1-综合案例改版（注解整合MyBatis）" class="headerlink" title="4.1)综合案例改版（注解整合MyBatis）"></a>4.1)综合案例改版（注解整合MyBatis）</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200922.png" alt="1591024717408"></p>
<h3 id="4-2-注解整合MyBatis分析"><a href="#4-2-注解整合MyBatis分析" class="headerlink" title="4.2)注解整合MyBatis分析"></a>4.2)注解整合MyBatis分析</h3><ul>
<li><p>业务类使用注解形式声明bean，属性采用注解注入</p>
</li>
<li><p>建立独立的配置管理类，分类管理外部资源，根据功能进行分类，并提供对应的方法获取bean</p>
</li>
<li><p>使用注解形式启动bean扫描，加载所有注解配置的资源（bean）</p>
</li>
<li><p>使用AnnotationConfigApplicationContext对象加载所有的启动配置类，内部使用导入方式进行关联</p>
</li>
</ul>
<h3 id="4-3-注解整合MyBatis步骤"><a href="#4-3-注解整合MyBatis步骤" class="headerlink" title="4.3)注解整合MyBatis步骤"></a>4.3)注解整合MyBatis步骤</h3><p>1.修改mybatis外部配置文件格式为注解格式</p>
<p>2.业务类使用@Component声明bean，使用@Autowired注入对象</p>
<p>3.建立配置文件JDBCConfig与MyBatisConfig类，并将其导入到核心配置类SpringConfig</p>
<p>4.开启注解扫描</p>
<p>5.使用AnnotationConfigApplicationContext对象加载配置项</p>
<h3 id="4-4-综合案例改版（注解整合Junit）"><a href="#4-4-综合案例改版（注解整合Junit）" class="headerlink" title="4.4)综合案例改版（注解整合Junit）"></a>4.4)综合案例改版（注解整合Junit）</h3><p>1.Spring接管Junit的运行权，使用Spring专用的Junit类加载器</p>
<p>2.为Junit测试用例设定对应的spring容器：</p>
<ul>
<li><p>从Spring5.0以后，要求Junit的版本必须是4.12及以上</p>
</li>
<li><p>Junit仅用于单元测试，不能将Junit的测试类配置成spring的bean，否则该配置将会被打包进入工程中 </p>
</li>
</ul>
<p>导入Spring整合Junit坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Spring整合Junit测试用例注解格式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@ContextConfiguration(classes = SpringConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceTest</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-IoC底层核心原理"><a href="#5-IoC底层核心原理" class="headerlink" title="5)IoC底层核心原理"></a>5)IoC底层核心原理</h2><h3 id="5-1-IoC核心接口"><a href="#5-1-IoC核心接口" class="headerlink" title="5.1)IoC核心接口"></a>5.1)IoC核心接口</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200923.png" alt="1591024936518"></p>
<h3 id="5-2-组件扫描器"><a href="#5-2-组件扫描器" class="headerlink" title="5.2)组件扫描器"></a><strong>5.2)组件扫描器</strong></h3><ul>
<li>开发过程中，需要根据需求加载必要的bean，排除指定bean</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200924.png" alt="1591024975438"></p>
<h3 id="5-3-设定组件扫描加载过滤器"><a href="#5-3-设定组件扫描加载过滤器" class="headerlink" title="5.3)设定组件扫描加载过滤器"></a><strong>5.3)设定组件扫描加载过滤器</strong></h3><ul>
<li><p>名称：@ComponentScan</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：设置spring配置加载类扫描规则</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(</span></span><br><span class="line"><span class="meta">    value=&quot;com.itheima&quot;,	           //设置基础扫描路径</span></span><br><span class="line"><span class="meta">    excludeFilters =                          //设置过滤规则，当前为排除过滤</span></span><br><span class="line"><span class="meta">	@ComponentScan.Filter(            //设置过滤器</span></span><br><span class="line"><span class="meta">	    type= FilterType.ANNOTATION,  //设置过滤方式为按照注解进行过滤</span></span><br><span class="line"><span class="meta">	    classes=Repository.class)     //设置具体的过滤项，过滤所有@Repository修饰的bean</span></span><br><span class="line"><span class="meta">    )</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    includeFilters：设置包含性过滤器</p>
<p>​    excludeFilters：设置排除性过滤器</p>
<p>​    type：设置过滤器类型</p>
<h3 id="5-4-自定义组件过滤器"><a href="#5-4-自定义组件过滤器" class="headerlink" title="5.4)自定义组件过滤器"></a><strong>5.4)自定义组件过滤器</strong></h3><ul>
<li><p>名称：TypeFilter</p>
</li>
<li><p>类型：<strong>接口</strong></p>
</li>
<li><p>作用：自定义类型过滤器</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTypeFilter</span> <span class="keyword">implements</span> <span class="title">TypeFilter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">match</span><span class="params">(MetadataReader mr, MetadataReaderFactory mrf)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ClassMetadata cm = metadataReader.getClassMetadata();</span><br><span class="line">        tring className = cm.getClassName();</span><br><span class="line">        <span class="keyword">if</span>(className.equals(<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-5-自定义导入器"><a href="#5-5-自定义导入器" class="headerlink" title="5.5)自定义导入器"></a><strong>5.5)自定义导入器</strong></h3><ul>
<li><p>bean只有通过配置才可以进入spring容器，被spring加载并控制</p>
</li>
<li><p>配置bean的方式如下：</p>
<ul>
<li><p>XML文件中使用<bean/>标签配置</p>
</li>
<li><p>使用@Component及衍生注解配置</p>
</li>
</ul>
</li>
<li><p>企业开发过程中，通常需要配置大量的bean，需要一种快速高效配置大量bean的方式</p>
</li>
</ul>
<p><strong>ImportSelector</strong></p>
<ul>
<li><p>名称： ImportSelector</p>
</li>
<li><p>类型：<strong>接口</strong></p>
</li>
<li><p>作用：自定义bean导入器</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImportSelector</span> <span class="keyword">implements</span> <span class="title">ImportSelector</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String[] selectImports(AnnotationMetadata icm) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String[]&#123;<span class="string">&quot;com.itheima.dao.impl.AccountDaoImpl&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@Import(MyImportSelector.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-6-自定义注册器"><a href="#5-6-自定义注册器" class="headerlink" title="5.6)自定义注册器"></a><strong>5.6)自定义注册器</strong></h3><ul>
<li><p>名称：ImportBeanDefinitionRegistrar</p>
</li>
<li><p>类型：<strong>接口</strong></p>
</li>
<li><p>作用：自定义bean定义注册器</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImportBeanDefinitionRegistrar</span> <span class="keyword">implements</span> <span class="title">ImportBeanDefinitionRegistrar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerBeanDefinitions</span><span class="params">(AnnotationMetadata icm, BeanDefinitionRegistry r)</span> </span>&#123;</span><br><span class="line">        ClassPathBeanDefinitionScanner scanner = <span class="keyword">new</span> ClassPathBeanDefinitionScanner(r, <span class="keyword">false</span>);</span><br><span class="line">        TypeFilter tf = <span class="keyword">new</span> TypeFilter() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">match</span><span class="params">(MetadataReader mr, MetadataReaderFactory mrf)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        scanner.addIncludeFilter(tf);</span><br><span class="line">        <span class="comment">//scanner.addExcludeFilter(tf);</span></span><br><span class="line">        scanner.scan(<span class="string">&quot;com.itheima&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-7-bean初始化过程解析"><a href="#5-7-bean初始化过程解析" class="headerlink" title="5.7)bean初始化过程解析"></a>5.7)bean初始化过程解析</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200925.png" alt="1591025338778"></p>
<h3 id="5-8-bean初始化过程解析"><a href="#5-8-bean初始化过程解析" class="headerlink" title="5.8)bean初始化过程解析"></a>5.8)bean初始化过程解析</h3><ul>
<li><p>BeanFactoryPostProcessor</p>
<ul>
<li><p>作用：定义了在bean工厂对象创建后，bean对象创建前执行的动作，用于对工厂进行创建后业务处理</p>
</li>
<li><p>运行时机：当前操作用于对工厂进行处理，仅运行一次</p>
</li>
</ul>
</li>
<li><p>BeanPostProcessor</p>
<ul>
<li><p>作用：定义了所有bean初始化前后进行的统一动作，用于对bean进行创建前业务处理与创建后业务处理</p>
</li>
<li><p>运行时机：当前操作伴随着每个bean的创建过程，每次创建bean均运行该操作</p>
</li>
</ul>
</li>
<li><p>InitializingBean</p>
<ul>
<li><p>作用：定义了每个bean的初始化前进行的动作，属于非统一性动作，用于对bean进行创建前业务处理</p>
</li>
<li><p>运行时机：当前操作伴随着任意一个bean的创建过程，保障其个性化业务处理</p>
</li>
</ul>
</li>
<li><p>注意：上述操作均需要被spring容器加载放可运行</p>
</li>
</ul>
<h3 id="5-9-bean初始化过程解析"><a href="#5-9-bean初始化过程解析" class="headerlink" title="5.9)bean初始化过程解析"></a>5.9)bean初始化过程解析</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208200926.png" alt="1591025440019"></p>
<h3 id="5-10-繁琐的bean初始化过程处理"><a href="#5-10-繁琐的bean初始化过程处理" class="headerlink" title="5.10)繁琐的bean初始化过程处理"></a>5.10)繁琐的bean初始化过程处理</h3><ul>
<li>FactoryBean<ul>
<li>对单一的bean的初始化过程进行封装，达到简化配置的目的</li>
</ul>
</li>
</ul>
<p><strong>FactoryBean与BeanFactory区别</strong></p>
<ul>
<li><p>FactoryBean：封装单个bean的创建过程</p>
</li>
<li><p>BeanFactory：Spring容器顶层接口，定义了bean相关的获取操作</p>
</li>
</ul>
<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><h2 id="1-AOP简介"><a href="#1-AOP简介" class="headerlink" title="1)AOP简介"></a>1)AOP简介</h2><h3 id="1-1-OOP开发思路"><a href="#1-1-OOP开发思路" class="headerlink" title="1.1)OOP开发思路"></a>1.1)OOP开发思路</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201011.png" alt="1591281580135"></p>
<h3 id="1-2-AOP开发思想"><a href="#1-2-AOP开发思想" class="headerlink" title="1.2)AOP开发思想"></a>1.2)AOP开发思想</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201012.png" alt="1591281706237"></p>
<h3 id="1-3-AOP概念"><a href="#1-3-AOP概念" class="headerlink" title="1.3)AOP概念"></a>1.3)AOP概念</h3><ul>
<li><p>AOP(Aspect Oriented Programing)面向切面编程，一种编程<strong>范式</strong>，隶属于软工范畴，指导开发者如何组织程序结构</p>
</li>
<li><p>AOP弥补了OOP的不足，基于OOP基础之上进行横向开发</p>
<ul>
<li><p>uOOP规定程序开发以类为主体模型，一切围绕对象进行，完成某个任务先构建模型</p>
</li>
<li><p>uAOP程序开发主要关注基于OOP开发中的共性功能，一切围绕共性功能进行，完成某个任务先构建可能遇到的所有共性功能（当所有功能都开发出来也就没有共性与非共性之分）</p>
</li>
</ul>
</li>
<li><p>“AOP联盟”</p>
</li>
</ul>
<h3 id="1-4-AOP作用"><a href="#1-4-AOP作用" class="headerlink" title="1.4)AOP作用"></a>1.4)AOP作用</h3><ul>
<li><p>伴随着AOP时代的降临，可以从各个行业的标准化、规范化开始入手，一步一步将所有共性功能逐一开发完毕，最终以功能组合来完成个别业务模块乃至整体业务系统的开发</p>
</li>
<li><p>目标：将软件开发由手工制作走向半自动化/全自动化阶段，实现“插拔式组件体系结构”搭建</p>
</li>
</ul>
<h3 id="1-5-AOP优势"><a href="#1-5-AOP优势" class="headerlink" title="1.5)AOP优势"></a>1.5)AOP优势</h3><ul>
<li><p>提高代码的可重用性</p>
</li>
<li><p>业务代码编码更简洁</p>
</li>
<li><p>业务代码维护更高效</p>
</li>
<li><p>业务功能扩展更便捷</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201013.png" alt="1591281844901"></p>
<h2 id="2-AOP入门案例"><a href="#2-AOP入门案例" class="headerlink" title="2)AOP入门案例"></a>2)AOP入门案例</h2><h3 id="2-1-AOP相关概念"><a href="#2-1-AOP相关概念" class="headerlink" title="2.1)AOP相关概念"></a>2.1)AOP相关概念</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201014.png" alt="1591281889446"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201015.png" alt="1591281914574"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201016.png" alt="1591281945260"></p>
<ul>
<li><p>Joinpoint(连接点)：就是方法</p>
</li>
<li><p>Pointcut(切入点)：就是挖掉共性功能的方法</p>
</li>
<li><p>Advice(通知)：就是共性功能，最终以一个方法的形式呈现</p>
</li>
<li><p>Aspect(切面)：就是共性功能与挖的位置的对应关系</p>
</li>
<li><p>Target(目标对象)：就是挖掉功能的方法对应的类产生的对象，这种对象是无法直接完成最终工作的</p>
</li>
<li><p>Weaving(织入)：就是将挖掉的功能回填的动态过程</p>
</li>
<li><p>Proxy(代理)：目标对象无法直接完成工作，需要对其进行功能回填，通过创建原始对象的代理对象实现</p>
</li>
<li><p>Introduction(引入/引介) ：就是对原始对象无中生有的添加成员变量或成员方法</p>
</li>
</ul>
<h3 id="2-2-AOP开发过程"><a href="#2-2-AOP开发过程" class="headerlink" title="2.2)AOP开发过程"></a>2.2)AOP开发过程</h3><ul>
<li><p>开发阶段(开发者完成)</p>
<ul>
<li><p>正常的制作程序</p>
</li>
<li><p>将非共性功能开发到对应的目标对象类中，并制作成切入点方法</p>
</li>
<li><p>将共性功能独立开发出来，制作成<strong>通知</strong></p>
</li>
<li><p>在配置文件中，声明<strong>切入点</strong></p>
</li>
<li><p>在配置文件中，声明<strong>切入点</strong>与<strong>通知</strong>间的关系（含<strong>通知类型</strong>），即<strong>切面</strong></p>
</li>
</ul>
</li>
<li><p>运行阶段(AOP完成)</p>
<ul>
<li><p>Spring容器加载配置文件，监控所有配置的<strong>切入点</strong>方法的执行</p>
</li>
<li><p>当监控到<strong>切入点</strong>方法被运行，使用<strong>代理</strong>机制，动态创建<strong>目标对象</strong>的<strong>代理对象</strong>，根据<strong>通知类别</strong>，在<strong>代理对象</strong>的对应位置将<strong>通知</strong>对应的功能<strong>织入</strong>，完成完整的代码逻辑并运行</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-2-AOP开发方式"><a href="#2-2-AOP开发方式" class="headerlink" title="2.2)AOP开发方式"></a>2.2)AOP开发方式</h3><ul>
<li><p>XML方式</p>
</li>
<li><p>XML+注解方式</p>
</li>
<li><p>注解方式</p>
</li>
</ul>
<h3 id="2-3-入门案例制作分析"><a href="#2-3-入门案例制作分析" class="headerlink" title="2.3)入门案例制作分析"></a>2.3)入门案例制作分析</h3><p>1.导入相关坐标</p>
<p>2.确认要抽取的功能，并将其制作成方法保存到专用的类中，删除原始业务中对应的功能</p>
<p>3.将所有进行AOP操作的资源加载到IoC容器中</p>
<p>4.使用配置的方式描述被抽取功能的位置，并描述被抽取功能与对应位置的关系</p>
<p>5.运行程序</p>
<p>步骤一 导入坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>步骤二 在业务层抽取通用代码</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201017.png" alt="1591282302976"></p>
<p>步骤三 把通知加入spring容器管理</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201018.png" alt="1591282320624"></p>
<p>步骤四 在配置文件中配置aop的配置 </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--aop配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置切入点--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *..*())&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置切面--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">        &lt;!—通知与切入点之间的关系--&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;logAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-AOP配置（XML）"><a href="#3-AOP配置（XML）" class="headerlink" title="3)AOP配置（XML）"></a>3)AOP配置（XML）</h2><h3 id="3-1-AspectJ"><a href="#3-1-AspectJ" class="headerlink" title="3.1)AspectJ"></a>3.1)<strong>AspectJ</strong></h3><ul>
<li><p>Aspect（切面）用于描述切入点与通知间的关系，是AOP编程中的一个概念</p>
</li>
<li><p>AspectJ是基于java语言对Aspect的实现</p>
</li>
</ul>
<h3 id="3-2-AOP配置"><a href="#3-2-AOP配置" class="headerlink" title="3.2)AOP配置"></a>3.2)AOP配置</h3><h4 id="3-2-1-aop-config"><a href="#3-2-1-aop-config" class="headerlink" title="3.2.1)aop:config"></a>3.2.1)aop:config</h4><ul>
<li><p>名称：aop:config</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：beans标签</p>
</li>
<li><p>作用：设置AOP</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span>……<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span>……<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>说明：一个beans标签中可以配置多个aop:config标签</p>
</li>
</ul>
<h4 id="3-2-2-aop-aspect"><a href="#3-2-2-aop-aspect" class="headerlink" title="3.2.2)aop:aspect"></a>3.2.2)aop:aspect</h4><ul>
<li><p>名称：aop:aspect</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：aop:config标签</p>
</li>
<li><p>作用：设置具体的AOP通知对应的切入点</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;beanId&quot;</span>&gt;</span>……<span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;beanId&quot;</span>&gt;</span>……<span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<p>一个aop:config标签中可以配置多个aop:aspect标签</p>
</li>
<li><p>基本属性：</p>
<ul>
<li>ref ：通知所在的bean的id</li>
</ul>
</li>
</ul>
<h4 id="3-2-3-aop-pointcut"><a href="#3-2-3-aop-pointcut" class="headerlink" title="3.2.3)aop:pointcut"></a>3.2.3)aop:pointcut</h4><ul>
<li><p>名称：aop:pointcut</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：aop:config标签、aop:aspect标签</p>
</li>
<li><p>作用：设置切入点</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointcutId&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;……&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointcutId&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;……&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<p>一个aop:config标签中可以配置多个aop:pointcut标签，且该标签可以配置在aop:aspect标签内</p>
</li>
<li><p>基本属性：</p>
<ul>
<li><p>id ：识别切入点的名称</p>
</li>
<li><p>expression ：切入点表达式</p>
</li>
</ul>
</li>
</ul>
<h3 id="3-3-切入点"><a href="#3-3-切入点" class="headerlink" title="3.3)切入点"></a><strong>3.3)切入点</strong></h3><ul>
<li><p>切入点描述的是某个方法</p>
</li>
<li><p>切入点表达式是一个快速匹配方法描述的通配格式，类似于正则表达式</p>
</li>
</ul>
<h3 id="3-4-切入点表达式的组成"><a href="#3-4-切入点表达式的组成" class="headerlink" title="3.4)切入点表达式的组成"></a><strong>3.4)切入点表达式的组成</strong></h3><ul>
<li><p>切入点描述的是某个方法</p>
</li>
<li><p>切入点表达式是一个快速匹配方法描述的通配格式，类似于正则表达式</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">关键字（访问修饰符  返回值  包名.类名.方法名（参数）异常名）</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    关键字：描述表达式的匹配模式（参看关键字列表）</p>
<p>​    访问修饰符：方法的访问控制权限修饰符</p>
<p>​    类名：方法所在的类（此处可以配置接口名称）</p>
<p>​    异常：方法定义中指定抛出的异常</p>
<ul>
<li><p>范例：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">execution（public User com.itheima.service.UserService.findById（int））</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-4-1-切入点表达式——关键字"><a href="#3-4-1-切入点表达式——关键字" class="headerlink" title="3.4.1)切入点表达式——关键字"></a>3.4.1)切入点表达式——关键字</h4><ul>
<li><p>execution ：匹配执行指定方法</p>
</li>
<li><p>args ：匹配带有指定参数类型的方法</p>
</li>
<li><p>within ：…… </p>
</li>
<li><p>this ：…… </p>
</li>
<li><p>target ：…… </p>
</li>
<li><p>@within ：…… </p>
</li>
<li><p>@target ：…… </p>
</li>
<li><p>@args ：…… </p>
</li>
<li><p>@annotation ：…… </p>
</li>
<li><p>bean ：……</p>
</li>
<li><p>reference pointcut ：……</p>
</li>
</ul>
<h4 id="3-4-2-切入点表达式——通配符"><a href="#3-4-2-切入点表达式——通配符" class="headerlink" title="3.4.2)切入点表达式——通配符"></a>3.4.2)切入点表达式——<strong>通配符</strong></h4><ul>
<li><p>*：单个独立的任意符号，可以独立出现，也可以作为前缀或者后缀的匹配符出现</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">execution（public * com.itheima.*.UserService.find*（*））</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    匹配com.itheima包下的任意包中的UserService类或接口中所有find开头的带有一个参数的方法</p>
<ul>
<li><p>.. ：多个连续的任意符号，可以独立出现，常用于简化包名与参数的书写</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">execution（public User com..UserService.findById（..））</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    匹配com包下的任意包中的UserService类或接口中所有名称为findById的方法</p>
<ul>
<li><p>+：专用于匹配子类类型</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">execution(* *..*Service+.*(..))</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-4-3-切入点表达式——逻辑运算符"><a href="#3-4-3-切入点表达式——逻辑运算符" class="headerlink" title="3.4.3)切入点表达式——逻辑运算符"></a>3.4.3)切入点表达式——逻辑运算符</h4><ul>
<li><p>&amp;&amp; ：连接两个切入点表达式，表示两个切入点表达式同时成立的匹配</p>
</li>
<li><p>|| ：连接两个切入点表达式，表示两个切入点表达式成立任意一个的匹配</p>
</li>
<li><p>! ：连接单个切入点表达式，表示该切入点表达式不成立的匹配</p>
</li>
</ul>
<h4 id="3-4-4-切入点表达式——范例"><a href="#3-4-4-切入点表达式——范例" class="headerlink" title="3.4.4)切入点表达式——范例"></a>3.4.4)切入点表达式——范例</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">execution(* *(..))</span><br><span class="line">execution(* *..*(..))</span><br><span class="line">execution(* *..*.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> * *..*.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">int</span> *..*.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">void</span> *..*.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">void</span> com..*.*(..)) </span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">void</span> com..service.*.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">void</span> com.itheima.service.*.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">void</span> com.itheima.service.User*.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">void</span> com.itheima.service.*Service.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> <span class="keyword">void</span> com.itheima.service.UserService.*(..))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.find*(..))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.*Id(..))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.findById(..))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.findById(<span class="keyword">int</span>))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.findById(<span class="keyword">int</span>,<span class="keyword">int</span>))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.findById(<span class="keyword">int</span>,*))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.findById(*,<span class="keyword">int</span>))</span><br><span class="line">execution(<span class="keyword">public</span> User com.itheima.service.UserService.findById())</span><br><span class="line">execution(List com.itheima.service.*Service+.findAll(..))</span><br></pre></td></tr></table></figure>

<h3 id="3-5-切入点的三种配置方式"><a href="#3-5-切入点的三种配置方式" class="headerlink" title="3.5)切入点的三种配置方式"></a><strong>3.5)切入点的三种配置方式</strong></h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置公共切入点--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt1&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置局部切入点--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt2&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *(..))&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--引用公共切入点--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;logAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--引用局部切入点--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;logAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--直接配置切入点--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;logAdvice&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;execution(* *(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-6-切入点配置经验"><a href="#3-6-切入点配置经验" class="headerlink" title="3.6)切入点配置经验"></a><strong>3.6)切入点配置经验</strong></h3><ul>
<li><p>企业开发命名规范严格遵循规范文档进行</p>
</li>
<li><p>先为方法配置局部切入点</p>
</li>
<li><p>再抽取类中公共切入点</p>
</li>
<li><p>最后抽取全局切入点</p>
</li>
<li><p>代码走查过程中检测切入点是否存在越界性包含</p>
</li>
<li><p>代码走查过程中检测切入点是否存在非包含性进驻</p>
</li>
<li><p>设定AOP执行检测程序，在单元测试中监控通知被执行次数与预计次数是否匹配</p>
</li>
<li><p>设定完毕的切入点如果发生调整务必进行回归测试</p>
</li>
</ul>
<p>（以上规则适用于XML配置格式）</p>
<h3 id="3-7-通知类型"><a href="#3-7-通知类型" class="headerlink" title="3.7)通知类型"></a><strong>3.7)通知类型</strong></h3><p>AOP的通知类型共5种</p>
<ul>
<li><p>前置通知：原始方法执行前执行，如果通知中抛出异常，阻止原始方法运行</p>
<p>应用：数据校验</p>
</li>
<li><p>后置通知：原始方法执行后执行，无论原始方法中是否出现异常，都将执行通知</p>
<p>  应用：现场清理</p>
</li>
<li><p>返回后通知：原始方法正常执行完毕并返回结果后执行，如果原始方法中抛出异常，无法执行</p>
<p>  应用：返回值相关数据处理</p>
</li>
<li><p>抛出异常后通知：原始方法抛出异常后执行，如果原始方法没有抛出异常，无法执行</p>
<p>  应用：对原始方法中出现的异常信息进行处理</p>
</li>
<li><p>环绕通知：在原始方法执行前后均有对应执行执行，还可以阻止原始方法的执行</p>
<p>  应用：十分强大，可以做任何事情</p>
</li>
</ul>
<h4 id="3-7-1-aop-before"><a href="#3-7-1-aop-before" class="headerlink" title="3.7.1)aop:before"></a>3.7.1)aop:before</h4><ul>
<li><p>名称：aop:before</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：aop:aspect标签</p>
</li>
<li><p>作用：设置前置通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;adviceId&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;methodName&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;……&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p> 说明：一个aop:aspect标签中可以配置多个aop:before标签</p>
</li>
<li><p>基本属性：</p>
<ul>
<li><p>method ：在通知类中设置当前通知类别对应的方法</p>
</li>
<li><p>pointcut ：设置当前通知对应的切入点表达式，与pointcut-ref属性冲突</p>
</li>
<li><p>pointcut-ref ：设置当前通知对应的切入点id，与pointcut属性冲突</p>
</li>
</ul>
</li>
</ul>
<h4 id="3-7-2-aop-after"><a href="#3-7-2-aop-after" class="headerlink" title="3.7.2)aop:after"></a>3.7.2)aop:after</h4><ul>
<li><p>名称：aop:after</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：aop:aspect标签</p>
</li>
<li><p>作用：设置后置通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;adviceId&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;methodName&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;……&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p> 说明：一个aop:aspect标签中可以配置多个aop:after标签</p>
</li>
<li><p>基本属性：</p>
<ul>
<li><p>method ：在通知类中设置当前通知类别对应的方法</p>
</li>
<li><p>pointcut ：设置当前通知对应的切入点表达式，与pointcut-ref属性冲突</p>
</li>
<li><p>pointcut-ref ：设置当前通知对应的切入点id，与pointcut属性冲突</p>
</li>
</ul>
</li>
</ul>
<h4 id="3-7-3-aop-after-returning"><a href="#3-7-3-aop-after-returning" class="headerlink" title="3.7.3)aop:after-returning"></a>3.7.3)aop:after-returning</h4><ul>
<li><p>名称：aop:after-returning</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：aop:aspect标签</p>
</li>
<li><p>作用：设置返回后通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;adviceId&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">&quot;methodName&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;……&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p> 说明：一个aop:aspect标签中可以配置多个aop:after-returning标签</p>
</li>
<li><p>基本属性：</p>
<ul>
<li><p>method ：在通知类中设置当前通知类别对应的方法</p>
</li>
<li><p>pointcut ：设置当前通知对应的切入点表达式，与pointcut-ref属性冲突</p>
</li>
<li><p>pointcut-ref ：设置当前通知对应的切入点id，与pointcut属性冲突</p>
</li>
</ul>
</li>
</ul>
<h4 id="3-7-4-aop-after-throwing"><a href="#3-7-4-aop-after-throwing" class="headerlink" title="3.7.4)aop:after-throwing"></a>3.7.4)aop:after-throwing</h4><ul>
<li><p>名称：aop:after-throwing</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：aop:aspect标签</p>
</li>
<li><p>作用：设置抛出异常后通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;adviceId&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">&quot;methodName&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;……&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p> 说明：一个aop:aspect标签中可以配置多个aop:after-throwing标签</p>
</li>
<li><p>基本属性：</p>
<ul>
<li><p>method ：在通知类中设置当前通知类别对应的方法</p>
</li>
<li><p>pointcut ：设置当前通知对应的切入点表达式，与pointcut-ref属性冲突</p>
</li>
<li><p>pointcut-ref ：设置当前通知对应的切入点id，与pointcut属性冲突</p>
</li>
</ul>
</li>
</ul>
<h4 id="3-7-5-aop-around"><a href="#3-7-5-aop-around" class="headerlink" title="3.7.5)aop:around"></a>3.7.5)aop:around</h4><ul>
<li><p>名称：aop:around</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：aop:aspect标签</p>
</li>
<li><p>作用：设置环绕通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;adviceId&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;methodName&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;……&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p> 说明：一个aop:aspect标签中可以配置多个aop:around标签</p>
</li>
<li><p>基本属性：</p>
<ul>
<li><p>method ：在通知类中设置当前通知类别对应的方法</p>
</li>
<li><p>pointcut ：设置当前通知对应的切入点表达式，与pointcut-ref属性冲突</p>
</li>
<li><p>pointcut-ref ：设置当前通知对应的切入点id，与pointcut属性冲突</p>
</li>
</ul>
</li>
</ul>
<p>环绕通知的开发方式</p>
<ul>
<li><p>环绕通知是在原始方法的前后添加功能，在环绕通知中，存在对原始方法的显式调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    Object ret = pjp.proceed();</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>环绕通知方法相关说明：</p>
<ul>
<li><p>方法须设定Object类型的返回值，否则会拦截原始方法的返回。如果原始方法返回值类型为void，通知方    也可以设定返回值类型为void，最终返回null</p>
</li>
<li><p>方法需在第一个参数位置设定ProceedingJoinPoint对象，通过该对象调用proceed()方法，实现对原始方法的调用。如省略该参数，原始方法将无法执行</p>
</li>
<li><p>使用proceed()方法调用原始方法时，因无法预知原始方法运行过程中是否会出现异常，强制抛出Throwable对象，封装原始方法中可能出现的异常信息</p>
</li>
</ul>
</li>
</ul>
<h3 id="3-8-通知顺序（了解）"><a href="#3-8-通知顺序（了解）" class="headerlink" title="3.8)通知顺序（了解）"></a><strong>3.8)通知顺序（了解）</strong></h3><p>当同一个切入点配置了多个通知时，通知会存在运行的先后顺序，该顺序以通知配置的顺序为准</p>
<h3 id="3-9-通知获取数据"><a href="#3-9-通知获取数据" class="headerlink" title="3.9)通知获取数据"></a><strong>3.9)通知获取数据</strong></h3><ul>
<li><p>参数</p>
</li>
<li><p>返回值</p>
</li>
<li><p>异常</p>
</li>
</ul>
<h4 id="3-9-1-通知获取参数数据"><a href="#3-9-1-通知获取参数数据" class="headerlink" title="3.9.1)通知获取参数数据"></a><strong>3.9.1)通知获取参数数据</strong></h4><p>第一种情况：</p>
<ul>
<li><p>设定通知方法第一个参数为JoinPoint，通过该对象调用getArgs()方法，获取原始方法运行的参数数组</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(JoinPoint jp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    Object[] args = jp.getArgs();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>所有的通知均可以获取参数</p>
</li>
</ul>
<p>第二种情况：</p>
<ul>
<li><p>设定切入点表达式为通知方法传递参数（锁定通知变量名）</p>
</li>
<li><p>原始方法</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201019.png" alt="1591284387913"></p>
<p>第三种情况</p>
<ul>
<li><p>设定切入点表达式为通知方法传递参数（改变通知变量名的定义顺序）</p>
</li>
<li><p>原始方法</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201020.png" alt="1591284429541"></p>
<h4 id="3-9-2-通知获取返回值数据"><a href="#3-9-2-通知获取返回值数据" class="headerlink" title="3.9.2)通知获取返回值数据"></a><strong>3.9.2)通知获取返回值数据</strong></h4><p>第一种：返回值变量名</p>
<ul>
<li><p>设定返回值变量名</p>
</li>
<li><p>原始方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;user service running...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p> AOP配置</p>
</li>
</ul>
  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt3&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *(..))  &quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">&quot;afterReturning&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt3&quot;</span> <span class="attr">returning</span>=<span class="string">&quot;ret&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>通知类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object ret)</span> </span>&#123;</span><br><span class="line">    System.out.println(ret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>适用于返回后通知（after-returning）</p>
</li>
</ul>
<p>第二种：</p>
<ul>
<li><p>在通知类的方法中调用原始方法获取返回值</p>
</li>
<li><p>原始方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user service running...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>AOP配置l</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt2&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *(..))  &quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;around&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt2&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>通知类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    Object ret = pjp.proceed();</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>适用于环绕通知（around）</p>
</li>
</ul>
<h4 id="3-9-3-通知获取异常数据"><a href="#3-9-3-通知获取异常数据" class="headerlink" title="3.9.3)通知获取异常数据"></a><strong>3.9.3)通知获取异常数据</strong></h4><p>第一种：通知类的方法中调用原始方法捕获异常</p>
<ul>
<li><p>在通知类的方法中调用原始方法捕获异常</p>
</li>
<li><p>原始方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user service running...&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p> AOP配置</p>
</li>
</ul>
  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt4&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *(..))  &quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;around&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt4&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>通知类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    Object ret = pjp.proceed();	<span class="comment">//对此处调用进行try……catch……捕获异常，或抛出异常</span></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>适用于环绕通知（around）</p>
</li>
</ul>
<p>第二种：</p>
<ul>
<li><p>设定异常对象变量名</p>
</li>
<li><p>原始方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user service running...&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p> AOP配置</p>
</li>
</ul>
  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt4&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *(..))  &quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">&quot;afterThrowing&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt4&quot;</span> <span class="attr">throwing</span>=<span class="string">&quot;t&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>通知类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Throwable t)</span></span>&#123;</span><br><span class="line">    System.out.println(t.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>适用于返回后通知（after-throwing）</p>
</li>
</ul>
<h2 id="4-AOP配置（注解）"><a href="#4-AOP配置（注解）" class="headerlink" title="4)AOP配置（注解）"></a>4)AOP配置（注解）</h2><h3 id="4-1-AOP配置"><a href="#4-1-AOP配置" class="headerlink" title="4.1)AOP配置"></a>4.1)AOP配置</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201021.png" alt="1591285050618"></p>
<h3 id="4-2-注解开发AOP制作步骤"><a href="#4-2-注解开发AOP制作步骤" class="headerlink" title="4.2)注解开发AOP制作步骤"></a>4.2)注解开发AOP制作步骤</h3><p>在XML格式基础上</p>
<ul>
<li><p>导入坐标（伴随spring-context坐标导入已经依赖导入完成）</p>
</li>
<li><p>开启AOP注解支持</p>
</li>
<li><p>配置切面@Aspect</p>
</li>
<li><p>定义专用的切入点方法，并配置切入点@Pointcut</p>
</li>
<li><p>为通知方法配置通知类型及对应切入点@Before</p>
</li>
</ul>
<h3 id="4-3-注解开发AOP注意事项"><a href="#4-3-注解开发AOP注意事项" class="headerlink" title="4.3)注解开发AOP注意事项"></a>4.3)注解开发AOP注意事项</h3><p>1.切入点最终体现为一个方法，无参无返回值，无实际方法体内容，但不能是抽象方法</p>
<p>2.引用切入点时必须使用方法调用名称，方法后面的（）不能省略</p>
<p>3.切面类中定义的切入点只能在当前类中使用，如果想引用其他类中定义的切入点使用“类名.方法名()”引用</p>
<p>4.可以在通知类型注解后添加参数，实现XML配置中的属性，例如after-returning后的returning属性</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201022.png" alt="1591285152119"></p>
<h3 id="4-4-AOP注解详解"><a href="#4-4-AOP注解详解" class="headerlink" title="4.4)AOP注解详解"></a>4.4)AOP注解详解</h3><h4 id="4-4-1-Aspect"><a href="#4-4-1-Aspect" class="headerlink" title="4.4.1)@Aspect"></a>4.4.1)@Aspect</h4><ul>
<li><p>名称：@Aspect</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：类定义上方</p>
</li>
<li><p>作用：设置当前类为切面类</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AopAdvice</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：一个beans标签中可以配置多个aop:config标签</p>
</li>
</ul>
<h4 id="4-4-2-Pointcut"><a href="#4-4-2-Pointcut" class="headerlink" title="4.4.2)@Pointcut"></a>4.4.2)@Pointcut</h4><ul>
<li><p>名称：@Pointcut</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：使用当前方法名作为切入点引用名称</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(* *(..))&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>说明：被修饰的方法忽略其业务功能，格式设定为无参无返回值的方法，方法体内空实现（非抽象）</p>
</li>
</ul>
<h4 id="4-4-3-Before"><a href="#4-4-3-Before" class="headerlink" title="4.4.3)@Before"></a>4.4.3)@Before</h4><ul>
<li><p>名称：@Before</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：标注当前方法作为前置通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>特殊参数：</p>
<ul>
<li>无</li>
</ul>
</li>
</ul>
<h4 id="4-4-4-After"><a href="#4-4-4-After" class="headerlink" title="4.4.4)@After"></a>4.4.4)@After</h4><ul>
<li><p>名称：@After</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：标注当前方法作为后置通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@After(&quot;pt()&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>特殊参数：</p>
<ul>
<li>无</li>
</ul>
</li>
</ul>
<h4 id="4-4-5-AfterReturning"><a href="#4-4-5-AfterReturning" class="headerlink" title="4.4.5)@AfterReturning"></a>4.4.5)@AfterReturning</h4><ul>
<li><p>名称：@AfterReturning</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：标注当前方法作为返回后通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@AfterReturning(value=&quot;pt()&quot;,returning = &quot;ret&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object ret)</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>特殊参数：</p>
<ul>
<li>returning ：设定使用通知方法参数接收返回值的变量名</li>
</ul>
</li>
</ul>
<h4 id="4-4-6-AfterThrowing"><a href="#4-4-6-AfterThrowing" class="headerlink" title="4.4.6)@AfterThrowing"></a>4.4.6)@AfterThrowing</h4><ul>
<li><p>名称：@AfterThrowing</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：标注当前方法作为异常后通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@AfterThrowing(value=&quot;pt()&quot;,throwing = &quot;t&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Throwable t)</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>特殊参数：</p>
<ul>
<li>throwing ：设定使用通知方法参数接收原始方法中抛出的异常对象名</li>
</ul>
</li>
</ul>
<h4 id="4-4-7-Around"><a href="#4-4-7-Around" class="headerlink" title="4.4.7)@Around"></a>4.4.7)@Around</h4><ul>
<li><p>名称：@Around</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：方法定义上方</p>
</li>
<li><p>作用：标注当前方法作为环绕通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Around(&quot;pt()&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    Object ret = pjp.proceed();</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>特殊参数：</p>
<ul>
<li>无</li>
</ul>
</li>
</ul>
<h3 id="4-5-AOP注解开发通知执行顺序控制（了解）"><a href="#4-5-AOP注解开发通知执行顺序控制（了解）" class="headerlink" title="4.5)AOP注解开发通知执行顺序控制（了解）"></a>4.5)AOP注解开发通知执行顺序控制（了解）</h3><p>1.AOP使用XML配置情况下，通知的执行顺序由配置顺序决定，在注解情况下由于不存在配置顺序的概念的概念，参照通知所配置的方法名字符串对应的编码值顺序，可以简单理解为字母排序</p>
<ul>
<li><p>同一个通知类中，相同通知类型以方法名排序为准</p>
</li>
<li><p>不同通知类中，以类名排序为准</p>
</li>
<li><p>使用@Order注解通过变更bean的加载顺序改变通知的加载顺序</p>
</li>
</ul>
<p>2.企业开发经验</p>
<ul>
<li><p>通知方法名由3部分组成，分别是前缀、顺序编码、功能描述</p>
</li>
<li><p>前缀为固定字符串，例如baidu、itheima等，无实际意义</p>
</li>
<li><p>顺序编码为6位以内的整数，通常3位即可，不足位补0</p>
</li>
<li><p>功能描述为该方法对应的实际通知功能，例如exception、strLenCheck</p>
<ul>
<li><p>制通知执行顺序使用顺序编码控制，使用时做一定空间预留</p>
</li>
<li><p>003使用，006使用，预留001、002、004、005、007、008</p>
</li>
<li><p>使用时从中段开始使用，方便后期做前置追加或后置追加</p>
</li>
<li><p>最终顺序以运行顺序为准，以测试结果为准，不以设定规则为准</p>
</li>
</ul>
</li>
</ul>
<h3 id="4-6-AOP注解驱动"><a href="#4-6-AOP注解驱动" class="headerlink" title="4.6)AOP注解驱动"></a>4.6)AOP注解驱动</h3><ul>
<li><p>名称：@EnableAspectJAutoProxy</p>
</li>
<li><p>类型：<strong>注解</strong></p>
</li>
<li><p>位置：Spring注解配置类定义上方</p>
</li>
<li><p>作用：设置当前类开启AOP注解驱动的支持，加载AOP注解</p>
</li>
<li><p>格式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="5-综合案例-1"><a href="#5-综合案例-1" class="headerlink" title="5)综合案例"></a>5)综合案例</h2><h3 id="5-1-案例介绍-1"><a href="#5-1-案例介绍-1" class="headerlink" title="5.1)案例介绍"></a><strong>5.1)案例介绍</strong></h3><p>对项目进行业务层接口执行监控，测量业务层接口的执行效率</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(Account account)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(Account account)</span></span>;</span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Account <span class="title">findById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-案例分析-1"><a href="#5-2-案例分析-1" class="headerlink" title="5.2)案例分析"></a><strong>5.2)案例分析</strong></h3><ul>
<li><p>测量接口执行效率：接口方法执行前后获取执行时间，求出执行时长</p>
<ul>
<li>System.currentTimeMillis( )</li>
</ul>
</li>
<li><p>对项目进行监控：项目中所有接口方法，AOP思想，执行期动态织入代码</p>
<ul>
<li><p>环绕通知</p>
</li>
<li><p>proceed()方法执行前后获取系统时间</p>
</li>
</ul>
</li>
</ul>
<h3 id="5-3-案例制作步骤"><a href="#5-3-案例制作步骤" class="headerlink" title="5.3)案例制作步骤"></a><strong>5.3)案例制作步骤</strong></h3><ul>
<li><p>定义切入点（务必要绑定到接口上，而不是接口实现类上）</p>
</li>
<li><p>制作AOP环绕通知，完成测量功能</p>
</li>
<li><p>注解配置AOP</p>
</li>
<li><p>开启注解驱动支持</p>
</li>
</ul>
<h3 id="5-4-案例制作核心代码"><a href="#5-4-案例制作核心代码" class="headerlink" title="5.4)案例制作核心代码"></a><strong>5.4)案例制作核心代码</strong></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunTimeMonitorAdvice</span> </span>&#123;</span><br><span class="line">    <span class="comment">//拦截所有的业务层接口中查询操作的执行</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.itheima.service.*Service.find*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pt</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Around(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">runtimeMonitor</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">//获取执行签名信息</span></span><br><span class="line">        Signature signature = pjp.getSignature();</span><br><span class="line">        <span class="comment">//通过签名获取执行类型（接口名）</span></span><br><span class="line">        String targetClass = signature.getDeclaringTypeName();</span><br><span class="line">        <span class="comment">//通过签名获取执行操作名称（方法名）</span></span><br><span class="line">        String targetMethod = signature.getName();</span><br><span class="line">        <span class="comment">//获取操作前系统时间beginTime</span></span><br><span class="line">        <span class="keyword">long</span> beginTime = System.currentTimeMillis();</span><br><span class="line">        Object ret = pjp.proceed(pjp.getArgs());</span><br><span class="line">        <span class="comment">//获取操作后系统时间endTime</span></span><br><span class="line">        <span class="keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(targetClass+<span class="string">&quot; 中 &quot;</span>+targetMethod+<span class="string">&quot; 运行时长 &quot;</span>+(endTime-beginTime)+<span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-5-案例后续思考与设计"><a href="#5-5-案例后续思考与设计" class="headerlink" title="5.5)案例后续思考与设计"></a><strong>5.5)案例后续思考与设计</strong></h3><ul>
<li><p>测量真实性</p>
<ul>
<li><p>开发测量是隔离性反复执行某个操作，是理想情况，上线测量差异过大</p>
</li>
<li><p>上线测量服务器性能略低于单机开发测量</p>
</li>
<li><p>上线测量基于缓存的性能查询要优于数据库查询测量</p>
</li>
<li><p>上线测量接口的性能与最终对外提供的服务性能差异过大</p>
</li>
<li><p>当外部条件发生变化（硬件），需要进行回归测试，例如数据库迁移</p>
</li>
</ul>
</li>
<li><p>测量结果展示</p>
<ul>
<li><p>测量结果无需每一个都展示，需要设定检测阈值</p>
</li>
<li><p>阈值设定要根据业务进行区分，一个复杂的查询与简单的查询差异化很大</p>
</li>
<li><p>阈值设定需要做独立的配置文件或通过图形工具配置（工具级别的开发）</p>
</li>
<li><p>配合图形界面展示测量结果</p>
</li>
</ul>
</li>
</ul>
<h2 id="6-AOP底层原理"><a href="#6-AOP底层原理" class="headerlink" title="6)AOP底层原理"></a>6)AOP底层原理</h2><ul>
<li><p>静态代理</p>
</li>
<li><p>动态代理——Proxy</p>
</li>
<li><p>动态代理——CGLIB</p>
</li>
<li><p>织入形式</p>
</li>
</ul>
<h3 id="6-1-静态代理"><a href="#6-1-静态代理" class="headerlink" title="6.1)静态代理"></a><strong>6.1)静态代理</strong></h3><p>装饰者模式（Decorator Pattern）：在不惊动原始设计的基础上，为其添加功能</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201023.png" alt="1591287238806"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceDecorator</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserServiceDecorator</span><span class="params">(UserService userService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userService = userService;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//原始调用</span></span><br><span class="line">        userService.save();</span><br><span class="line">        <span class="comment">//增强功能（后置）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;刮大白&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-动态代理——JDK-Proxy"><a href="#6-2-动态代理——JDK-Proxy" class="headerlink" title="6.2)动态代理——JDK Proxy"></a>6.2)动态代理——JDK Proxy</h3><p>JDKProxy动态代理是针对对象做代理，要求原始对象具有接口实现，并对接口方法进行增强</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceJDKProxy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserService <span class="title">createUserServiceJDKProxy</span><span class="params">(<span class="keyword">final</span> UserService userService)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取被代理对象的类加载器</span></span><br><span class="line">        ClassLoader classLoader = userService.getClass().getClassLoader();</span><br><span class="line">        <span class="comment">//获取被代理对象实现的接口</span></span><br><span class="line">        Class[] classes = userService.getClass().getInterfaces();</span><br><span class="line">        <span class="comment">//对原始方法执行进行拦截并增强</span></span><br><span class="line">        InvocationHandler ih = <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                <span class="comment">//前置增强内容</span></span><br><span class="line">                Object ret = method.invoke(userService, args);</span><br><span class="line">                <span class="comment">//后置增强内容</span></span><br><span class="line">                System.out.println(<span class="string">&quot;刮大白2&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> ret;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">//使用原始被代理对象创建新的代理对象</span></span><br><span class="line">        UserService proxy = (UserService) Proxy.newProxyInstance(classLoader,classes,ih);</span><br><span class="line">        <span class="keyword">return</span> proxy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-动态代理——CGLIB"><a href="#6-3-动态代理——CGLIB" class="headerlink" title="6.3)动态代理——CGLIB"></a>6.3)动态代理——CGLIB</h3><ul>
<li><p>CGLIB(Code Generation Library)，Code生成类库</p>
</li>
<li><p>CGLIB动态代理不限定是否具有接口，可以对任意操作进行增强</p>
</li>
<li><p>CGLIB动态代理无需要原始被代理对象，动态创建出新的代理对象</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201024.png" alt="1591287441096"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImplCglibProxy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserServiceImpl <span class="title">createUserServiceCglibProxy</span><span class="params">(Class clazz)</span></span>&#123;</span><br><span class="line">        <span class="comment">//创建Enhancer对象（可以理解为内存中动态创建了一个类的字节码）</span></span><br><span class="line">        Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">        <span class="comment">//设置Enhancer对象的父类是指定类型UserServerImpl</span></span><br><span class="line">        enhancer.setSuperclass(clazz);</span><br><span class="line">        Callback cb = <span class="keyword">new</span> MethodInterceptor() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object o, Method m, Object[] a, MethodProxy mp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                Object ret = mp.invokeSuper(o, a);</span><br><span class="line">                <span class="keyword">if</span>(m.getName().equals(<span class="string">&quot;save&quot;</span>)) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;刮大白&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> ret;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">//设置回调方法</span></span><br><span class="line">        enhancer.setCallback(cb);</span><br><span class="line">        <span class="comment">//使用Enhancer对象创建对应的对象</span></span><br><span class="line">        <span class="keyword">return</span> (UserServiceImpl)enhancer.create();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-4-代理模式的选择"><a href="#6-4-代理模式的选择" class="headerlink" title="6.4)代理模式的选择"></a><strong>6.4)代理模式的选择</strong></h3><p>Spirng可以通过配置的形式控制使用的代理形式，默认使用jdkproxy，通过配置可以修改为使用cglib</p>
<ul>
<li><p>XML配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--XMP配置AOP--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>XML注解支持</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--注解配置AOP--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>注解驱动</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注解驱动</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="6-5-织入时机"><a href="#6-5-织入时机" class="headerlink" title="6.5)织入时机"></a><strong>6.5)织入时机</strong></h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201025.png" alt="1591287839941"></p>
<h1 id="spring-事务"><a href="#spring-事务" class="headerlink" title="spring 事务"></a>spring 事务</h1><h2 id="1-事务回顾"><a href="#1-事务回顾" class="headerlink" title="1)事务回顾"></a>1)事务回顾</h2><h3 id="1-1-什么是事务？"><a href="#1-1-什么是事务？" class="headerlink" title="1.1)什么是事务？"></a>1.1)什么是事务？</h3><p>事务指数据库中多个操作合并在一起形成的操作序列</p>
<h3 id="1-2-事务的作用"><a href="#1-2-事务的作用" class="headerlink" title="1.2)事务的作用"></a>1.2)事务的作用</h3><p>1.当数据库操作序列中个别操作失败时，提供一种方式使数据库状态恢复到正常状态（<strong>A</strong>），保障数据库即使在异常状态下仍能保持数据一致性（<strong>C</strong>）（要么操作前状态，要么操作后状态）。</p>
<p>2.当出现并发访问数据库时，在多个访问间进行相互隔离，防止并发访问操作结果互相干扰（<strong>I</strong>）。</p>
<ul>
<li><p>事务特征（ACID）</p>
<ul>
<li><p>原子性（Atomicity）指事务是一个不可分割的整体，其中的操作要么全执行或全不执行</p>
</li>
<li><p>一致性（Consistency）事务前后数据的完整性必须保持一致</p>
</li>
<li><p>隔离性（Isolation）事务的隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离</p>
</li>
<li><p>持久性（Durability）持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响</p>
</li>
</ul>
</li>
</ul>
<h3 id="1-3-事务的隔离级"><a href="#1-3-事务的隔离级" class="headerlink" title="1.3)事务的隔离级"></a>1.3)事务的隔离级</h3><ul>
<li><p>脏读：允许读取未提交的信息</p>
<ul>
<li>原因：Read uncommitted</li>
</ul>
<p>解决方案： （表级读锁）</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201057.png" alt="1591321851725"></p>
<ul>
<li>不可重复读：读取过程中单个数据发生了变化<ul>
<li>解决方案： Repeatable read （行级写锁）</li>
</ul>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201058.png" alt="1591321927034"></p>
<ul>
<li>幻读：读取过程中数据条目发生了变化<ul>
<li>解决方案： Serializable（表级写锁）</li>
</ul>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201059.png" alt="1591321959641"></p>
<h2 id="2-事务管理"><a href="#2-事务管理" class="headerlink" title="2)事务管理"></a>2)事务管理</h2><h3 id="2-1-Spring事务核心对象"><a href="#2-1-Spring事务核心对象" class="headerlink" title="2.1)Spring事务核心对象"></a>2.1)<strong>Spring</strong>事务核心对象</h3><ul>
<li><p>J2EE开发使用分层设计的思想进行，对于简单的业务层转调数据层的单一操作，事务开启在业务层或者数据层并无太大差别，当业务中包含多个数据层的调用时，需要在业务层开启事务，对数据层中多个操作进行组合并归属于同一个事务进行处理</p>
</li>
<li><p>Spring为业务层提供了整套的事务解决方案</p>
<ul>
<li><p>PlatformTransactionManager</p>
</li>
<li><p>TransactionDefinition</p>
</li>
<li><p>TransactionStatus</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-2-PlatformTransactionManager"><a href="#2-2-PlatformTransactionManager" class="headerlink" title="2.2)PlatformTransactionManager"></a><strong>2.2)PlatformTransactionManager</strong></h3><ul>
<li><p>平台事务管理器实现类</p>
<ul>
<li><p>DataSourceTransactionManager  适用于Spring JDBC或MyBatis</p>
</li>
<li><p>HibernateTransactionManager  适用于Hibernate3.0及以上版本</p>
</li>
<li><p>JpaTransactionManager  适用于JPA</p>
</li>
<li><p>JdoTransactionManager  适用于JDO</p>
</li>
<li><p>JtaTransactionManager  适用于JTA</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>JPA（Java Persistence API）Java EE 标准之一，为POJO提供持久化标准规范，并规范了持久化开发的统一API，符合JPA规范的开发可以在不同的JPA框架下运行</p>
</li>
<li><p>JDO(Java Data Object )是Java对象持久化规范，用于存取某种数据库中的对象，并提供标准化API。与JDBC相比，JDBC仅针对关系数据库进行操作，JDO可以扩展到关系数据库、文件、XML、对象数据库（ODBMS）等，可移植性更强</p>
</li>
<li><p>JTA（Java Transaction API）Java EE 标准之一，允许应用程序执行分布式事务处理。与JDBC相比，JDBC事务则被限定在一个单一的数据库连接，而一个JTA事务可以有多个参与者，比如JDBC连接、JDO 都可以参与到一个JTA事务中</p>
</li>
</ul>
<p>此接口定义了事务的基本操作</p>
<ul>
<li><p>获取事务 ：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">TransactionStatus <span class="title">getTransaction</span><span class="params">(TransactionDefinition definition)</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>提交事务 ：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">commit</span><span class="params">(TransactionStatus status)</span> </span></span><br></pre></td></tr></table></figure></li>
<li><p>回滚事务 ：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rollback</span><span class="params">(TransactionStatus status)</span></span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-3-TransactionDefinition"><a href="#2-3-TransactionDefinition" class="headerlink" title="2.3)TransactionDefinition"></a><strong>2.3)TransactionDefinition</strong></h3><p>此接口定义了事务的基本信息</p>
<ul>
<li><p>获取事务定义名称</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">String <span class="title">getName</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>获取事务的读写属性</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isReadOnly</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>获取事务隔离级别</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getIsolationLevel</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>获事务超时时间</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getTimeout</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>获取事务传播行为特征</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getPropagationBehavior</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-4-TransactionStatus"><a href="#2-4-TransactionStatus" class="headerlink" title="2.4)TransactionStatus"></a><strong>2.4)TransactionStatus</strong></h3><p>此接口定义了事务在执行过程中某个时间点上的状态信息及对应的状态操作</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201100.png" alt="1591322466820"></p>
<h3 id="2-5-事务控制方式"><a href="#2-5-事务控制方式" class="headerlink" title="2.5)事务控制方式"></a><strong>2.5)事务控制方式</strong></h3><ul>
<li><p>编程式</p>
</li>
<li><p>声明式（XML）</p>
</li>
<li><p>声明式（注解）</p>
</li>
</ul>
<h3 id="2-6-案例说明"><a href="#2-6-案例说明" class="headerlink" title="2.6)案例说明"></a><strong>2.6)案例说明</strong></h3><h4 id="2-6-1-案例说明"><a href="#2-6-1-案例说明" class="headerlink" title="2.6.1)案例说明"></a>2.6.1)案例说明</h4><p>银行转账业务说明</p>
<p>银行转账操作中，涉及从A账户到B账户的资金转移操作。数据层仅提供单条数据的基础操作，未设计多账户间的业务操作。</p>
<h4 id="2-6-2-案例环境（基于Spring、Mybatis整合）"><a href="#2-6-2-案例环境（基于Spring、Mybatis整合）" class="headerlink" title="2.6.2)案例环境（基于Spring、Mybatis整合）"></a>2.6.2)案例环境（基于Spring、Mybatis整合）</h4><ul>
<li>业务层接口提供转账操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 转账操作</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> outName     出账用户名</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> inName      入账用户名</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> money       转账金额</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outName,String inName,Double money)</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>业务层实现提供转账操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outName,String inName,Double money)</span></span>&#123;</span><br><span class="line">    accountDao.inMoney(outName,money);                                                       accountDao.outMoney(inName,money);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>数据层提供对应的入账与出账操作</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;inMoney&quot;</span>&gt;</span></span><br><span class="line">	update account set money = money + #&#123;money&#125; where name = #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;outMoney&quot;</span>&gt;</span></span><br><span class="line">	update account set money = money - #&#123;money&#125; where name = #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-6-3-编程式事务"><a href="#2-6-3-编程式事务" class="headerlink" title="2.6.3)编程式事务"></a><strong>2.6.3)编程式事务</strong></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outName,String inName,Double money)</span></span>&#123;</span><br><span class="line">    <span class="comment">//创建事务管理器</span></span><br><span class="line">    DataSourceTransactionManager dstm = <span class="keyword">new</span> DataSourceTransactionManager();</span><br><span class="line">    <span class="comment">//为事务管理器设置与数据层相同的数据源</span></span><br><span class="line">    dstm.setDataSource(dataSource);</span><br><span class="line">    <span class="comment">//创建事务定义对象</span></span><br><span class="line">    TransactionDefinition td = <span class="keyword">new</span> DefaultTransactionDefinition();</span><br><span class="line">    <span class="comment">//创建事务状态对象，用于控制事务执行</span></span><br><span class="line">    TransactionStatus ts = dstm.getTransaction(td);</span><br><span class="line">    accountDao.inMoney(outName,money);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;    <span class="comment">//模拟业务层事务过程中出现错误</span></span><br><span class="line">    accountDao.outMoney(inName,money);</span><br><span class="line">    <span class="comment">//提交事务</span></span><br><span class="line">    dstm.commit(ts);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-7-使用AOP控制事务"><a href="#2-7-使用AOP控制事务" class="headerlink" title="2.7)使用AOP控制事务"></a>2.7)使用AOP控制事务</h3><p>将业务层的事务处理功能抽取出来制作成AOP通知，利用环绕通知运行期动态织入</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">tx</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    </span><br><span class="line">    DataSourceTransactionManager dstm = <span class="keyword">new</span> DataSourceTransactionManager();</span><br><span class="line">    dstm.setDataSource(dataSource);</span><br><span class="line">    TransactionDefinition td = <span class="keyword">new</span> DefaultTransactionDefinition();</span><br><span class="line">    TransactionStatus ts = dstm.getTransaction(td);</span><br><span class="line">    Object ret = pjp.proceed(pjp.getArgs());</span><br><span class="line">    dstm.commit(ts);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置AOP通知类，并注入dataSource</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.aop.TxAdvice&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用环绕通知将通知类织入到原始业务对象执行过程中</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *..transfer(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;txAdvice&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;tx&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-8声明式事务（XML）"><a href="#2-8声明式事务（XML）" class="headerlink" title="2.8声明式事务（XML）"></a><strong>2.8声明式事务（XML）</strong></h3><p><strong>AOP</strong>配置事务是否具有特例性？</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">tx</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    DataSourceTransactionManager dstm = <span class="keyword">new</span> DataSourceTransactionManager();</span><br><span class="line">    dstm.setDataSource(dataSource);</span><br><span class="line">    TransactionDefinition td = <span class="keyword">new</span> DefaultTransactionDefinition();</span><br><span class="line">    TransactionStatus ts = dstm.getTransaction(td);</span><br><span class="line">    Object ret = pjp.proceed(pjp.getArgs());</span><br><span class="line">    dstm.commit(ts);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.aop.TxAdvice&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用tx命名空间配置事务专属通知类</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;txManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;find*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用aop:advisor在AOP配置中引用事务专属通知类</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pt&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *..*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pt&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-8-1-aop-advice与aop-advisor区别"><a href="#2-8-1-aop-advice与aop-advisor区别" class="headerlink" title="2.8.1)aop:advice与aop:advisor区别"></a>2.8.1)<strong>aop:advice与aop:advisor区别</strong></h4><ul>
<li><p>aop:advice配置的通知类可以是普通java对象，不实现接口，也不使用继承关系</p>
</li>
<li><p>aop:advisor配置的通知类必须实现通知接口</p>
<ul>
<li><p>MethodBeforeAdvice</p>
</li>
<li><p>AfterReturningAdvice</p>
</li>
<li><p>ThrowsAdvice</p>
</li>
<li><p>……</p>
</li>
</ul>
</li>
</ul>
<h4 id="2-8-2-tx配置—-tx-advice"><a href="#2-8-2-tx配置—-tx-advice" class="headerlink" title="2.8.2)tx配置—-tx:advice"></a>2.8.2)tx配置—-tx:advice</h4><ul>
<li><p>名称：tx:advice</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：beans标签</p>
</li>
<li><p>作用：专用于声明事务通知</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;txManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>基本属性：</p>
<ul>
<li><p>id ：用于配置aop时指定通知器的id</p>
</li>
<li><p>transaction-manager ：指定事务管理器bean</p>
</li>
</ul>
</li>
</ul>
<h4 id="2-8-3-tx配置—-tx-attributes"><a href="#2-8-3-tx配置—-tx-attributes" class="headerlink" title="2.8.3)tx配置—-tx:attributes"></a>2.8.3)tx配置—-tx:attributes</h4><ul>
<li><p>名称：tx:attributes</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：tx:advice标签</p>
</li>
<li><p>作用：定义通知属性</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;txManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>基本属性：</p>
<ul>
<li>无</li>
</ul>
</li>
</ul>
<h4 id="2-8-4-tx配置—-tx-method"><a href="#2-8-4-tx配置—-tx-method" class="headerlink" title="2.8.4)tx配置—-tx:method"></a>2.8.4)tx配置—-tx:method</h4><ul>
<li><p>名称：tx:method</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：tx:attribute标签</p>
</li>
<li><p>作用：设置具体的事务属性</p>
</li>
<li><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>说明：</p>
<p>通常事务属性会配置多个，包含1个读写的全事务属性，1个只读的查询类事务属性</p>
</li>
</ul>
<p><strong>tx:method属性</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201101.png" alt="1591367291135"></p>
<h3 id="2-9-事务传播行为"><a href="#2-9-事务传播行为" class="headerlink" title="2.9)事务传播行为"></a><strong>2.9)事务传播行为</strong></h3><ul>
<li><p>事务管理员</p>
</li>
<li><p>事务协调员</p>
</li>
</ul>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201102.png" alt="1591367347482"></p>
<ul>
<li>事务传播行为描述的是事务协调员对事务管理员所携带事务的处理态度</li>
</ul>
<h3 id="2-10-事务传播行为"><a href="#2-10-事务传播行为" class="headerlink" title="2.10)事务传播行为"></a><strong>2.10)事务传播行为</strong></h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201103.png" alt="1591367375088"></p>
<h3 id="2-11-事务传播应用"><a href="#2-11-事务传播应用" class="headerlink" title="2.11)事务传播应用"></a><strong>2.11)事务传播应用</strong></h3><ul>
<li><p>场景A：生成订单业务</p>
<ul>
<li><p>子业务S1：记录日志到数据库表X</p>
</li>
<li><p>子业务S2：保存订单数据到数据库表Y</p>
</li>
<li><p>子业务S3：……</p>
</li>
<li><p>如果S2或S3或……事务提交失败，此时S1是否回滚？如何控制？</p>
</li>
<li><p>（S1需要新事务）</p>
</li>
</ul>
</li>
<li><p>场景B：生成订单业务</p>
<ul>
<li><p>背景1：订单号生成依赖数据库中一个专门用于控制订单号编号生成的表M获取</p>
</li>
<li><p>背景2：每次获取完订单号，表M中记录的编号自增1</p>
</li>
<li><p>子业务S1：从表M中获取订单编号</p>
</li>
<li><p>子业务S2：保存订单数据，订单编号来自于表M</p>
</li>
<li><p>子业务S3：……</p>
</li>
<li><p>如果S2或S3或……事务提交失败，此时S1是否回滚？如何控制？</p>
</li>
<li><p>（S1需要新事务）</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-12-声明式事务（注解）"><a href="#2-12-声明式事务（注解）" class="headerlink" title="2.12)声明式事务（注解）"></a><strong>2.12)声明式事务（注解）</strong></h3><h4 id="2-12-1-Transactional"><a href="#2-12-1-Transactional" class="headerlink" title="2.12.1)@Transactional"></a>2.12.1)@Transactional</h4><ul>
<li><p>名称：@Transactional</p>
</li>
<li><p>类型：<strong>方法注解，类注解，接口注解</strong></p>
</li>
<li><p>位置：方法定义上方，类定义上方，接口定义上方</p>
</li>
<li><p>作用：设置当前类/接口中所有方法或具体方法开启事务，并指定相关事务属性</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Transactional(</span></span><br><span class="line"><span class="meta">    readOnly = false,</span></span><br><span class="line"><span class="meta">    timeout = -1,</span></span><br><span class="line"><span class="meta">    isolation = Isolation.DEFAULT,</span></span><br><span class="line"><span class="meta">    rollbackFor = &#123;ArithmeticException.class, IOException.class&#125;,</span></span><br><span class="line"><span class="meta">    noRollbackFor = &#123;&#125;,</span></span><br><span class="line"><span class="meta">    propagation = Propagation.REQUIRES_NEW</span></span><br><span class="line"><span class="meta">)</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="2-12-2-tx-annotation-driven"><a href="#2-12-2-tx-annotation-driven" class="headerlink" title="2.12.2)tx:annotation-driven"></a>2.12.2)tx:annotation-driven</h4><ul>
<li><p>名称：tx:annotation-driven</p>
</li>
<li><p>类型：<strong>标签</strong></p>
</li>
<li><p>归属：beans标签</p>
</li>
<li><p>作用：开启事务注解驱动，并指定对应的事务管理器</p>
</li>
<li><p>范例：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;txManager&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-13-声明式事务（纯注解驱动）"><a href="#2-13-声明式事务（纯注解驱动）" class="headerlink" title="2.13)声明式事务（纯注解驱动）"></a><strong>2.13)声明式事务（纯注解驱动）</strong></h3><ul>
<li><p>名称：@EnableTransactionManagement</p>
</li>
<li><p>类型：<strong>类注解</strong></p>
</li>
<li><p>位置：Spring注解配置类上方</p>
</li>
<li><p>作用：开启注解驱动，等同XML格式中的注解驱动</p>
</li>
<li><p>范例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JDBCConfig.class,MyBatisConfig.class,TransactionManagerConfig.class&#125;)</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransactionManagerConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">getTransactionManager</span><span class="params">(<span class="meta">@Autowired</span> DataSource dataSource)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-模板对象"><a href="#3-模板对象" class="headerlink" title="3)模板对象"></a>3)模板对象</h2><h3 id="3-1-Spring模块对象"><a href="#3-1-Spring模块对象" class="headerlink" title="3.1)Spring模块对象"></a>3.1)Spring模块对象</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201104.png" alt="1591368087398"></p>
<ul>
<li><p>TransactionTemplate</p>
</li>
<li><p>JdbcTemplate</p>
</li>
<li><p>RedisTemplate</p>
</li>
<li><p>RabbitTemplate</p>
</li>
<li><p>JmsTemplate</p>
</li>
<li><p>HibernateTemplate</p>
</li>
<li><p>RestTemplate</p>
</li>
</ul>
<h3 id="3-2-JdbcTemplate（了解）"><a href="#3-2-JdbcTemplate（了解）" class="headerlink" title="3.2)JdbcTemplate（了解）"></a>3.2)JdbcTemplate（了解）</h3><p>提供标准的sql语句操作API</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;insert into account(name,money)values(?,?)&quot;</span>;</span><br><span class="line">    jdbcTemplate.update(sql,account.getName(),account.getMoney());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-NamedParameterJdbcTemplate-了解）"><a href="#3-3-NamedParameterJdbcTemplate-了解）" class="headerlink" title="3.3)NamedParameterJdbcTemplate(了解）"></a>3.3)NamedParameterJdbcTemplate(了解）</h3><p>提供标准的具名sql语句操作API</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;insert into account(name,money)values(:name,:money)&quot;</span>;</span><br><span class="line">    Map pm = <span class="keyword">new</span> HashMap();</span><br><span class="line">    pm.put(<span class="string">&quot;name&quot;</span>,account.getName());</span><br><span class="line">    pm.put(<span class="string">&quot;money&quot;</span>,account.getMoney());</span><br><span class="line">    jdbcTemplate.update(sql,pm);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-RedisTemplate"><a href="#3-4-RedisTemplate" class="headerlink" title="3.4)RedisTemplate"></a><strong>3.4)RedisTemplate</strong></h3><p>RedisTemplate对象结构</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201105.png" alt="1591368270508"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changeMoney</span><span class="params">(Integer id, Double money)</span> </span>&#123;</span><br><span class="line">    redisTemplate.opsForValue().set(<span class="string">&quot;account:id:&quot;</span>+id,money);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Double <span class="title">findMondyById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    Object money = redisTemplate.opsForValue().get(<span class="string">&quot;account:id:&quot;</span> + id);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Double(money.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-事务底层原理解析"><a href="#4-事务底层原理解析" class="headerlink" title="4)事务底层原理解析"></a>4)事务底层原理解析</h2><h3 id="4-1-策略模式应用"><a href="#4-1-策略模式应用" class="headerlink" title="4.1)策略模式应用"></a><strong>4.1)策略模式应用</strong></h3><p>策略模式（Strategy Pattern）使用不同策略的对象实现不同的行为方式，策略对象的变化导致行为的变化。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201106.png" alt="1591368340720"></p>
<p>策略模式（Strategy Pattern）使用不同策略的对象实现不同的行为方式，策略对象的变化导致行为的变化。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211208201107.png" alt="1591368370924"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小肥龙吃大冰淇淋</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://pengdanhua.github.io/post/6c92115f.html">https://pengdanhua.github.io/post/6c92115f.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://pengdanhua.github.io" target="_blank">小肥龙吃大冰淇淋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring/">Spring</a></div><div class="post_share"><div class="social-share" data-image="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082159.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/bae4ff13.html"><img class="prev-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082137.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Redis</div></div></a></div><div class="next-post pull-right"><a href="/post/6e12c924.html"><img class="next-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Springboot-day02</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/489ef953.html" title="Spring面试题"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-14</div><div class="title">Spring面试题</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-IoC"><span class="toc-number">1.</span> <span class="toc-text">Spring IoC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Spring%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1)Spring简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%A1%86%E6%9E%B6"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1)什么是框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2)框架的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-Spring%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3)Spring是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-Spring%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4)Spring的体系结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-Spring%E7%9A%84%E5%8F%91%E5%B1%95%E5%8E%86%E5%8F%B2"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.5)Spring的发展历史</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-Spring%E4%BC%98%E5%8A%BF"><span class="toc-number">1.1.6.</span> <span class="toc-text">1.6)Spring优势</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-IoC%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.</span> <span class="toc-text">2)IoC简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E4%BC%98%E8%B4%A8%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E7%9A%84%E5%88%B6%E4%BD%9C%E5%8E%9F%E5%88%99"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1)优质程序代码的制作原则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%80%A6%E5%90%88%E4%B8%8E%E5%86%85%E8%81%9A"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2)耦合与内聚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E5%8F%91%E5%B1%95%E5%8F%B2"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3)工厂模式发展史</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Spring%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4)Spring发展历程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-IoC"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5)IoC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">1.3.</span> <span class="toc-text">3)入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%A1%88%E4%BE%8B%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1)案例环境说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-IoC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2)IoC入门案例制作步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-IoC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4-1"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">3.2.1)IoC入门案例制作步骤-1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-IoC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4-2"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">3.2.2)IoC入门案例制作步骤-2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-IoC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4-3"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">3.2.3)IoC入门案例制作步骤-3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-IoC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4-4"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">3.2.4)IoC入门案例制作步骤-4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-5-IoC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4-5"><span class="toc-number">1.3.2.5.</span> <span class="toc-text">3.2.5)IoC入门案例制作步骤-5</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-IoC%E9%85%8D%E7%BD%AE%EF%BC%88XML%E6%A0%BC%E5%BC%8F%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">4)IoC配置（XML格式）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-bean"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1)bean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-bean%E5%B1%9E%E6%80%A7scope"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2)bean属性scope</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3)bean生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-bean%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4)bean对象创建方式（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-DI"><span class="toc-number">1.4.5.</span> <span class="toc-text">4.5)DI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-set%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%BB%E6%B5%81%EF%BC%89"><span class="toc-number">1.4.6.</span> <span class="toc-text">4.6)set注入（主流）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.4.7.</span> <span class="toc-text">4.7)构造器注入（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E6%B3%A8%E5%85%A5"><span class="toc-number">1.4.8.</span> <span class="toc-text">4.8)集合类型数据注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-%E4%BD%BF%E7%94%A8p%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E7%AE%80%E5%8C%96%E9%85%8D%E7%BD%AE%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.4.9.</span> <span class="toc-text">4.9)使用p命名空间简化配置（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-10-SpEL-%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.4.10.</span> <span class="toc-text">4.10)SpEL （了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11-properties%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.11.</span> <span class="toc-text">4.11)properties文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-12-%E5%9B%A2%E9%98%9F%E5%BC%80%E5%8F%91"><span class="toc-number">1.4.12.</span> <span class="toc-text">4.12)团队开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-13-ApplicationContext"><span class="toc-number">1.4.13.</span> <span class="toc-text">4.13)ApplicationContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-14-%E7%AC%AC%E4%B8%89%E6%96%B9%E8%B5%84%E6%BA%90%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.14.</span> <span class="toc-text">4.14)第三方资源配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-number">1.5.</span> <span class="toc-text">5)综合案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1)案例介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2)案例分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4%E2%80%94%E2%80%94%E5%9F%BA%E7%A1%80%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3)案例制作步骤——基础准备工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4%E2%80%94%E2%80%94%E6%95%B4%E5%90%88%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.5.4.</span> <span class="toc-text">5.4)案例制作步骤——整合准备工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4%E2%80%94%E2%80%94%E6%95%B4%E5%90%88%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.5.5.</span> <span class="toc-text">5.5)案例制作步骤——整合工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E8%8A%82"><span class="toc-number">1.5.6.</span> <span class="toc-text">小节</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">2.</span> <span class="toc-text">注解开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">2.1.</span> <span class="toc-text">1)注解驱动的意义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1)什么是注解驱动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%BC%8A%E7%AB%AF"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.2)注解驱动的弊端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.2.</span> <span class="toc-text">2)常用注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%90%AF%E5%8A%A8%E6%B3%A8%E8%A7%A3%E5%8A%9F%E8%83%BD"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.1)启动注解功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-bean%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2)bean的定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.3)bean的作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.2.4.</span> <span class="toc-text">2.4)bean的生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E5%8A%A0%E8%BD%BD%E7%AC%AC%E4%B8%89%E6%96%B9%E8%B5%84%E6%BA%90"><span class="toc-number">2.2.5.</span> <span class="toc-text">2.5)加载第三方资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-bean%E7%9A%84%E9%9D%9E%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5"><span class="toc-number">2.2.6.</span> <span class="toc-text">2.6)bean的非引用类型属性注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-bean%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5"><span class="toc-number">2.2.7.</span> <span class="toc-text">2.7)bean的引用类型属性注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-bean%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5"><span class="toc-number">2.2.8.</span> <span class="toc-text">2.8)bean的引用类型属性注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-9-bean%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5"><span class="toc-number">2.2.9.</span> <span class="toc-text">2.9)bean的引用类型属性注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-%E5%8A%A0%E8%BD%BDproperties%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.10.</span> <span class="toc-text">2.10)加载properties文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-11-%E7%BA%AF%E6%B3%A8%E8%A7%A3%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.2.11.</span> <span class="toc-text">2.11)纯注解格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-12-%E7%AC%AC%E4%B8%89%E6%96%B9bean%E9%85%8D%E7%BD%AE%E4%B8%8E%E7%AE%A1%E7%90%86"><span class="toc-number">2.2.12.</span> <span class="toc-text">2.12)第三方bean配置与管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-bean%E5%8A%A0%E8%BD%BD%E6%8E%A7%E5%88%B6"><span class="toc-number">2.3.</span> <span class="toc-text">3)bean加载控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E4%BE%9D%E8%B5%96%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.3.1.</span> <span class="toc-text">3.1)依赖加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E4%BE%9D%E8%B5%96%E5%8A%A0%E8%BD%BD%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.3.2.</span> <span class="toc-text">3.2)依赖加载应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%95%B4%E5%90%88%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8A%80%E6%9C%AF"><span class="toc-number">2.4.</span> <span class="toc-text">4)整合第三方技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B%E6%94%B9%E7%89%88%EF%BC%88%E6%B3%A8%E8%A7%A3%E6%95%B4%E5%90%88MyBatis%EF%BC%89"><span class="toc-number">2.4.1.</span> <span class="toc-text">4.1)综合案例改版（注解整合MyBatis）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%B3%A8%E8%A7%A3%E6%95%B4%E5%90%88MyBatis%E5%88%86%E6%9E%90"><span class="toc-number">2.4.2.</span> <span class="toc-text">4.2)注解整合MyBatis分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%B3%A8%E8%A7%A3%E6%95%B4%E5%90%88MyBatis%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.4.3.</span> <span class="toc-text">4.3)注解整合MyBatis步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B%E6%94%B9%E7%89%88%EF%BC%88%E6%B3%A8%E8%A7%A3%E6%95%B4%E5%90%88Junit%EF%BC%89"><span class="toc-number">2.4.4.</span> <span class="toc-text">4.4)综合案例改版（注解整合Junit）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-IoC%E5%BA%95%E5%B1%82%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86"><span class="toc-number">2.5.</span> <span class="toc-text">5)IoC底层核心原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-IoC%E6%A0%B8%E5%BF%83%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.5.1.</span> <span class="toc-text">5.1)IoC核心接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%BB%84%E4%BB%B6%E6%89%AB%E6%8F%8F%E5%99%A8"><span class="toc-number">2.5.2.</span> <span class="toc-text">5.2)组件扫描器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E8%AE%BE%E5%AE%9A%E7%BB%84%E4%BB%B6%E6%89%AB%E6%8F%8F%E5%8A%A0%E8%BD%BD%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">2.5.3.</span> <span class="toc-text">5.3)设定组件扫描加载过滤器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">2.5.4.</span> <span class="toc-text">5.4)自定义组件过滤器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%85%A5%E5%99%A8"><span class="toc-number">2.5.5.</span> <span class="toc-text">5.5)自定义导入器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E5%86%8C%E5%99%A8"><span class="toc-number">2.5.6.</span> <span class="toc-text">5.6)自定义注册器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-bean%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90"><span class="toc-number">2.5.7.</span> <span class="toc-text">5.7)bean初始化过程解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8-bean%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90"><span class="toc-number">2.5.8.</span> <span class="toc-text">5.8)bean初始化过程解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-9-bean%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90"><span class="toc-number">2.5.9.</span> <span class="toc-text">5.9)bean初始化过程解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-10-%E7%B9%81%E7%90%90%E7%9A%84bean%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B%E5%A4%84%E7%90%86"><span class="toc-number">2.5.10.</span> <span class="toc-text">5.10)繁琐的bean初始化过程处理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AOP"><span class="toc-number">3.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-AOP%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.</span> <span class="toc-text">1)AOP简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-OOP%E5%BC%80%E5%8F%91%E6%80%9D%E8%B7%AF"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.1)OOP开发思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-AOP%E5%BC%80%E5%8F%91%E6%80%9D%E6%83%B3"><span class="toc-number">3.1.2.</span> <span class="toc-text">1.2)AOP开发思想</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-AOP%E6%A6%82%E5%BF%B5"><span class="toc-number">3.1.3.</span> <span class="toc-text">1.3)AOP概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-AOP%E4%BD%9C%E7%94%A8"><span class="toc-number">3.1.4.</span> <span class="toc-text">1.4)AOP作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-AOP%E4%BC%98%E5%8A%BF"><span class="toc-number">3.1.5.</span> <span class="toc-text">1.5)AOP优势</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-AOP%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">3.2.</span> <span class="toc-text">2)AOP入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-AOP%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.1)AOP相关概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-AOP%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2)AOP开发过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-AOP%E5%BC%80%E5%8F%91%E6%96%B9%E5%BC%8F"><span class="toc-number">3.2.3.</span> <span class="toc-text">2.2)AOP开发方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E5%88%86%E6%9E%90"><span class="toc-number">3.2.4.</span> <span class="toc-text">2.3)入门案例制作分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-AOP%E9%85%8D%E7%BD%AE%EF%BC%88XML%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">3)AOP配置（XML）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-AspectJ"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.1)AspectJ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-AOP%E9%85%8D%E7%BD%AE"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.2)AOP配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-aop-config"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">3.2.1)aop:config</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-aop-aspect"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">3.2.2)aop:aspect</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-aop-pointcut"><span class="toc-number">3.3.2.3.</span> <span class="toc-text">3.2.3)aop:pointcut</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3)切入点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%BB%84%E6%88%90"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.4)切入点表达式的组成</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E2%80%94%E2%80%94%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">3.4.1)切入点表达式——关键字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E2%80%94%E2%80%94%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-number">3.3.4.2.</span> <span class="toc-text">3.4.2)切入点表达式——通配符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-3-%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E2%80%94%E2%80%94%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">3.3.4.3.</span> <span class="toc-text">3.4.3)切入点表达式——逻辑运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-4-%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E2%80%94%E2%80%94%E8%8C%83%E4%BE%8B"><span class="toc-number">3.3.4.4.</span> <span class="toc-text">3.4.4)切入点表达式——范例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%88%87%E5%85%A5%E7%82%B9%E7%9A%84%E4%B8%89%E7%A7%8D%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="toc-number">3.3.5.</span> <span class="toc-text">3.5)切入点的三种配置方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-%E5%88%87%E5%85%A5%E7%82%B9%E9%85%8D%E7%BD%AE%E7%BB%8F%E9%AA%8C"><span class="toc-number">3.3.6.</span> <span class="toc-text">3.6)切入点配置经验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-%E9%80%9A%E7%9F%A5%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.7.</span> <span class="toc-text">3.7)通知类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-1-aop-before"><span class="toc-number">3.3.7.1.</span> <span class="toc-text">3.7.1)aop:before</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-2-aop-after"><span class="toc-number">3.3.7.2.</span> <span class="toc-text">3.7.2)aop:after</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-3-aop-after-returning"><span class="toc-number">3.3.7.3.</span> <span class="toc-text">3.7.3)aop:after-returning</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-4-aop-after-throwing"><span class="toc-number">3.3.7.4.</span> <span class="toc-text">3.7.4)aop:after-throwing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-5-aop-around"><span class="toc-number">3.3.7.5.</span> <span class="toc-text">3.7.5)aop:around</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-%E9%80%9A%E7%9F%A5%E9%A1%BA%E5%BA%8F%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">3.3.8.</span> <span class="toc-text">3.8)通知顺序（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-%E9%80%9A%E7%9F%A5%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.9.</span> <span class="toc-text">3.9)通知获取数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-1-%E9%80%9A%E7%9F%A5%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.9.1.</span> <span class="toc-text">3.9.1)通知获取参数数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-2-%E9%80%9A%E7%9F%A5%E8%8E%B7%E5%8F%96%E8%BF%94%E5%9B%9E%E5%80%BC%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.9.2.</span> <span class="toc-text">3.9.2)通知获取返回值数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-3-%E9%80%9A%E7%9F%A5%E8%8E%B7%E5%8F%96%E5%BC%82%E5%B8%B8%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.9.3.</span> <span class="toc-text">3.9.3)通知获取异常数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-AOP%E9%85%8D%E7%BD%AE%EF%BC%88%E6%B3%A8%E8%A7%A3%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">4)AOP配置（注解）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-AOP%E9%85%8D%E7%BD%AE"><span class="toc-number">3.4.1.</span> <span class="toc-text">4.1)AOP配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91AOP%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.4.2.</span> <span class="toc-text">4.2)注解开发AOP制作步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91AOP%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">3.4.3.</span> <span class="toc-text">4.3)注解开发AOP注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-AOP%E6%B3%A8%E8%A7%A3%E8%AF%A6%E8%A7%A3"><span class="toc-number">3.4.4.</span> <span class="toc-text">4.4)AOP注解详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-Aspect"><span class="toc-number">3.4.4.1.</span> <span class="toc-text">4.4.1)@Aspect</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-Pointcut"><span class="toc-number">3.4.4.2.</span> <span class="toc-text">4.4.2)@Pointcut</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-Before"><span class="toc-number">3.4.4.3.</span> <span class="toc-text">4.4.3)@Before</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-4-After"><span class="toc-number">3.4.4.4.</span> <span class="toc-text">4.4.4)@After</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-5-AfterReturning"><span class="toc-number">3.4.4.5.</span> <span class="toc-text">4.4.5)@AfterReturning</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-6-AfterThrowing"><span class="toc-number">3.4.4.6.</span> <span class="toc-text">4.4.6)@AfterThrowing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-7-Around"><span class="toc-number">3.4.4.7.</span> <span class="toc-text">4.4.7)@Around</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-AOP%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91%E9%80%9A%E7%9F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E6%8E%A7%E5%88%B6%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">3.4.5.</span> <span class="toc-text">4.5)AOP注解开发通知执行顺序控制（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-AOP%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8"><span class="toc-number">3.4.6.</span> <span class="toc-text">4.6)AOP注解驱动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B-1"><span class="toc-number">3.5.</span> <span class="toc-text">5)综合案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D-1"><span class="toc-number">3.5.1.</span> <span class="toc-text">5.1)案例介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90-1"><span class="toc-number">3.5.2.</span> <span class="toc-text">5.2)案例分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.5.3.</span> <span class="toc-text">5.3)案例制作步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E6%A1%88%E4%BE%8B%E5%88%B6%E4%BD%9C%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81"><span class="toc-number">3.5.4.</span> <span class="toc-text">5.4)案例制作核心代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E6%A1%88%E4%BE%8B%E5%90%8E%E7%BB%AD%E6%80%9D%E8%80%83%E4%B8%8E%E8%AE%BE%E8%AE%A1"><span class="toc-number">3.5.5.</span> <span class="toc-text">5.5)案例后续思考与设计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-AOP%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">3.6.</span> <span class="toc-text">6)AOP底层原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">3.6.1.</span> <span class="toc-text">6.1)静态代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E2%80%94%E2%80%94JDK-Proxy"><span class="toc-number">3.6.2.</span> <span class="toc-text">6.2)动态代理——JDK Proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E2%80%94%E2%80%94CGLIB"><span class="toc-number">3.6.3.</span> <span class="toc-text">6.3)动态代理——CGLIB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">3.6.4.</span> <span class="toc-text">6.4)代理模式的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E7%BB%87%E5%85%A5%E6%97%B6%E6%9C%BA"><span class="toc-number">3.6.5.</span> <span class="toc-text">6.5)织入时机</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#spring-%E4%BA%8B%E5%8A%A1"><span class="toc-number">4.</span> <span class="toc-text">spring 事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BA%8B%E5%8A%A1%E5%9B%9E%E9%A1%BE"><span class="toc-number">4.1.</span> <span class="toc-text">1)事务回顾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E5%8A%A1%EF%BC%9F"><span class="toc-number">4.1.1.</span> <span class="toc-text">1.1)什么是事务？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">1.2)事务的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7"><span class="toc-number">4.1.3.</span> <span class="toc-text">1.3)事务的隔离级</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">4.2.</span> <span class="toc-text">2)事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Spring%E4%BA%8B%E5%8A%A1%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.2.1.</span> <span class="toc-text">2.1)Spring事务核心对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-PlatformTransactionManager"><span class="toc-number">4.2.2.</span> <span class="toc-text">2.2)PlatformTransactionManager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-TransactionDefinition"><span class="toc-number">4.2.3.</span> <span class="toc-text">2.3)TransactionDefinition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-TransactionStatus"><span class="toc-number">4.2.4.</span> <span class="toc-text">2.4)TransactionStatus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6%E6%96%B9%E5%BC%8F"><span class="toc-number">4.2.5.</span> <span class="toc-text">2.5)事务控制方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E6%A1%88%E4%BE%8B%E8%AF%B4%E6%98%8E"><span class="toc-number">4.2.6.</span> <span class="toc-text">2.6)案例说明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-1-%E6%A1%88%E4%BE%8B%E8%AF%B4%E6%98%8E"><span class="toc-number">4.2.6.1.</span> <span class="toc-text">2.6.1)案例说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-2-%E6%A1%88%E4%BE%8B%E7%8E%AF%E5%A2%83%EF%BC%88%E5%9F%BA%E4%BA%8ESpring%E3%80%81Mybatis%E6%95%B4%E5%90%88%EF%BC%89"><span class="toc-number">4.2.6.2.</span> <span class="toc-text">2.6.2)案例环境（基于Spring、Mybatis整合）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-3-%E7%BC%96%E7%A8%8B%E5%BC%8F%E4%BA%8B%E5%8A%A1"><span class="toc-number">4.2.6.3.</span> <span class="toc-text">2.6.3)编程式事务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-%E4%BD%BF%E7%94%A8AOP%E6%8E%A7%E5%88%B6%E4%BA%8B%E5%8A%A1"><span class="toc-number">4.2.7.</span> <span class="toc-text">2.7)使用AOP控制事务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%EF%BC%88XML%EF%BC%89"><span class="toc-number">4.2.8.</span> <span class="toc-text">2.8声明式事务（XML）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-1-aop-advice%E4%B8%8Eaop-advisor%E5%8C%BA%E5%88%AB"><span class="toc-number">4.2.8.1.</span> <span class="toc-text">2.8.1)aop:advice与aop:advisor区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-2-tx%E9%85%8D%E7%BD%AE%E2%80%94-tx-advice"><span class="toc-number">4.2.8.2.</span> <span class="toc-text">2.8.2)tx配置—-tx:advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-3-tx%E9%85%8D%E7%BD%AE%E2%80%94-tx-attributes"><span class="toc-number">4.2.8.3.</span> <span class="toc-text">2.8.3)tx配置—-tx:attributes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-4-tx%E9%85%8D%E7%BD%AE%E2%80%94-tx-method"><span class="toc-number">4.2.8.4.</span> <span class="toc-text">2.8.4)tx配置—-tx:method</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-9-%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA"><span class="toc-number">4.2.9.</span> <span class="toc-text">2.9)事务传播行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA"><span class="toc-number">4.2.10.</span> <span class="toc-text">2.10)事务传播行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-11-%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E5%BA%94%E7%94%A8"><span class="toc-number">4.2.11.</span> <span class="toc-text">2.11)事务传播应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-12-%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%EF%BC%88%E6%B3%A8%E8%A7%A3%EF%BC%89"><span class="toc-number">4.2.12.</span> <span class="toc-text">2.12)声明式事务（注解）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-12-1-Transactional"><span class="toc-number">4.2.12.1.</span> <span class="toc-text">2.12.1)@Transactional</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-12-2-tx-annotation-driven"><span class="toc-number">4.2.12.2.</span> <span class="toc-text">2.12.2)tx:annotation-driven</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-13-%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%EF%BC%88%E7%BA%AF%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%EF%BC%89"><span class="toc-number">4.2.13.</span> <span class="toc-text">2.13)声明式事务（纯注解驱动）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%A8%A1%E6%9D%BF%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.3.</span> <span class="toc-text">3)模板对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Spring%E6%A8%A1%E5%9D%97%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.3.1.</span> <span class="toc-text">3.1)Spring模块对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-JdbcTemplate%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">4.3.2.</span> <span class="toc-text">3.2)JdbcTemplate（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-NamedParameterJdbcTemplate-%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">4.3.3.</span> <span class="toc-text">3.3)NamedParameterJdbcTemplate(了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-RedisTemplate"><span class="toc-number">4.3.4.</span> <span class="toc-text">3.4)RedisTemplate</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E4%BA%8B%E5%8A%A1%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90"><span class="toc-number">4.4.</span> <span class="toc-text">4)事务底层原理解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.1)策略模式应用</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 小肥龙吃大冰淇淋</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="framework-info"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/202301132049386.png"/><span> </span><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">晋ICP备2022012091号-1</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'pinglun-9gh2lmcnd8587831',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'pinglun-9gh2lmcnd8587831',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script src="//code.tidio.co/smwivpnwumemac2wohardi3d3gpud1ag.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>